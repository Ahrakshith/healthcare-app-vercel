/*! For license information please see main.513dd53f.js.LICENSE.txt */
(()=>{var e={43:(e,t,n)=>{"use strict";e.exports=n(202)},92:e=>{var t;window,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=256,s=function(){function e(e){void 0===e&&(e="="),this._paddingCharacter=e}return e.prototype.encodedLength=function(e){return this._paddingCharacter?(e+2)/3*4|0:(8*e+5)/6|0},e.prototype.encode=function(e){for(var t="",n=0;n<e.length-2;n+=3){var r=e[n]<<16|e[n+1]<<8|e[n+2];t+=this._encodeByte(r>>>18&63),t+=this._encodeByte(r>>>12&63),t+=this._encodeByte(r>>>6&63),t+=this._encodeByte(r>>>0&63)}var i=e.length-n;return i>0&&(r=e[n]<<16|(2===i?e[n+1]<<8:0),t+=this._encodeByte(r>>>18&63),t+=this._encodeByte(r>>>12&63),t+=2===i?this._encodeByte(r>>>6&63):this._paddingCharacter||"",t+=this._paddingCharacter||""),t},e.prototype.maxDecodedLength=function(e){return this._paddingCharacter?e/4*3|0:(6*e+7)/8|0},e.prototype.decodedLength=function(e){return this.maxDecodedLength(e.length-this._getPaddingLength(e))},e.prototype.decode=function(e){if(0===e.length)return new Uint8Array(0);for(var t=this._getPaddingLength(e),n=e.length-t,r=new Uint8Array(this.maxDecodedLength(n)),s=0,o=0,a=0,l=0,c=0,u=0,d=0;o<n-4;o+=4)l=this._decodeChar(e.charCodeAt(o+0)),c=this._decodeChar(e.charCodeAt(o+1)),u=this._decodeChar(e.charCodeAt(o+2)),d=this._decodeChar(e.charCodeAt(o+3)),r[s++]=l<<2|c>>>4,r[s++]=c<<4|u>>>2,r[s++]=u<<6|d,a|=l&i,a|=c&i,a|=u&i,a|=d&i;if(o<n-1&&(l=this._decodeChar(e.charCodeAt(o)),c=this._decodeChar(e.charCodeAt(o+1)),r[s++]=l<<2|c>>>4,a|=l&i,a|=c&i),o<n-2&&(u=this._decodeChar(e.charCodeAt(o+2)),r[s++]=c<<4|u>>>2,a|=u&i),o<n-3&&(d=this._decodeChar(e.charCodeAt(o+3)),r[s++]=u<<6|d,a|=d&i),0!==a)throw new Error("Base64Coder: incorrect characters for decoding");return r},e.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-15,t+=62-e>>>8&3,String.fromCharCode(t)},e.prototype._decodeChar=function(e){var t=i;return t+=(42-e&e-44)>>>8&-256+e-43+62,t+=(46-e&e-48)>>>8&-256+e-47+63,t+=(47-e&e-58)>>>8&-256+e-48+52,t+=(64-e&e-91)>>>8&-256+e-65+0,t+=(96-e&e-123)>>>8&-256+e-97+26},e.prototype._getPaddingLength=function(e){var t=0;if(this._paddingCharacter){for(var n=e.length-1;n>=0&&e[n]===this._paddingCharacter;n--)t++;if(e.length<4||t>2)throw new Error("Base64Coder: incorrect padding")}return t},e}();t.Coder=s;var o=new s;t.encode=function(e){return o.encode(e)},t.decode=function(e){return o.decode(e)};var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-13,t+=62-e>>>8&49,String.fromCharCode(t)},t.prototype._decodeChar=function(e){var t=i;return t+=(44-e&e-46)>>>8&-256+e-45+62,t+=(94-e&e-96)>>>8&-256+e-95+63,t+=(47-e&e-58)>>>8&-256+e-48+52,t+=(64-e&e-91)>>>8&-256+e-65+0,t+=(96-e&e-123)>>>8&-256+e-97+26},t}(s);t.URLSafeCoder=a;var l=new a;t.encodeURLSafe=function(e){return l.encode(e)},t.decodeURLSafe=function(e){return l.decode(e)},t.encodedLength=function(e){return o.encodedLength(e)},t.maxDecodedLength=function(e){return o.maxDecodedLength(e)},t.decodedLength=function(e){return o.decodedLength(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="utf8: invalid string",i="utf8: invalid source encoding";function s(e){for(var t=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i<128)t+=1;else if(i<2048)t+=2;else if(i<55296)t+=3;else{if(!(i<=57343))throw new Error(r);if(n>=e.length-1)throw new Error(r);n++,t+=4}}return t}t.encode=function(e){for(var t=new Uint8Array(s(e)),n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=192|i>>6,t[n++]=128|63&i):i<55296?(t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i):(r++,i=(1023&i)<<10,i|=1023&e.charCodeAt(r),i+=65536,t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i)}return t},t.encodedLength=s,t.decode=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(128&r){var s=void 0;if(r<224){if(n>=e.length)throw new Error(i);if(128!==(192&(o=e[++n])))throw new Error(i);r=(31&r)<<6|63&o,s=128}else if(r<240){if(n>=e.length-1)throw new Error(i);var o=e[++n],a=e[++n];if(128!==(192&o)||128!==(192&a))throw new Error(i);r=(15&r)<<12|(63&o)<<6|63&a,s=2048}else{if(!(r<248))throw new Error(i);if(n>=e.length-2)throw new Error(i);o=e[++n],a=e[++n];var l=e[++n];if(128!==(192&o)||128!==(192&a)||128!==(192&l))throw new Error(i);r=(15&r)<<18|(63&o)<<12|(63&a)<<6|63&l,s=65536}if(r<s||r>=55296&&r<=57343)throw new Error(i);if(r>=65536){if(r>1114111)throw new Error(i);r-=65536,t.push(String.fromCharCode(55296|r>>10)),r=56320|1023&r}}t.push(String.fromCharCode(r))}return t.join("")}},function(e,t,n){e.exports=n(3).default},function(e,t,n){"use strict";n.r(t);class r{constructor(e,t){this.lastId=0,this.prefix=e,this.name=t}create(e){this.lastId++;var t=this.lastId,n=this.prefix+t,r=this.name+"["+t+"]",i=!1,s=function(){i||(e.apply(null,arguments),i=!0)};return this[t]=s,{number:t,id:n,name:r,callback:s}}remove(e){delete this[e.number]}}var i=new r("_pusher_script_","Pusher.ScriptReceivers"),s={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},o=new r("_pusher_dependencies","Pusher.DependenciesReceivers"),a=new class{constructor(e){this.options=e,this.receivers=e.receivers||i,this.loading={}}load(e,t,n){var r=this;if(r.loading[e]&&r.loading[e].length>0)r.loading[e].push(n);else{r.loading[e]=[n];var i=ut.createScriptRequest(r.getPath(e,t)),s=r.receivers.create((function(t){if(r.receivers.remove(s),r.loading[e]){var n=r.loading[e];delete r.loading[e];for(var o=function(e){e||i.cleanup()},a=0;a<n.length;a++)n[a](t,o)}}));i.send(s)}}getRoot(e){var t=ut.getDocument().location.protocol;return(e&&e.useTLS||"https:"===t?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version}getPath(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"}}({cdn_http:s.cdn_http,cdn_https:s.cdn_https,version:s.VERSION,suffix:s.dependency_suffix,receivers:o});const l={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var c,u=function(e){const t=l.urls[e];if(!t)return"";let n;return t.fullUrl?n=t.fullUrl:t.path&&(n=l.baseUrl+t.path),n?`See: ${n}`:""};!function(e){e.UserAuthentication="user-authentication",e.ChannelAuthorization="channel-authorization"}(c||(c={}));class d extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class h extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class f extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class p extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class m extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class g extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class v extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class y extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(e,t){super(t),this.status=e,Object.setPrototypeOf(this,new.target.prototype)}}for(var w=function(e,t,n,r,i){const s=ut.createXHR();for(var o in s.open("POST",n.endpoint,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.headers)s.setRequestHeader(o,n.headers[o]);if(null!=n.headersProvider){let e=n.headersProvider();for(var o in e)s.setRequestHeader(o,e[o])}return s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){let t,n=!1;try{t=JSON.parse(s.responseText),n=!0}catch(e){i(new b(200,`JSON returned from ${r.toString()} endpoint was invalid, yet status code was 200. Data was: ${s.responseText}`),null)}n&&i(null,t)}else{let e="";switch(r){case c.UserAuthentication:e=u("authenticationEndpoint");break;case c.ChannelAuthorization:e=`Clients must be authorized to join private or presence channels. ${u("authorizationEndpoint")}`}i(new b(s.status,`Unable to retrieve auth string from ${r.toString()} endpoint - received status: ${s.status} from ${n.endpoint}. ${e}`),null)}},s.send(t),s},_=String.fromCharCode,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x={},S=0;S<64;S++)x[E.charAt(S)]=S;var k=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?_(192|t>>>6)+_(128|63&t):_(224|t>>>12&15)+_(128|t>>>6&63)+_(128|63&t)},T=function(e){return e.replace(/[^\x00-\x7F]/g,k)},C=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[E.charAt(n>>>18),E.charAt(n>>>12&63),t>=2?"=":E.charAt(n>>>6&63),t>=1?"=":E.charAt(63&n)].join("")},I=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,C)},A=class{constructor(e,t,n,r){this.clear=t,this.timer=e((()=>{this.timer&&(this.timer=r(this.timer))}),n)}isRunning(){return null!==this.timer}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}};function P(e){window.clearTimeout(e)}function N(e){window.clearInterval(e)}class R extends A{constructor(e,t){super(setTimeout,P,e,(function(e){return t(),null}))}}class O extends A{constructor(e,t){super(setInterval,N,e,(function(e){return t(),e}))}}var D={now:()=>Date.now?Date.now():(new Date).valueOf(),defer:e=>new R(0,e),method(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=Array.prototype.slice.call(arguments,1);return function(t){return t[e].apply(t,i.concat(arguments))}}},F=D;function j(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];for(var r in n)n[r]&&n[r].constructor&&n[r].constructor===Object?e[r]=j(e[r]||{},n[r]):e[r]=n[r]}return e}function L(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"===typeof arguments[t]?e.push(arguments[t]):e.push(G(arguments[t]));return e.join(" : ")}function U(e,t){var n=Array.prototype.indexOf;if(null===e)return-1;if(n&&e.indexOf===n)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function M(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n,e)}function z(e){var t=[];return M(e,(function(e,n){t.push(n)})),t}function V(e,t,n){for(var r=0;r<e.length;r++)t.call(n||window,e[r],r,e)}function B(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r,e,n));return n}function $(e,t){t=t||function(e){return!!e};for(var n=[],r=0;r<e.length;r++)t(e[r],r,e,n)&&n.push(e[r]);return n}function q(e,t){var n={};return M(e,(function(r,i){(t&&t(r,i,e,n)||Boolean(r))&&(n[i]=r)})),n}function H(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1}function K(e){return function(e,t){var n={};return M(e,(function(e,r){n[r]=t(e)})),n}(e,(function(e){return"object"===typeof e&&(e=G(e)),encodeURIComponent((t=e.toString(),I(T(t))));var t}))}function W(e){return B(function(e){var t=[];return M(e,(function(e,n){t.push([n,e])})),t}(K(q(e,(function(e){return void 0!==e})))),F.method("join","=")).join("&")}function G(e){try{return JSON.stringify(e)}catch(t){return JSON.stringify(function(e){var t=[],n=[];return function e(r,i){var s,o,a;switch(typeof r){case"object":if(!r)return null;for(s=0;s<t.length;s+=1)if(t[s]===r)return{$ref:n[s]};if(t.push(r),n.push(i),"[object Array]"===Object.prototype.toString.apply(r))for(a=[],s=0;s<r.length;s+=1)a[s]=e(r[s],i+"["+s+"]");else for(o in a={},r)Object.prototype.hasOwnProperty.call(r,o)&&(a[o]=e(r[o],i+"["+JSON.stringify(o)+"]"));return a;case"number":case"string":case"boolean":return r}}(e,"$")}(e))}}var Q=new class{constructor(){this.globalLog=e=>{window.console&&window.console.log&&window.console.log(e)}}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(this.globalLog,t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(this.globalLogWarn,t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(this.globalLogError,t)}globalLogWarn(e){window.console&&window.console.warn?window.console.warn(e):this.globalLog(e)}globalLogError(e){window.console&&window.console.error?window.console.error(e):this.globalLogWarn(e)}log(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=L.apply(this,arguments);Pt.log?Pt.log(i):Pt.logToConsole&&e.bind(this)(i)}},J=function(e,t,n,r,i){void 0===n.headers&&null==n.headersProvider||Q.warn(`To send headers with the ${r.toString()} request, you must use AJAX, rather than JSONP.`);var s=e.nextAuthCallbackID.toString();e.nextAuthCallbackID++;var o=e.getDocument(),a=o.createElement("script");e.auth_callbacks[s]=function(e){i(null,e)};var l="Pusher.auth_callbacks['"+s+"']";a.src=n.endpoint+"?callback="+encodeURIComponent(l)+"&"+t;var c=o.getElementsByTagName("head")[0]||o.documentElement;c.insertBefore(a,c.firstChild)};class Y{constructor(e){this.src=e}send(e){var t=this,n="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(n)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){"loaded"!==t.script.readyState&&"complete"!==t.script.readyState||e.callback(null)},void 0===t.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+n+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var r=document.getElementsByTagName("head")[0];r.insertBefore(t.script,r.firstChild),t.errorScript&&r.insertBefore(t.errorScript,t.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class X{constructor(e,t){this.url=e,this.data=t}send(e){if(!this.request){var t=W(this.data),n=this.url+"/"+e.number+"?"+t;this.request=ut.createScriptRequest(n),this.request.send(e)}}cleanup(){this.request&&this.request.cleanup()}}var Z={name:"jsonp",getAgent:function(e,t){return function(n,r){var s="http"+(t?"s":"")+"://"+(e.host||e.options.host)+e.options.path,o=ut.createJSONPRequest(s,n),a=ut.ScriptReceivers.create((function(t,n){i.remove(a),o.cleanup(),n&&n.host&&(e.host=n.host),r&&r(t,n)}));o.send(a)}}};function ee(e,t,n){return e+(t.useTLS?"s":"")+"://"+(t.useTLS?t.hostTLS:t.hostNonTLS)+n}function te(e,t){return"/app/"+e+"?protocol="+s.PROTOCOL+"&client=js&version="+s.VERSION+(t?"&"+t:"")}var ne={getInitial:function(e,t){return ee("ws",t,(t.httpPath||"")+te(e,"flash=false"))}},re={getInitial:function(e,t){return ee("http",t,(t.httpPath||"/pusher")+te(e))}},ie={getInitial:function(e,t){return ee("http",t,t.httpPath||"/pusher")},getPath:function(e,t){return te(e)}};class se{constructor(){this._callbacks={}}get(e){return this._callbacks[oe(e)]}add(e,t,n){var r=oe(e);this._callbacks[r]=this._callbacks[r]||[],this._callbacks[r].push({fn:t,context:n})}remove(e,t,n){if(e||t||n){var r=e?[oe(e)]:z(this._callbacks);t||n?this.removeCallback(r,t,n):this.removeAllCallbacks(r)}else this._callbacks={}}removeCallback(e,t,n){V(e,(function(e){this._callbacks[e]=$(this._callbacks[e]||[],(function(e){return t&&t!==e.fn||n&&n!==e.context})),0===this._callbacks[e].length&&delete this._callbacks[e]}),this)}removeAllCallbacks(e){V(e,(function(e){delete this._callbacks[e]}),this)}}function oe(e){return"_"+e}class ae{constructor(e){this.callbacks=new se,this.global_callbacks=[],this.failThrough=e}bind(e,t,n){return this.callbacks.add(e,t,n),this}bind_global(e){return this.global_callbacks.push(e),this}unbind(e,t,n){return this.callbacks.remove(e,t,n),this}unbind_global(e){return e?(this.global_callbacks=$(this.global_callbacks||[],(t=>t!==e)),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(e,t,n){for(var r=0;r<this.global_callbacks.length;r++)this.global_callbacks[r](e,t);var i=this.callbacks.get(e),s=[];if(n?s.push(t,n):t&&s.push(t),i&&i.length>0)for(r=0;r<i.length;r++)i[r].fn.apply(i[r].context||window,s);else this.failThrough&&this.failThrough(e,t);return this}}class le extends ae{constructor(e,t,n,r,i){super(),this.initialize=ut.transportConnectionInitializer,this.hooks=e,this.name=t,this.priority=n,this.key=r,this.options=i,this.state="new",this.timeline=i.timeline,this.activityTimeout=i.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return Boolean(this.hooks.handlesActivityChecks)}supportsPing(){return Boolean(this.hooks.supportsPing)}connect(){if(this.socket||"initialized"!==this.state)return!1;var e=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(e,this.options)}catch(t){return F.defer((()=>{this.onError(t),this.changeState("closed")})),!1}return this.bindListeners(),Q.debug("Connecting",{transport:this.name,url:e}),this.changeState("connecting"),!0}close(){return!!this.socket&&(this.socket.close(),!0)}send(e){return"open"===this.state&&(F.defer((()=>{this.socket&&this.socket.send(e)})),!0)}ping(){"open"===this.state&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))}onClose(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(e){this.emit("message",e)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=e=>{this.onError(e)},this.socket.onclose=e=>{this.onClose(e)},this.socket.onmessage=e=>{this.onMessage(e)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)}buildTimelineMessage(e){return j({cid:this.id},e)}}class ce{constructor(e){this.hooks=e}isSupported(e){return this.hooks.isSupported(e)}createConnection(e,t,n,r){return new le(this.hooks,e,t,n,r)}}var ue=new ce({urls:ne,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(ut.getWebSocketAPI())},isSupported:function(){return Boolean(ut.getWebSocketAPI())},getSocket:function(e){return ut.createWebSocket(e)}}),de={urls:re,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},he=j({getSocket:function(e){return ut.HTTPFactory.createStreamingSocket(e)}},de),fe=j({getSocket:function(e){return ut.HTTPFactory.createPollingSocket(e)}},de),pe={isSupported:function(){return ut.isXHRSupported()}},me={ws:ue,xhr_streaming:new ce(j({},he,pe)),xhr_polling:new ce(j({},fe,pe))},ge=new ce({file:"sockjs",urls:ie,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(e,t){return new window.SockJS(e,null,{js_path:a.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}}),ve={isSupported:function(e){return ut.isXDRSupported(e.useTLS)}},ye=new ce(j({},he,ve)),be=new ce(j({},fe,ve));me.xdr_streaming=ye,me.xdr_polling=be,me.sockjs=ge;var we=me,_e=new class extends ae{constructor(){super();var e=this;void 0!==window.addEventListener&&(window.addEventListener("online",(function(){e.emit("online")}),!1),window.addEventListener("offline",(function(){e.emit("offline")}),!1))}isOnline(){return void 0===window.navigator.onLine||window.navigator.onLine}};class Ee{constructor(e,t,n){this.manager=e,this.transport=t,this.minPingDelay=n.minPingDelay,this.maxPingDelay=n.maxPingDelay,this.pingDelay=void 0}createConnection(e,t,n,r){r=j({},r,{activityTimeout:this.pingDelay});var i=this.transport.createConnection(e,t,n,r),s=null,o=function(){i.unbind("open",o),i.bind("closed",a),s=F.now()},a=e=>{if(i.unbind("closed",a),1002===e.code||1003===e.code)this.manager.reportDeath();else if(!e.wasClean&&s){var t=F.now()-s;t<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(t/2,this.minPingDelay))}};return i.bind("open",o),i}isSupported(e){return this.manager.isAlive()&&this.transport.isSupported(e)}}const xe={decodeMessage:function(e){try{var t=JSON.parse(e.data),n=t.data;if("string"===typeof n)try{n=JSON.parse(t.data)}catch(i){}var r={event:t.event,channel:t.channel,data:n};return t.user_id&&(r.user_id=t.user_id),r}catch(i){throw{type:"MessageParseError",error:i,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){var t=xe.decodeMessage(e);if("pusher:connection_established"===t.event){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:1e3*t.data.activity_timeout}}if("pusher:error"===t.event)return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"},getCloseAction:function(e){return e.code<4e3?e.code>=1002&&e.code<=1004?"backoff":null:4e3===e.code?"tls_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}};var Se=xe;class ke extends ae{constructor(e,t){super(),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(e){return this.transport.send(e)}send_event(e,t,n){var r={event:e,data:t};return n&&(r.channel=n),Q.debug("Event sent",r),this.send(Se.encodeMessage(r))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var e={message:e=>{var t;try{t=Se.decodeMessage(e)}catch(n){this.emit("error",{type:"MessageParseError",error:n,data:e.data})}if(void 0!==t){switch(Q.debug("Event recd",t),t.event){case"pusher:error":this.emit("error",{type:"PusherError",data:t.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong")}this.emit("message",t)}},activity:()=>{this.emit("activity")},error:e=>{this.emit("error",e)},closed:e=>{t(),e&&e.code&&this.handleCloseEvent(e),this.transport=null,this.emit("closed")}},t=()=>{M(e,((e,t)=>{this.transport.unbind(t,e)}))};M(e,((e,t)=>{this.transport.bind(t,e)}))}handleCloseEvent(e){var t=Se.getCloseAction(e),n=Se.getCloseError(e);n&&this.emit("error",n),t&&this.emit(t,{action:t,error:n})}}class Te{constructor(e,t){this.transport=e,this.callback=t,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=e=>{var t;this.unbindListeners();try{t=Se.processHandshake(e)}catch(n){return this.finish("error",{error:n}),void this.transport.close()}"connected"===t.action?this.finish("connected",{connection:new ke(t.id,this.transport),activityTimeout:t.activityTimeout}):(this.finish(t.action,{error:t.error}),this.transport.close())},this.onClosed=e=>{this.unbindListeners();var t=Se.getCloseAction(e)||"backoff",n=Se.getCloseError(e);this.finish(t,{error:n})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(e,t){this.callback(j({transport:this.transport,action:e},t))}}class Ce{constructor(e,t){this.timeline=e,this.options=t||{}}send(e,t){this.timeline.isEmpty()||this.timeline.send(ut.TimelineTransport.getAgent(this,e),t)}}class Ie extends ae{constructor(e,t){super((function(t,n){Q.debug("No callbacks on "+e+" for "+t)})),this.name=e,this.pusher=t,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(e,t){return t(null,{auth:""})}trigger(e,t){if(0!==e.indexOf("client-"))throw new d("Event '"+e+"' does not start with 'client-'");if(!this.subscribed){var n=u("triggeringClientEvents");Q.warn(`Client event triggered before channel 'subscription_succeeded' event . ${n}`)}return this.pusher.send_event(e,t,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(e){var t=e.event,n=e.data;"pusher_internal:subscription_succeeded"===t?this.handleSubscriptionSucceededEvent(e):"pusher_internal:subscription_count"===t?this.handleSubscriptionCountEvent(e):0!==t.indexOf("pusher_internal:")&&this.emit(t,n,{})}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",e.data)}handleSubscriptionCountEvent(e){e.data.subscription_count&&(this.subscriptionCount=e.data.subscription_count),this.emit("pusher:subscription_count",e.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,((e,t)=>{e?(this.subscriptionPending=!1,Q.error(e.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:e.message},e instanceof b?{status:e.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:t.auth,channel_data:t.channel_data,channel:this.name})})))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class Ae extends Ie{authorize(e,t){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:e},t)}}class Pe{constructor(){this.reset()}get(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null}each(e){M(this.members,((t,n)=>{e(this.get(n))}))}setMyID(e){this.myID=e}onSubscription(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)}addMember(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)}removeMember(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Ne=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class Re extends Ae{constructor(e,t){super(e,t),this.members=new Pe}authorize(e,t){super.authorize(e,((e,n)=>Ne(this,void 0,void 0,(function*(){if(!e)if(null!=n.channel_data){var r=JSON.parse(n.channel_data);this.members.setMyID(r.user_id)}else{if(yield this.pusher.user.signinDonePromise,null==this.pusher.user.user_data){let e=u("authorizationEndpoint");return Q.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${e}, or the user should be signed in.`),void t("Invalid auth response")}this.members.setMyID(this.pusher.user.user_data.id)}t(e,n)}))))}handleEvent(e){var t=e.event;if(0===t.indexOf("pusher_internal:"))this.handleInternalEvent(e);else{var n=e.data,r={};e.user_id&&(r.user_id=e.user_id),this.emit(t,n,r)}}handleInternalEvent(e){var t=e.event,n=e.data;switch(t){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(e);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(e);break;case"pusher_internal:member_added":var r=this.members.addMember(n);this.emit("pusher:member_added",r);break;case"pusher_internal:member_removed":var i=this.members.removeMember(n);i&&this.emit("pusher:member_removed",i)}}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(e.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var Oe=n(1),De=n(0);class Fe extends Ae{constructor(e,t,n){super(e,t),this.key=null,this.nacl=n}authorize(e,t){super.authorize(e,((e,n)=>{if(e)return void t(e,n);let r=n.shared_secret;r?(this.key=Object(De.decode)(r),delete n.shared_secret,t(null,n)):t(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null)}))}trigger(e,t){throw new g("Client events are not currently supported for encrypted channels")}handleEvent(e){var t=e.event,n=e.data;0!==t.indexOf("pusher_internal:")&&0!==t.indexOf("pusher:")?this.handleEncryptedEvent(t,n):super.handleEvent(e)}handleEncryptedEvent(e,t){if(!this.key)return void Q.debug("Received encrypted event before key has been retrieved from the authEndpoint");if(!t.ciphertext||!t.nonce)return void Q.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+t);let n=Object(De.decode)(t.ciphertext);if(n.length<this.nacl.secretbox.overheadLength)return void Q.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${n.length}`);let r=Object(De.decode)(t.nonce);if(r.length<this.nacl.secretbox.nonceLength)return void Q.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${r.length}`);let i=this.nacl.secretbox.open(n,r,this.key);if(null===i)return Q.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),void this.authorize(this.pusher.connection.socket_id,((t,s)=>{t?Q.error(`Failed to make a request to the authEndpoint: ${s}. Unable to fetch new key, so dropping encrypted event`):(i=this.nacl.secretbox.open(n,r,this.key),null!==i?this.emit(e,this.getDataToEmit(i)):Q.error("Failed to decrypt event with new key. Dropping encrypted event"))}));this.emit(e,this.getDataToEmit(i))}getDataToEmit(e){let t=Object(Oe.decode)(e);try{return JSON.parse(t)}catch(n){return t}}}class je extends ae{constructor(e,t){super(),this.state="initialized",this.connection=null,this.key=e,this.options=t,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var n=ut.getNetwork();n.bind("online",(()=>{this.timeline.info({netinfo:"online"}),"connecting"!==this.state&&"unavailable"!==this.state||this.retryIn(0)})),n.bind("offline",(()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()})),this.updateStrategy()}connect(){this.connection||this.runner||(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))}send(e){return!!this.connection&&this.connection.send(e)}send_event(e,t,n){return!!this.connection&&this.connection.send_event(e,t,n)}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var e=(t,n)=>{t?this.runner=this.strategy.connect(0,e):"error"===n.action?(this.emit("error",{type:"HandshakeError",error:n.error}),this.timeline.error({handshakeError:n.error})):(this.abortConnecting(),this.handshakeCallbacks[n.action](n))};this.runner=this.strategy.connect(0,e)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(e){this.timeline.info({action:"retry",delay:e}),e>0&&this.emit("connecting_in",Math.round(e/1e3)),this.retryTimer=new R(e||0,(()=>{this.disconnectInternally(),this.connect()}))}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new R(this.options.unavailableTimeout,(()=>{this.updateState("unavailable")}))}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new R(this.options.pongTimeout,(()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)}))}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new R(this.activityTimeout,(()=>{this.sendActivityCheck()})))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(e){return j({},e,{message:e=>{this.resetActivityCheck(),this.emit("message",e)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:e=>{this.emit("error",e)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(e){return j({},e,{connected:e=>{this.activityTimeout=Math.min(this.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(e.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let e=e=>t=>{t.error&&this.emit("error",{type:"WebSocketError",error:t.error}),e(t)};return{tls_only:e((()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)})),refused:e((()=>{this.disconnect()})),backoff:e((()=>{this.retryIn(1e3)})),retry:e((()=>{this.retryIn(0)}))}}setConnection(e){for(var t in this.connection=e,this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()}abandonConnection(){if(this.connection){for(var e in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);var t=this.connection;return this.connection=null,t}}updateState(e,t){var n=this.state;if(this.state=e,n!==e){var r=e;"connected"===r&&(r+=" with new socket ID "+t.socket_id),Q.debug("State changed",n+" -> "+r),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:n,current:e}),this.emit(e,t)}}shouldRetry(){return"connecting"===this.state||"connected"===this.state}}class Le{constructor(){this.channels={}}add(e,t){return this.channels[e]||(this.channels[e]=function(e,t){if(0===e.indexOf("private-encrypted-")){if(t.config.nacl)return Ue.createEncryptedChannel(e,t,t.config.nacl);let n="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",r=u("encryptedChannelSupport");throw new g(`${n}. ${r}`)}if(0===e.indexOf("private-"))return Ue.createPrivateChannel(e,t);if(0===e.indexOf("presence-"))return Ue.createPresenceChannel(e,t);if(0===e.indexOf("#"))throw new h('Cannot create a channel with name "'+e+'".');return Ue.createChannel(e,t)}(e,t)),this.channels[e]}all(){return function(e){var t=[];return M(e,(function(e){t.push(e)})),t}(this.channels)}find(e){return this.channels[e]}remove(e){var t=this.channels[e];return delete this.channels[e],t}disconnect(){M(this.channels,(function(e){e.disconnect()}))}}var Ue={createChannels:()=>new Le,createConnectionManager:(e,t)=>new je(e,t),createChannel:(e,t)=>new Ie(e,t),createPrivateChannel:(e,t)=>new Ae(e,t),createPresenceChannel:(e,t)=>new Re(e,t),createEncryptedChannel:(e,t,n)=>new Fe(e,t,n),createTimelineSender:(e,t)=>new Ce(e,t),createHandshake:(e,t)=>new Te(e,t),createAssistantToTheTransportManager:(e,t,n)=>new Ee(e,t,n)};class Me{constructor(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}getAssistant(e){return Ue.createAssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class ze{constructor(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}isSupported(){return H(this.strategies,F.method("isSupported"))}connect(e,t){var n=this.strategies,r=0,i=this.timeout,s=null,o=(a,l)=>{l?t(null,l):(r+=1,this.loop&&(r%=n.length),r<n.length?(i&&(i*=2,this.timeoutLimit&&(i=Math.min(i,this.timeoutLimit))),s=this.tryStrategy(n[r],e,{timeout:i,failFast:this.failFast},o)):t(!0))};return s=this.tryStrategy(n[r],e,{timeout:i,failFast:this.failFast},o),{abort:function(){s.abort()},forceMinPriority:function(t){e=t,s&&s.forceMinPriority(t)}}}tryStrategy(e,t,n,r){var i=null,s=null;return n.timeout>0&&(i=new R(n.timeout,(function(){s.abort(),r(!0)}))),s=e.connect(t,(function(e,t){e&&i&&i.isRunning()&&!n.failFast||(i&&i.ensureAborted(),r(e,t))})),{abort:function(){i&&i.ensureAborted(),s.abort()},forceMinPriority:function(e){s.forceMinPriority(e)}}}}class Ve{constructor(e){this.strategies=e}isSupported(){return H(this.strategies,F.method("isSupported"))}connect(e,t){return function(e,t,n){var r=B(e,(function(e,r,i,s){return e.connect(t,n(r,s))}));return{abort:function(){V(r,Be)},forceMinPriority:function(e){V(r,(function(t){t.forceMinPriority(e)}))}}}(this.strategies,e,(function(e,n){return function(r,i){n[e].error=r,r?function(e){return function(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0}(e,(function(e){return Boolean(e.error)}))}(n)&&t(!0):(V(n,(function(e){e.forceMinPriority(i.transport.priority)})),t(null,i))}}))}}function Be(e){e.error||e.aborted||(e.abort(),e.aborted=!0)}class $e{constructor(e,t,n){this.strategy=e,this.transports=t,this.ttl=n.ttl||18e5,this.usingTLS=n.useTLS,this.timeline=n.timeline}isSupported(){return this.strategy.isSupported()}connect(e,t){var n=this.usingTLS,r=function(e){var t=ut.getLocalStorage();if(t)try{var n=t[qe(e)];if(n)return JSON.parse(n)}catch(r){He(e)}return null}(n),i=r&&r.cacheSkipCount?r.cacheSkipCount:0,s=[this.strategy];if(r&&r.timestamp+this.ttl>=F.now()){var o=this.transports[r.transport];o&&(["ws","wss"].includes(r.transport)||i>3?(this.timeline.info({cached:!0,transport:r.transport,latency:r.latency}),s.push(new ze([o],{timeout:2*r.latency+1e3,failFast:!0}))):i++)}var a=F.now(),l=s.pop().connect(e,(function r(o,c){o?(He(n),s.length>0?(a=F.now(),l=s.pop().connect(e,r)):t(o)):(function(e,t,n,r){var i=ut.getLocalStorage();if(i)try{i[qe(e)]=G({timestamp:F.now(),transport:t,latency:n,cacheSkipCount:r})}catch(s){}}(n,c.transport.name,F.now()-a,i),t(null,c))}));return{abort:function(){l.abort()},forceMinPriority:function(t){e=t,l&&l.forceMinPriority(t)}}}}function qe(e){return"pusherTransport"+(e?"TLS":"NonTLS")}function He(e){var t=ut.getLocalStorage();if(t)try{delete t[qe(e)]}catch(n){}}class Ke{constructor(e,t){let{delay:n}=t;this.strategy=e,this.options={delay:n}}isSupported(){return this.strategy.isSupported()}connect(e,t){var n,r=this.strategy,i=new R(this.options.delay,(function(){n=r.connect(e,t)}));return{abort:function(){i.ensureAborted(),n&&n.abort()},forceMinPriority:function(t){e=t,n&&n.forceMinPriority(t)}}}}class We{constructor(e,t,n){this.test=e,this.trueBranch=t,this.falseBranch=n}isSupported(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()}connect(e,t){return(this.test()?this.trueBranch:this.falseBranch).connect(e,t)}}class Ge{constructor(e){this.strategy=e}isSupported(){return this.strategy.isSupported()}connect(e,t){var n=this.strategy.connect(e,(function(e,r){r&&n.abort(),t(e,r)}));return n}}function Qe(e){return function(){return e.isSupported()}}var Je,Ye=function(e,t,n){var r={};function i(t,i,s,o,a){var l=n(e,t,i,s,o,a);return r[t]=l,l}var s,o=Object.assign({},t,{hostNonTLS:e.wsHost+":"+e.wsPort,hostTLS:e.wsHost+":"+e.wssPort,httpPath:e.wsPath}),a=Object.assign({},o,{useTLS:!0}),l=Object.assign({},t,{hostNonTLS:e.httpHost+":"+e.httpPort,hostTLS:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}),c={loop:!0,timeout:15e3,timeoutLimit:6e4},u=new Me({minPingDelay:1e4,maxPingDelay:e.activityTimeout}),d=new Me({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),h=i("ws","ws",3,o,u),f=i("wss","ws",3,a,u),p=i("sockjs","sockjs",1,l),m=i("xhr_streaming","xhr_streaming",1,l,d),g=i("xdr_streaming","xdr_streaming",1,l,d),v=i("xhr_polling","xhr_polling",1,l),y=i("xdr_polling","xdr_polling",1,l),b=new ze([h],c),w=new ze([f],c),_=new ze([p],c),E=new ze([new We(Qe(m),m,g)],c),x=new ze([new We(Qe(v),v,y)],c),S=new ze([new We(Qe(E),new Ve([E,new Ke(x,{delay:4e3})]),x)],c),k=new We(Qe(S),S,_);return s=t.useTLS?new Ve([b,new Ke(k,{delay:2e3})]):new Ve([b,new Ke(w,{delay:2e3}),new Ke(k,{delay:5e3})]),new $e(new Ge(new We(Qe(h),s,k)),r,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},Xe={getRequest:function(e){var t=new window.XDomainRequest;return t.ontimeout=function(){e.emit("error",new f),e.close()},t.onerror=function(t){e.emit("error",t),e.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText),e.emit("finished",200),e.close()},t},abortRequest:function(e){e.ontimeout=e.onerror=e.onprogress=e.onload=null,e.abort()}};class Ze extends ae{constructor(e,t,n){super(),this.hooks=e,this.method=t,this.url=n}start(e){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},ut.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(e)}close(){this.unloader&&(ut.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(e,t){for(;;){var n=this.advanceBuffer(t);if(!n)break;this.emit("chunk",{status:e,data:n})}this.isBufferTooLong(t)&&this.emit("buffer_too_long")}advanceBuffer(e){var t=e.slice(this.position),n=t.indexOf("\n");return-1!==n?(this.position+=n+1,t.slice(0,n)):null}isBufferTooLong(e){return this.position===e.length&&e.length>262144}}!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=3]="CLOSED"}(Je||(Je={}));var et=Je,tt=1;function nt(e){var t=-1===e.indexOf("?")?"?":"&";return e+t+"t="+ +new Date+"&n="+tt++}function rt(e){return ut.randomInt(e)}var it,st=class{constructor(e,t){this.hooks=e,this.session=rt(1e3)+"/"+function(e){for(var t=[],n=0;n<e;n++)t.push(rt(32).toString(32));return t.join("")}(8),this.location=function(e){var t=/([^\?]*)\/*(\??.*)/.exec(e);return{base:t[1],queryString:t[2]}}(t),this.readyState=et.CONNECTING,this.openStream()}send(e){return this.sendRaw(JSON.stringify([e]))}ping(){this.hooks.sendHeartbeat(this)}close(e,t){this.onClose(e,t,!0)}sendRaw(e){if(this.readyState!==et.OPEN)return!1;try{return ut.createSocketRequest("POST",nt((t=this.location,n=this.session,t.base+"/"+n+"/xhr_send"))).start(e),!0}catch(r){return!1}var t,n}reconnect(){this.closeStream(),this.openStream()}onClose(e,t,n){this.closeStream(),this.readyState=et.CLOSED,this.onclose&&this.onclose({code:e,reason:t,wasClean:n})}onChunk(e){var t;if(200===e.status)switch(this.readyState===et.OPEN&&this.onActivity(),e.data.slice(0,1)){case"o":t=JSON.parse(e.data.slice(1)||"{}"),this.onOpen(t);break;case"a":t=JSON.parse(e.data.slice(1)||"[]");for(var n=0;n<t.length;n++)this.onEvent(t[n]);break;case"m":t=JSON.parse(e.data.slice(1)||"null"),this.onEvent(t);break;case"h":this.hooks.onHeartbeat(this);break;case"c":t=JSON.parse(e.data.slice(1)||"[]"),this.onClose(t[0],t[1],!0)}}onOpen(e){this.readyState===et.CONNECTING?(e&&e.hostname&&(this.location.base=function(e,t){var n=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(e);return n[1]+t+n[3]}(this.location.base,e.hostname)),this.readyState=et.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(e){this.readyState===et.OPEN&&this.onmessage&&this.onmessage({data:e})}onActivity(){this.onactivity&&this.onactivity()}onError(e){this.onerror&&this.onerror(e)}openStream(){this.stream=ut.createSocketRequest("POST",nt(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",(e=>{this.onChunk(e)})),this.stream.bind("finished",(e=>{this.hooks.onFinished(this,e)})),this.stream.bind("buffer_too_long",(()=>{this.reconnect()}));try{this.stream.start()}catch(e){F.defer((()=>{this.onError(e),this.onClose(1006,"Could not start streaming",!1)}))}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}},ot={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr_streaming"+e.queryString},onHeartbeat:function(e){e.sendRaw("[]")},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){e.onClose(1006,"Connection interrupted ("+t+")",!1)}},at={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr"+e.queryString},onHeartbeat:function(){},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){200===t?e.reconnect():e.onClose(1006,"Connection interrupted ("+t+")",!1)}},lt={getRequest:function(e){var t=new(ut.getXHRAPI());return t.onreadystatechange=t.onprogress=function(){switch(t.readyState){case 3:t.responseText&&t.responseText.length>0&&e.onChunk(t.status,t.responseText);break;case 4:t.responseText&&t.responseText.length>0&&e.onChunk(t.status,t.responseText),e.emit("finished",t.status),e.close()}},t},abortRequest:function(e){e.onreadystatechange=null,e.abort()}},ct={createStreamingSocket(e){return this.createSocket(ot,e)},createPollingSocket(e){return this.createSocket(at,e)},createSocket:(e,t)=>new st(e,t),createXHR(e,t){return this.createRequest(lt,e,t)},createRequest:(e,t,n)=>new Ze(e,t,n),createXDR:function(e,t){return this.createRequest(Xe,e,t)}},ut={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:i,DependenciesReceivers:o,getDefaultStrategy:Ye,Transports:we,transportConnectionInitializer:function(){var e=this;e.timeline.info(e.buildTimelineMessage({transport:e.name+(e.options.useTLS?"s":"")})),e.hooks.isInitialized()?e.changeState("initialized"):e.hooks.file?(e.changeState("initializing"),a.load(e.hooks.file,{useTLS:e.options.useTLS},(function(t,n){e.hooks.isInitialized()?(e.changeState("initialized"),n(!0)):(t&&e.onError(t),e.onClose(),n(!1))}))):e.onClose()},HTTPFactory:ct,TimelineTransport:Z,getXHRAPI:()=>window.XMLHttpRequest,getWebSocketAPI:()=>window.WebSocket||window.MozWebSocket,setup(e){window.Pusher=e;var t=()=>{this.onDocumentBody(e.ready)};window.JSON?t():a.load("json2",{},t)},getDocument:()=>document,getProtocol(){return this.getDocument().location.protocol},getAuthorizers:()=>({ajax:w,jsonp:J}),onDocumentBody(e){document.body?e():setTimeout((()=>{this.onDocumentBody(e)}),0)},createJSONPRequest:(e,t)=>new X(e,t),createScriptRequest:e=>new Y(e),getLocalStorage(){try{return window.localStorage}catch(e){return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){return new(this.getXHRAPI())},createMicrosoftXHR:()=>new ActiveXObject("Microsoft.XMLHTTP"),getNetwork:()=>_e,createWebSocket(e){return new(this.getWebSocketAPI())(e)},createSocketRequest(e,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(e,t);if(this.isXDRSupported(0===t.indexOf("https:")))return this.HTTPFactory.createXDR(e,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var e=this.getXHRAPI();return Boolean(e)&&void 0!==(new e).withCredentials},isXDRSupported(e){var t=e?"https:":"http:",n=this.getProtocol();return Boolean(window.XDomainRequest)&&n===t},addUnloadListener(e){void 0!==window.addEventListener?window.addEventListener("unload",e,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",e)},removeUnloadListener(e){void 0!==window.addEventListener?window.removeEventListener("unload",e,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",e)},randomInt:e=>Math.floor((window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)*e)};!function(e){e[e.ERROR=3]="ERROR",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"}(it||(it={}));var dt=it;class ht{constructor(e,t,n){this.key=e,this.session=t,this.events=[],this.options=n||{},this.sent=0,this.uniqueID=0}log(e,t){e<=this.options.level&&(this.events.push(j({},t,{timestamp:F.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(e){this.log(dt.ERROR,e)}info(e){this.log(dt.INFO,e)}debug(e){this.log(dt.DEBUG,e)}isEmpty(){return 0===this.events.length}send(e,t){var n=j({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],e(n,((e,n)=>{e||this.sent++,t&&t(e,n)})),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class ft{constructor(e,t,n,r){this.name=e,this.priority=t,this.transport=n,this.options=r||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(e,t){if(!this.isSupported())return pt(new y,t);if(this.priority<e)return pt(new p,t);var n=!1,r=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),i=null,s=function(){r.unbind("initialized",s),r.connect()},o=function(){i=Ue.createHandshake(r,(function(e){n=!0,c(),t(null,e)}))},a=function(e){c(),t(e)},l=function(){var e;c(),e=G(r),t(new m(e))},c=function(){r.unbind("initialized",s),r.unbind("open",o),r.unbind("error",a),r.unbind("closed",l)};return r.bind("initialized",s),r.bind("open",o),r.bind("error",a),r.bind("closed",l),r.initialize(),{abort:()=>{n||(c(),i?i.close():r.close())},forceMinPriority:e=>{n||this.priority<e&&(i?i.close():r.close())}}}}function pt(e,t){return F.defer((function(){t(e)})),{abort:function(){},forceMinPriority:function(){}}}const{Transports:mt}=ut;var gt=function(e,t,n,r,i,s){var o,a=mt[n];if(!a)throw new v(n);return e.enabledTransports&&-1===U(e.enabledTransports,t)||e.disabledTransports&&-1!==U(e.disabledTransports,t)?o=vt:(i=Object.assign({ignoreNullOrigin:e.ignoreNullOrigin},i),o=new ft(t,r,s?s.getAssistant(a):a,i)),o},vt={isSupported:function(){return!1},connect:function(e,t){var n=F.defer((function(){t(new y)}));return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}},yt=e=>{if("undefined"===typeof ut.getAuthorizers()[e.transport])throw`'${e.transport}' is not a recognized auth transport`;return(t,n)=>{const r=((e,t)=>{var n="socket_id="+encodeURIComponent(e.socketId);for(var r in t.params)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(t.params[r]);if(null!=t.paramsProvider){let e=t.paramsProvider();for(var r in e)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(e[r])}return n})(t,e);ut.getAuthorizers()[e.transport](ut,r,e,c.UserAuthentication,n)}},bt=e=>{if("undefined"===typeof ut.getAuthorizers()[e.transport])throw`'${e.transport}' is not a recognized auth transport`;return(t,n)=>{const r=((e,t)=>{var n="socket_id="+encodeURIComponent(e.socketId);for(var r in n+="&channel_name="+encodeURIComponent(e.channelName),t.params)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(t.params[r]);if(null!=t.paramsProvider){let e=t.paramsProvider();for(var r in e)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(e[r])}return n})(t,e);ut.getAuthorizers()[e.transport](ut,r,e,c.ChannelAuthorization,n)}};function wt(e){return e.httpHost?e.httpHost:e.cluster?`sockjs-${e.cluster}.pusher.com`:s.httpHost}function _t(e){return e.wsHost?e.wsHost:`ws-${e.cluster}.pusher.com`}function Et(e){return"https:"===ut.getProtocol()||!1!==e.forceTLS}function xt(e){return"enableStats"in e?e.enableStats:"disableStats"in e&&!e.disableStats}function St(e){const t=Object.assign(Object.assign({},s.userAuthentication),e.userAuthentication);return"customHandler"in t&&null!=t.customHandler?t.customHandler:yt(t)}function kt(e,t){const n=function(e,t){let n;return"channelAuthorization"in e?n=Object.assign(Object.assign({},s.channelAuthorization),e.channelAuthorization):(n={transport:e.authTransport||s.authTransport,endpoint:e.authEndpoint||s.authEndpoint},"auth"in e&&("params"in e.auth&&(n.params=e.auth.params),"headers"in e.auth&&(n.headers=e.auth.headers)),"authorizer"in e&&(n.customHandler=((e,t,n)=>{const r={authTransport:t.transport,authEndpoint:t.endpoint,auth:{params:t.params,headers:t.headers}};return(t,i)=>{const s=e.channel(t.channelName);n(s,r).authorize(t.socketId,i)}})(t,n,e.authorizer))),n}(e,t);return"customHandler"in n&&null!=n.customHandler?n.customHandler:bt(n)}class Tt extends ae{constructor(e){super((function(e,t){Q.debug(`No callbacks on watchlist events for ${e}`)})),this.pusher=e,this.bindWatchlistInternalEvent()}handleEvent(e){e.data.events.forEach((e=>{this.emit(e.name,e)}))}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",(e=>{"pusher_internal:watchlist_events"===e.event&&this.handleEvent(e)}))}}var Ct=function(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),resolve:e,reject:t}};class It extends ae{constructor(e){super((function(e,t){Q.debug("No callbacks on user for "+e)})),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(e,t)=>{if(e)return Q.warn(`Error during signin: ${e}`),void this._cleanup();this.pusher.send_event("pusher:signin",{auth:t.auth,user_data:t.user_data})},this.pusher=e,this.pusher.connection.bind("state_change",(e=>{let{previous:t,current:n}=e;"connected"!==t&&"connected"===n&&this._signin(),"connected"===t&&"connected"!==n&&(this._cleanup(),this._newSigninPromiseIfNeeded())})),this.watchlist=new Tt(e),this.pusher.connection.bind("message",(e=>{"pusher:signin_success"===e.event&&this._onSigninSuccess(e.data),this.serverToUserChannel&&this.serverToUserChannel.name===e.channel&&this.serverToUserChannel.handleEvent(e)}))}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),"connected"===this.pusher.connection.state&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(e){try{this.user_data=JSON.parse(e.user_data)}catch(t){return Q.error(`Failed parsing user data after signin: ${e.user_data}`),void this._cleanup()}if("string"!==typeof this.user_data.id||""===this.user_data.id)return Q.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),void this._cleanup();this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){this.serverToUserChannel=new Ie(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global(((e,t)=>{0!==e.indexOf("pusher_internal:")&&0!==e.indexOf("pusher:")&&this.emit(e,t)})),(e=>{e.subscriptionPending&&e.subscriptionCancelled?e.reinstateSubscription():e.subscriptionPending||"connected"!==this.pusher.connection.state||e.subscribe()})(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested)return;if(this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:e,resolve:t,reject:n}=Ct();e.done=!1;const r=()=>{e.done=!0};e.then(r).catch(r),this.signinDonePromise=e,this._signinDoneResolve=t}}class At{static ready(){At.isReady=!0;for(var e=0,t=At.instances.length;e<t;e++)At.instances[e].connect()}static getClientFeatures(){return z(q({ws:ut.Transports.ws},(function(e){return e.isSupported({})})))}constructor(e,t){!function(e){if(null===e||void 0===e)throw"You must pass your app key when you instantiate Pusher."}(e),function(e){if(null==e)throw"You must pass an options object";if(null==e.cluster)throw"Options object must provide a cluster";"disableStats"in e&&Q.warn("The disableStats option is deprecated in favor of enableStats")}(t),this.key=e,this.config=function(e,t){let n={activityTimeout:e.activityTimeout||s.activityTimeout,cluster:e.cluster,httpPath:e.httpPath||s.httpPath,httpPort:e.httpPort||s.httpPort,httpsPort:e.httpsPort||s.httpsPort,pongTimeout:e.pongTimeout||s.pongTimeout,statsHost:e.statsHost||s.stats_host,unavailableTimeout:e.unavailableTimeout||s.unavailableTimeout,wsPath:e.wsPath||s.wsPath,wsPort:e.wsPort||s.wsPort,wssPort:e.wssPort||s.wssPort,enableStats:xt(e),httpHost:wt(e),useTLS:Et(e),wsHost:_t(e),userAuthenticator:St(e),channelAuthorizer:kt(e,t)};return"disabledTransports"in e&&(n.disabledTransports=e.disabledTransports),"enabledTransports"in e&&(n.enabledTransports=e.enabledTransports),"ignoreNullOrigin"in e&&(n.ignoreNullOrigin=e.ignoreNullOrigin),"timelineParams"in e&&(n.timelineParams=e.timelineParams),"nacl"in e&&(n.nacl=e.nacl),n}(t,this),this.channels=Ue.createChannels(),this.global_emitter=new ae,this.sessionID=ut.randomInt(1e9),this.timeline=new ht(this.key,this.sessionID,{cluster:this.config.cluster,features:At.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:dt.INFO,version:s.VERSION}),this.config.enableStats&&(this.timelineSender=Ue.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+ut.TimelineTransport.name})),this.connection=Ue.createConnectionManager(this.key,{getStrategy:e=>ut.getDefaultStrategy(this.config,e,gt),timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",(()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())})),this.connection.bind("message",(e=>{var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var n=this.channel(e.channel);n&&n.handleEvent(e)}t||this.global_emitter.emit(e.event,e.data)})),this.connection.bind("connecting",(()=>{this.channels.disconnect()})),this.connection.bind("disconnected",(()=>{this.channels.disconnect()})),this.connection.bind("error",(e=>{Q.warn(e)})),At.instances.push(this),this.timeline.info({instances:At.instances.length}),this.user=new It(this),At.isReady&&this.connect()}channel(e){return this.channels.find(e)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var e=this.connection.isUsingTLS(),t=this.timelineSender;this.timelineSenderTimer=new O(6e4,(function(){t.send(e)}))}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(e,t,n){return this.global_emitter.bind(e,t,n),this}unbind(e,t,n){return this.global_emitter.unbind(e,t,n),this}bind_global(e){return this.global_emitter.bind_global(e),this}unbind_global(e){return this.global_emitter.unbind_global(e),this}unbind_all(e){return this.global_emitter.unbind_all(),this}subscribeAll(){var e;for(e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)}subscribe(e){var t=this.channels.add(e,this);return t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():t.subscriptionPending||"connected"!==this.connection.state||t.subscribe(),t}unsubscribe(e){var t=this.channels.find(e);t&&t.subscriptionPending?t.cancelSubscription():(t=this.channels.remove(e))&&t.subscribed&&t.unsubscribe()}send_event(e,t,n){return this.connection.send_event(e,t,n)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}At.instances=[],At.isReady=!1,At.logToConsole=!1,At.Runtime=ut,At.ScriptReceivers=ut.ScriptReceivers,At.DependenciesReceivers=ut.DependenciesReceivers,At.auth_callbacks=ut.auth_callbacks;var Pt=t.default=At;ut.setup(At)}])},e.exports=t()},153:(e,t,n)=>{"use strict";var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var _=Array.isArray,E=Object.prototype.hasOwnProperty,x={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&!S.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:x.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+I(l,0):s,_(o)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),A(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",_(e))for(var c=0;c<e.length;c++){var u=s+I(a=e[c],c);l+=A(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=A(a=a.value,t,i,u=s+I(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function N(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},O={transition:null},D={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:O,ReactCurrentOwner:x};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=F,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=x.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,O(E);else{var t=r(u);null!==t&&D(_,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,y(T),T=-1),p=!0;var s=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&D(_,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,S=!1,k=null,T=-1,C=5,I=-1;function A(){return!(t.unstable_now()-I<C)}function P(){if(null!==k){var e=t.unstable_now();I=e;var n=!0;try{n=k(!0,e)}finally{n?x():(S=!1,k=null)}}else S=!1}if("function"===typeof b)x=function(){b(P)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,R=N.port2;N.port1.onmessage=P,x=function(){R.postMessage(null)}}else x=function(){v(P,0)};function O(e){k=e,S||(S=!0,x())}function D(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(y(T),T=-1):g=!0,D(_,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,O(E))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{"use strict";var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{"use strict";e.exports=n(153)},730:(e,t,n)=>{"use strict";var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),E=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var j,L=Object.assign;function U(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var M=!1;function z(e,t){if(!e||M)return"";M=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{M=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function V(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case E:return"Portal";case k:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,xe=null,Se=null;function ke(e){if(e=bi(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=_i(t),Ee(e.stateNode,e.type,t))}}function Te(e){xe?Se?Se.push(e):Se=[e]:xe=e}function Ce(){if(xe){var e=xe,t=Se;if(Se=xe=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ie(e,t){return e(t)}function Ae(){}var Pe=!1;function Ne(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Ie(e,t,n)}finally{Pe=!1,(null!==xe||null!==Se)&&(Ae(),Ce())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Oe=!1}function Fe(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var je=!1,Le=null,Ue=!1,Me=null,ze={onError:function(e){je=!0,Le=e}};function Ve(e,t,n,r,i,s,o,a,l){je=!1,Le=null,Fe.apply(ze,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===r)return qe(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var We=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Je=i.unstable_requestPaint,Ye=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=dt(a):0!==(s&=o)&&(r=dt(s))}else 0!==(o=n&~i)?r=dt(o):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,Et,xt,St,kt,Tt=!1,Ct=[],It=null,At=null,Pt=null,Nt=new Map,Rt=new Map,Ot=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function jt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=yi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void kt(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Mt(e,t,n){Ut(e)&&n.delete(t)}function zt(){Tt=!1,null!==It&&Ut(It)&&(It=null),null!==At&&Ut(At)&&(At=null),null!==Pt&&Ut(Pt)&&(Pt=null),Nt.forEach(Mt),Rt.forEach(Mt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Vt(t,e)}if(0<Ct.length){Vt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Vt(It,e),null!==At&&Vt(At,e),null!==Pt&&Vt(Pt,e),Nt.forEach(t),Rt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var $t=w.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var i=bt,s=$t.transition;$t.transition=null;try{bt=1,Wt(e,t,n,r)}finally{bt=i,$t.transition=s}}function Kt(e,t,n,r){var i=bt,s=$t.transition;$t.transition=null;try{bt=4,Wt(e,t,n,r)}finally{bt=i,$t.transition=s}}function Wt(e,t,n,r){if(qt){var i=Qt(e,t,n,r);if(null===i)qr(e,t,r,Gt,n),Ft(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=jt(It,e,t,n,r,i),!0;case"dragenter":return At=jt(At,e,t,n,r,i),!0;case"mouseover":return Pt=jt(Pt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Nt.set(s,jt(Nt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,jt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&_t(s),null===(s=Qt(e,t,n,r))&&qr(e,t,r,Gt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=yi(e=_e(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=L({},cn,{view:0,detail:0}),hn=sn(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(L({},fn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),vn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),wn=sn(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function kn(){return Sn}var Tn=L({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=sn(Tn),In=sn(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Pn=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(Nn),On=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Fn=null;u&&"documentMode"in document&&(Fn=document.documentMode);var jn=u&&"TextEvent"in window&&!Fn,Ln=u&&(!Dn||Fn&&8<Fn&&11>=Fn),Un=String.fromCharCode(32),Mn=!1;function zn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Hn(e,t,n,r){Te(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Wn=null;function Gn(e){Ur(e,0)}function Qn(e){if(W(wi(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Wn=Kn=null)}function nr(e){if("value"===e.propertyName&&Qn(Wn)){var t=[];Hn(t,Wn,e,_e(e)),Ne(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Wn)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Kr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},xr={},Sr={};function kr(e){if(xr[e])return xr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return xr[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Tr=kr("animationend"),Cr=kr("animationiteration"),Ir=kr("animationstart"),Ar=kr("transitionend"),Pr=new Map,Nr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Pr.set(e,t),l(t,[e])}for(var Or=0;Or<Nr.length;Or++){var Dr=Nr[Or];Rr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Rr(Tr,"onAnimationEnd"),Rr(Cr,"onAnimationIteration"),Rr(Ir,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ve.apply(this,arguments),je){if(!je)throw Error(s(198));var u=Le;je=!1,Le=null,Ue||(Ue=!0,Me=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,a,c),s=l}}}if(Ue)throw e=Me,Ue=!1,Me=null,e}function Mr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Vr]){e[Vr]=!0,o.forEach((function(t){"selectionchange"!==t&&(jr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,zr("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Jt(t)){case 1:var i=Ht;break;case 4:i=Kt;break;default:i=Wt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=yi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Ne((function(){var r=s,i=_e(n),o=[];e:{var a=Pr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Tr:case Cr:case Ir:l=vn;break;case Ar:l=Pn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Re(p,h))&&u.push(Hr(p,m,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:wi(l),f=null==c?a:wi(c),(a=new u(m,p+"leave",l,n,i)).target=d,a.relatedTarget=f,m=null,yi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Wr(f))p++;for(f=0,m=h;m;m=Wr(m))f++;for(;0<p-f;)u=Wr(u),p--;for(;0<f-p;)h=Wr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wr(u),h=Wr(h)}u=null}else u=null;null!==l&&Gr(o,a,l,u,!1),null!==c&&null!==d&&Gr(o,d,c,u,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Jn;else if(qn(a))if(Yn)g=or;else{g=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(o,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?wi(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,i)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):(Xt="value"in(Yt=i)?Yt.value:Yt.textContent,Bn=!0)),0<(v=Kr(r,b)).length&&(b=new wn(b,e,null,n,i),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Vn(n))&&(b.data=y))),(y=jn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Mn=!0,Un);case"textInput":return(e=t.data)===Un&&Mn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Dn&&zn(e,t)?(e=en(),Zt=Xt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Ur(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Re(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Re(n,s))&&o.unshift(Hr(n,l,a)):i||null!=(l=Re(n,s))&&o.push(Hr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Jr,"")}function Xr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function _i(e){return e[fi]||null}var Ei=[],xi=-1;function Si(e){return{current:e}}function ki(e){0>xi||(e.current=Ei[xi],Ei[xi]=null,xi--)}function Ti(e,t){xi++,Ei[xi]=e.current,e.current=t}var Ci={},Ii=Si(Ci),Ai=Si(!1),Pi=Ci;function Ni(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){ki(Ai),ki(Ii)}function Di(e,t,n){if(Ii.current!==Ci)throw Error(s(168));Ti(Ii,t),Ti(Ai,n)}function Fi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,$(e)||"Unknown",i));return L({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Pi=Ii.current,Ti(Ii,e),Ti(Ai,Ai.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Fi(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,ki(Ai),ki(Ii),Ti(Ii,e)):ki(Ai),Ti(Ai,n)}var Ui=null,Mi=!1,zi=!1;function Vi(e){null===Ui?Ui=[e]:Ui.push(e)}function Bi(){if(!zi&&null!==Ui){zi=!0;var e=0,t=bt;try{var n=Ui;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Mi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),We(Ze,Bi),i}finally{bt=t,zi=!1}}return null}var $i=[],qi=0,Hi=null,Ki=0,Wi=[],Gi=0,Qi=null,Ji=1,Yi="";function Xi(e,t){$i[qi++]=Ki,$i[qi++]=Hi,Hi=e,Ki=t}function Zi(e,t,n){Wi[Gi++]=Ji,Wi[Gi++]=Yi,Wi[Gi++]=Qi,Qi=e;var r=Ji;e=Yi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ji=1<<32-ot(t)+i|n<<i|r,Yi=s+e}else Ji=1<<s|n<<i|r,Yi=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Hi;)Hi=$i[--qi],$i[qi]=null,Ki=$i[--qi],$i[qi]=null;for(;e===Qi;)Qi=Wi[--Gi],Wi[Gi]=null,Yi=Wi[--Gi],Wi[Gi]=null,Ji=Wi[--Gi],Wi[Gi]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Nc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Ji,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)os(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===x?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&ys(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case E:return(t=Uc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Fc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||F(n))return null!==i?null:d(e,t,n,r,null);vs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||F(r))return d(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(i,d,a[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),s=o(v,s,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(i,d),is&&Xi(i,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(i,a[m],l))&&(s=o(d,s,m),null===u?c=d:u.sibling=d,u=d);return is&&Xi(i,m),c}for(d=r(i,d);m<a.length;m++)null!==(g=p(d,i,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),is&&Xi(i,m),c}function g(i,a,l,c){var u=F(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),is&&Xi(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,c))&&(a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return is&&Xi(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(i,e)})),is&&Xi(i,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===x){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&ys(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=gs(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===x?((s=Fc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Dc(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return a(r);case E:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Uc(o,r.mode,l)).return=r,r=s}return a(r);case R:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(F(o))return g(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Lc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var ws=bs(!0),_s=bs(!1),Es=Si(null),xs=null,Ss=null,ks=null;function Ts(){ks=Ss=xs=null}function Cs(e){var t=Es.current;ki(Es),e._currentValue=t}function Is(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function As(e,t){xs=e,ks=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(ks!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===xs)throw Error(s(308));Ss=e,xs.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var Ns=null;function Rs(e){null===Ns?Ns=[e]:Ns.push(e)}function Os(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Rs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ds(e,r)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fs=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ms(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ds(e,n)}return null===(i=r.interleaved)?(t.next=t,Rs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ds(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Vs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,r){var i=e.updateQueue;Fs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(o=0,u=c=l=null,a=s;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=L({},d,h);break e;case 2:Fs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,o|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);jl|=o,e.lanes=o,e.memoizedState=d}}function $s(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var qs={},Hs=Si(qs),Ks=Si(qs),Ws=Si(qs);function Gs(e){if(e===qs)throw Error(s(174));return e}function Qs(e,t){switch(Ti(Ws,t),Ti(Ks,e),Ti(Hs,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Hs),Ti(Hs,t)}function Js(){ki(Hs),ki(Ks),ki(Ws)}function Ys(e){Gs(Ws.current);var t=Gs(Hs.current),n=le(t,e.type);t!==n&&(Ti(Ks,e),Ti(Hs,n))}function Xs(e){Ks.current===e&&(ki(Hs),ki(Ks))}var Zs=Si(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=w.ReactCurrentDispatcher,io=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ea,e=n(r,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(uo)}if(ro.current=Xo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((so&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,oo.lanes|=d,jl|=d}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ba=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,jl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function xo(){}function So(e,t){var n=oo,r=bo(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ba=!0),r=r.queue,jo(Co.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,No(9,To.bind(null,n,r,i,t),void 0,null),null===Al)throw Error(s(349));0!==(30&so)||ko(n,t,i)}return i}function ko(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function To(e,t,n,r){t.value=n,t.getSnapshot=r,Io(t)&&Ao(e)}function Co(e,t,n){return n((function(){Io(t)&&Ao(e)}))}function Io(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Ao(e){var t=Ds(e,1);null!==t&&nc(t,e,1,-1)}function Po(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function No(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return bo().memoizedState}function Oo(e,t,n,r){var i=yo();oo.flags|=e,i.memoizedState=No(1|t,n,void 0,void 0===r?null:r)}function Do(e,t,n,r){var i=bo();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=No(t,n,s,r))}oo.flags|=e,i.memoizedState=No(1|t,n,s,r)}function Fo(e,t){return Oo(8390656,8,e,t)}function jo(e,t){return Do(2048,8,e,t)}function Lo(e,t){return Do(4,2,e,t)}function Uo(e,t){return Do(4,4,e,t)}function Mo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4,4,Mo.bind(null,t,e),n)}function Vo(){}function Bo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),oo.lanes|=n,jl|=n,e.baseState=!0),t)}function Ho(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{bt=n,io.transition=r}}function Ko(){return bo().memoizedState}function Wo(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Jo(t,n);else if(null!==(n=Os(e,t,n,r))){nc(n,e,r,ec()),Yo(n,t,r)}}function Go(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Jo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Rs(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Os(e,t,i,r))&&(nc(n,e,r,i=ec()),Yo(n,t,r))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Jo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xo={readContext:Ps,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Ps,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:Fo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4194308,4,Mo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oo(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Wo.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Po,useDebugValue:Vo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=Ho.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=yo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Al)throw Error(s(349));0!==(30&so)||ko(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Fo(Co.bind(null,r,o,e),[e]),r.flags|=2048,No(9,To.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Al.identifierPrefix;if(is){var n=Yi;t=":"+t+"R"+(n=(Ji&~(1<<32-ot(Ji)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ps,useCallback:Bo,useContext:Ps,useEffect:jo,useImperativeHandle:zo,useInsertionEffect:Lo,useLayoutEffect:Uo,useMemo:$o,useReducer:_o,useRef:Ro,useState:function(){return _o(wo)},useDebugValue:Vo,useDeferredValue:function(e){return qo(bo(),ao.memoizedState,e)},useTransition:function(){return[_o(wo)[0],bo().memoizedState]},useMutableSource:xo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1},ta={readContext:Ps,useCallback:Bo,useContext:Ps,useEffect:jo,useImperativeHandle:zo,useInsertionEffect:Lo,useLayoutEffect:Uo,useMemo:$o,useReducer:Eo,useRef:Ro,useState:function(){return Eo(wo)},useDebugValue:Vo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:qo(t,ao.memoizedState,e)},useTransition:function(){return[Eo(wo)[0],bo().memoizedState]},useMutableSource:xo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Us(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ms(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Us(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ms(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Us(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ms(e,i,r))&&(nc(t,e,r,n),zs(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oa(e,t,n){var r=!1,i=Ci,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(i=Ri(t)?Pi:Ii.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ni(e,i):Ci),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},js(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ps(s):(s=Ri(t)?Pi:Ii.current,i.context=Ni(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),Bs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ha="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Us(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),da(0,t)},n}function pa(e,t,n){(n=Us(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Us(-1,1)).tag=2,Ms(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ya=w.ReactCurrentOwner,ba=!1;function wa(e,t,n,r){t.child=null===e?_s(t,null,n,r):ws(t,e.child,n,r)}function _a(e,t,n,r,i){n=n.render;var s=t.ref;return As(t,i),r=go(e,t,n,r,s,i),n=vo(),null===e||ba?(is&&n&&es(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function Ea(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Rc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,xa(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return qa(e,t,i)}return t.flags|=1,(e=Oc(s,r)).ref=t.ref,e.return=t,t.child=e}function xa(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(ba=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,qa(e,t,i);0!==(131072&e.flags)&&(ba=!0)}}return Ta(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Ol,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Ol,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ti(Ol,Rl),Rl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ti(Ol,Rl),Rl|=r;return wa(e,t,i,n),t.child}function ka(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ta(e,t,n,r,i){var s=Ri(n)?Pi:Ii.current;return s=Ni(t,s),As(t,i),n=go(e,t,n,r,s,i),r=vo(),null===e||ba?(is&&r&&es(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function Ca(e,t,n,r,i){if(Ri(n)){var s=!0;ji(t)}else s=!1;if(As(t,i),null===t.stateNode)$a(e,t),oa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ps(c):c=Ni(t,c=Ri(n)?Pi:Ii.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&aa(t,o,r,c),Fs=!1;var h=t.memoizedState;o.state=h,Bs(t,r,o,i),l=t.memoizedState,a!==r||h!==l||Ai.current||Fs?("function"===typeof u&&(ra(t,n,u,r),l=t.memoizedState),(a=Fs||sa(t,n,a,r,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ps(l):l=Ni(t,l=Ri(n)?Pi:Ii.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,o,r,l),Fs=!1,h=t.memoizedState,o.state=h,Bs(t,r,o,i);var p=t.memoizedState;a!==d||h!==p||Ai.current||Fs?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(c=Fs||sa(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ia(e,t,n,r,s,i)}function Ia(e,t,n,r,i,s){ka(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Li(t,n,!1),qa(e,t,s);r=t.stateNode,ya.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),Qs(e,t.containerInfo)}function Pa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wa(e,t,n,r),t.child}var Na,Ra,Oa,Da,Fa={dehydrated:null,treeContext:null,retryLane:0};function ja(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var r,i=t.pendingProps,o=Zs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(Zs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=jc(l,i,0,null),e=Fc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ja(n),t.memoizedState=Fa,e):Ua(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ma(e,t,a,r=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=jc({mode:"visible",children:r.children},i,0,null),(o=Fc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=ja(a),t.memoizedState=Fa,o);if(0===(1&t.mode))return Ma(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ma(e,t,a,r=ua(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(r=Al)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ds(e,i),nc(r,e,i,-1))}return mc(),Ma(e,t,a,r=ua(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Wi[Gi++]=Ji,Wi[Gi++]=Yi,Wi[Gi++]=Qi,Ji=e.id,Yi=e.overflow,Qi=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Oc(r,a):(a=Fc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,i}return e=(a=e.child).sibling,i=Oc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=jc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ma(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function za(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Is(e.return,t,n)}function Va(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ba(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&za(e,n,t);else if(19===e.tag)za(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Va(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Va(t,!0,n,null,s);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $a(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ha(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ka(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Wa(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:case 17:return Ri(t.type)&&Oi(),Ka(t),null;case 3:return r=t.stateNode,Js(),ki(Ai),ki(Ii),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ra(e,t),Ka(t),null;case 5:Xs(t);var i=Gs(Ws.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ka(t),null}if(e=Gs(Hs.current),ds(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hi]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(i=0;i<Fr.length;i++)Mr(Fr[i],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":J(r,o),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Mr("invalid",r);break;case"textarea":ie(r,o),Mr("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Mr("scroll",r)}switch(n){case"input":K(r),Z(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,Na(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Mr("cancel",e),Mr("close",e),i=r;break;case"iframe":case"object":case"embed":Mr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Fr.length;i++)Mr(Fr[i],e);i=r;break;case"source":Mr("error",e),i=r;break;case"img":case"image":case"link":Mr("error",e),Mr("load",e),i=r;break;case"details":Mr("toggle",e),i=r;break;case"input":J(e,r),i=Q(e,r),Mr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=L({},r,{value:void 0}),Mr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Mr("invalid",e)}for(o in ye(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Mr("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":K(e),Z(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&null!=t.stateNode)Da(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Gs(Ws.current),Gs(Hs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ka(t),null;case 13:if(ki(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,o=!1;else if(o=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[hi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ka(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ka(t),null);case 4:return Js(),Ra(e,t),null===e&&Br(t.stateNode.containerInfo),Ka(t),null;case 10:return Cs(t.type._context),Ka(t),null;case 19:if(ki(Zs),null===(o=t.memoizedState))return Ka(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ha(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ha(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Bl&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ha(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Ka(t),null}else 2*Ye()-o.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Zs.current,Ti(Zs,r?1&n|2:1&n),t):(Ka(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ka(t),6&t.subtreeFlags&&(t.flags|=8192)):Ka(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ga(e,t){switch(ts(t),t.tag){case 1:return Ri(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),ki(Ai),ki(Ii),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(ki(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(Zs),null;case 4:return Js(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Na=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Gs(Hs.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=L({},i,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Mr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Da=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Ja=!1,Ya="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ja||Za(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Ja&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Sc(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ja=(r=Ja)||null!==n.memoizedState,hl(e,t,n),Ja=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ya),t.forEach((function(t){var r=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(o,a,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Sc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Sc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Sc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(i,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Sc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Sc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Ye())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||d,ml(t,e),Ja=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Za(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Sc(r,n,g)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){_l(h);continue}}null!==p?(p.return=f,Xa=p):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Sc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Xa=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Xa;){var i=Xa,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Qa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=Qa;var c=Ja;if(Qa=o,(Ja=l)&&!c)for(Xa=i;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?El(i):null!==l?(l.return=o,Xa=l):El(i);for(;null!==s;)Xa=s,bl(s,t,n),s=s.sibling;Xa=i,Qa=a,Ja=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Xa=s):wl(e)}}function wl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ja)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&$s(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$s(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&il(t)}catch(f){Sc(t,t.return,f)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function _l(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function El(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Sc(t,i,l)}}var s=t.return;try{il(t)}catch(l){Sc(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Sc(t,o,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var xl,Sl=Math.ceil,kl=w.ReactCurrentDispatcher,Tl=w.ReactCurrentOwner,Cl=w.ReactCurrentBatchConfig,Il=0,Al=null,Pl=null,Nl=0,Rl=0,Ol=Si(0),Dl=0,Fl=null,jl=0,Ll=0,Ul=0,Ml=null,zl=null,Vl=0,Bl=1/0,$l=null,ql=!1,Hl=null,Kl=null,Wl=!1,Gl=null,Ql=0,Jl=0,Yl=null,Xl=-1,Zl=0;function ec(){return 0!==(6&Il)?Ye():-1!==Xl?Xl:Xl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Nl?Nl&-Nl:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Yl=null,Error(s(185));vt(e,n,r),0!==(2&Il)&&e===Al||(e===Al&&(0===(2&Il)&&(Ll|=n),4===Dl&&ac(e,Nl)),rc(e,r),1===n&&0===Il&&0===(1&t.mode)&&(Bl=Ye()+500,Mi&&Bi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=ht(e,e===Al?Nl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Mi=!0,Vi(e)}(lc.bind(null,e)):Vi(lc.bind(null,e)),oi((function(){0===(6&Il)&&Bi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ac(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Xl=-1,Zl=0,0!==(6&Il))throw Error(s(327));var n=e.callbackNode;if(Ec()&&e.callbackNode!==n)return null;var r=ht(e,e===Al?Nl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Il;Il|=2;var o=pc();for(Al===e&&Nl===t||($l=null,Bl=Ye()+500,hc(e,t));;)try{yc();break}catch(l){fc(e,l)}Ts(),kl.current=o,Il=i,null!==Pl?t=0:(Al=null,Nl=0,t=Dl)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Fl,hc(e,0),ac(e,r),rc(e,Ye()),n;if(6===t)ac(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=sc(e,o))),1===t))throw n=Fl,hc(e,0),ac(e,r),rc(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:_c(e,zl,$l);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=Vl+500-Ye())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_c.bind(null,e,zl,$l),t);break}_c(e,zl,$l);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ri(_c.bind(null,e,zl,$l),r);break}_c(e,zl,$l);break;default:throw Error(s(329))}}}return rc(e,Ye()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Ml;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function ac(e,t){for(t&=~Ul,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Il))throw Error(s(327));Ec();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Fl,hc(e,0),ac(e,t),rc(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,zl,$l),rc(e,Ye()),null}function cc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(Bl=Ye()+500,Mi&&Bi())}}function uc(e){null!==Gl&&0===Gl.tag&&0===(6&Il)&&Ec();var t=Il;Il|=1;var n=Cl.transition,r=bt;try{if(Cl.transition=null,bt=1,e)return e()}finally{bt=r,Cl.transition=n,0===(6&(Il=t))&&Bi()}}function dc(){Rl=Ol.current,ki(Ol)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:Js(),ki(Ai),ki(Ii),no();break;case 5:Xs(r);break;case 4:Js();break;case 13:case 19:ki(Zs);break;case 10:Cs(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,Pl=e=Oc(e.current,null),Nl=Rl=t,Dl=0,Fl=null,Ul=Ll=jl=0,zl=Ml=null,null!==Ns){for(t=0;t<Ns.length;t++)if(null!==(r=(n=Ns[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Ns=null}return e}function fc(e,t){for(;;){var n=Pl;try{if(Ts(),ro.current=Xo,co){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,Tl.current=null,null===n||null===n.return){Dl=1,Fl=t,Pl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Nl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ma(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(is&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),ps(ca(c,l));break e}}o=c=ca(c,l),4!==Dl&&(Dl=2),null===Ml?Ml=[o]:Ml.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Vs(o,fa(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Vs(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(w){t=w,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function pc(){var e=kl.current;return kl.current=Xo,null===e?Xo:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Al||0===(268435455&jl)&&0===(268435455&Ll)||ac(Al,Nl)}function gc(e,t){var n=Il;Il|=2;var r=pc();for(Al===e&&Nl===t||($l=null,hc(e,t));;)try{vc();break}catch(i){fc(e,i)}if(Ts(),Il=n,kl.current=r,null!==Pl)throw Error(s(261));return Al=null,Nl=0,Dl}function vc(){for(;null!==Pl;)bc(Pl)}function yc(){for(;null!==Pl&&!Qe();)bc(Pl)}function bc(e){var t=xl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Pl=t,Tl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wa(n,t,Rl)))return void(Pl=n)}else{if(null!==(n=Ga(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function _c(e,t,n){var r=bt,i=Cl.transition;try{Cl.transition=null,bt=1,function(e,t,n,r){do{Ec()}while(null!==Gl);if(0!==(6&Il))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Al&&(Pl=Al=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,Ac(tt,(function(){return Ec(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var a=bt;bt=1;var l=Il;Il|=4,Tl.current=null,function(e,t){if(ei=qt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(_){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(_){Sc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Je(),Il=l,bt=a,Cl.transition=o}else e.current=n;if(Wl&&(Wl=!1,Gl=e,Ql=i),o=e.pendingLanes,0===o&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Ql)&&0!==e.tag&&Ec(),o=e.pendingLanes,0!==(1&o)?e===Yl?Jl++:(Jl=0,Yl=e):Jl=0,Bi()}(e,t,n,r)}finally{Cl.transition=i,bt=r}return null}function Ec(){if(null!==Gl){var e=wt(Ql),t=Cl.transition,n=bt;try{if(Cl.transition=null,bt=16>e?16:e,null===Gl)var r=!1;else{if(e=Gl,Gl=null,Ql=0,0!==(6&Il))throw Error(s(331));var i=Il;for(Il|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var f=(d=Xa).sibling,p=d.return;if(sl(d),d===u){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xa=y;break e}Xa=o.return}}var b=e.current;for(Xa=b;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=b;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(E){Sc(l,l.return,E)}if(l===a){Xa=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Xa=_;break e}Xa=l.return}}if(Il=i,Bi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{bt=n,Cl.transition=t}}return!1}function xc(e,t,n){e=Ms(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Ms(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Nl&n)===n&&(4===Dl||3===Dl&&(130023424&Nl)===Nl&&500>Ye()-Vl?hc(e,0):Ul|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ds(e,t))&&(vt(e,t,n),rc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Tc(e,n)}function Ac(e,t){return We(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nc(e,t,n,r){return new Pc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Nc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Rc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case x:return Fc(n.children,i,o,t);case S:a=8,i|=8;break;case k:return(e=Nc(12,n,t,2|i)).elementType=k,e.lanes=o,e;case A:return(e=Nc(13,n,t,i)).elementType=A,e.lanes=o,e;case P:return(e=Nc(19,n,t,i)).elementType=P,e.lanes=o,e;case O:return jc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case C:a=9;break e;case I:a=11;break e;case N:a=14;break e;case R:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Nc(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Nc(7,e,r,t)).lanes=n,e}function jc(e,t,n,r){return(e=Nc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Nc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Nc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,s,o,a,l){return e=new Mc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Nc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},js(s),e}function Vc(e){if(!e)return Ci;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Fi(e,n,t)}return t}function Bc(e,t,n,r,i,s,o,a,l){return(e=zc(n,r,!0,e,0,s,0,a,l)).context=Vc(null),n=e.current,(s=Us(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Ms(n,s,i),e.current.lanes=i,vt(e,i,r),rc(e,r),e}function $c(e,t,n,r){var i=t.current,s=ec(),o=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Us(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ms(i,t,o))&&(nc(e,i,o,s),zs(e,i,o)),o}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),fs();break;case 5:Ys(t);break;case 1:Ri(t.type)&&ji(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(Es,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?La(e,t,n):(Ti(Zs,1&Zs.current),null!==(e=qa(e,t,n))?e.sibling:null);Ti(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ba(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return qa(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,is&&0!==(1048576&t.flags)&&Zi(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$a(e,t),e=t.pendingProps;var i=Ni(t,Ii.current);As(t,n),i=go(null,t,r,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,js(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=Ia(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch($a(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===N)return 14}return 2}(r),e=na(r,e),i){case 0:t=Ta(null,t,r,e,n);break e;case 1:t=Ca(null,t,r,e,n);break e;case 11:t=_a(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ta(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ca(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Aa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ls(e,t),Bs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pa(e,t,r,n,i=ca(Error(s(423)),t));break e}if(r!==i){t=Pa(e,t,r,n,i=ca(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=_s(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=qa(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Ys(t),null===e&&cs(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),ka(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return La(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_a(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ti(Es,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ai.current){t=qa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Us(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Is(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Is(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,As(t,n),r=r(i=Ps(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),Ea(e,t,r,i=na(r.type,i),n);case 15:return xa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),$a(e,t),t.tag=1,Ri(r)?(e=!0,ji(t)):e=!1,As(t,n),oa(t,r,i),la(t,r,i,n),Ia(null,t,r,!0,e,n);case 19:return Ba(e,t,n);case 22:return Sa(e,t,n)}throw Error(s(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=qc(o);a.call(e)}}$c(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=qc(o);s.call(e)}}var o=Bc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[pi]=o.current,Br(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=qc(l);a.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[pi]=l.current,Br(8===e.nodeType?e.parentNode:e),uc((function(){$c(t,l,n,r)})),l}(n,t,e,i,r);return qc(o)}Qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));$c(e,t,null,null)},Qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){$c(null,e,null,null)})),t[pi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ye()),0===(6&Il)&&(Bl=Ye()+500,Bi()))}break;case 13:uc((function(){var t=Ds(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Kc(e,1)}},Et=function(e){if(13===e.tag){var t=Ds(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},xt=function(e){if(13===e.tag){var t=tc(e),n=Ds(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},St=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(s(90));W(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cc,Ae=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,_i,Te,Ce,cc]},tu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},766:function(e,t){var n,r,i;r=[],n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,s={},o=0,a={};function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(s=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,s)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&void 0!==(s=this._config.beforeFirstChunk(e))&&(e=s),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var s=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=s.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),s&&s.data&&(this._rowCount+=s.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,i)n.postMessage({results:s,workerId:a.WORKER_ID,finished:r});else if(_(this._config.chunk)&&!t){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=s=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!r||!_(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){_(this._config.error)?this._config.error(e):i&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),l.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function u(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),l.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,i=(this._config.chunkSize&&(i=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,i)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function h(e){l.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=w((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=w((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=w((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=w((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,n,r,i,s=Math.pow(2,53),o=-s,l=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,u=this,d=0,h=0,f=!1,g=!1,v=[],y={data:[],errors:[],meta:{}};function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){if(y&&r&&(S("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(y.data=y.data.filter((function(e){return!w(e)}))),x()){if(y)if(Array.isArray(y.data[0])){for(var t=0;x()&&t<y.data.length;t++)y.data[t].forEach(n);y.data.splice(0,1)}else y.data.forEach(n);function n(t,n){_(e.transformHeader)&&(t=e.transformHeader(t,n)),v.push(t)}}function i(t,n){for(var r=e.header?{}:[],i=0;i<t.length;i++){var a=i,u=t[i];u=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(l.test(e)&&(e=parseFloat(e),o<e&&e<s))return 1})(n)?parseFloat(n):c.test(n)?new Date(n):""===n?null:n):n)(a=e.header?i>=v.length?"__parsed_extra":v[i]:a,u=e.transform?e.transform(u,a):u),"__parsed_extra"===a?(r[a]=r[a]||[],r[a].push(u)):r[a]=u}return e.header&&(i>v.length?S("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+i,h+n):i<v.length&&S("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+i,h+n)),r}var u;y&&(e.header||e.dynamicTyping||e.transform)&&(u=1,!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(i),u=y.data.length):y.data=i(y.data,0),e.header&&y.meta&&(y.meta.fields=v),h+=u)}function x(){return e.header&&0===v.length}function S(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),y.errors.push(e)}_(e.step)&&(i=e.step,e.step=function(t){y=t,x()?E():(E(),0!==y.data.length&&(d+=t.data.length,e.preview&&d>e.preview?n.abort():(y.data=y.data[0],i(y,u))))}),this.parse=function(i,s,o){var l=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(i,l)),r=!1,e.delimiter?_(e.delimiter)&&(e.delimiter=e.delimiter(i),y.meta.delimiter=e.delimiter):((l=((t,n,r,i,s)=>{var o,l,c,u;s=s||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<s.length;d++){for(var h,f=s[d],p=0,g=0,v=0,y=(c=void 0,new m({comments:i,delimiter:f,newline:n,preview:10}).parse(t)),b=0;b<y.data.length;b++)r&&w(y.data[b])?v++:(g+=h=y.data[b].length,void 0===c?c=h:0<h&&(p+=Math.abs(h-c),c=h));0<y.data.length&&(g/=y.data.length-v),(void 0===l||p<=l)&&(void 0===u||u<g)&&1.99<g&&(l=p,o=f,u=g)}return{successful:!!(e.delimiter=o),bestDelimiter:o}})(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),y.meta.delimiter=e.delimiter),l=b(e),e.preview&&e.header&&l.preview++,t=i,n=new m(l),y=n.parse(t,s,o),E(),f?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,n.abort(),t=_(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){u.streamer._halted?(f=!1,u.streamer.parseChunk(t,!0)):setTimeout(u.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,n.abort(),y.meta.aborted=!0,_(e.complete)&&e.complete(y),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(p(t)+"([^]*?)"+p(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,i=0;i<n.length;i++)"\n"===n[i][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,i=e.step,s=e.preview,o=e.fastMode,l=null,c=!1,u=null==e.quoteChar?'"':e.quoteChar,d=u;if(void 0!==e.escapeChar&&(d=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var h=0,f=!1;this.parse=function(a,m,g){if("string"!=typeof a)throw new Error("Input must be a string");var v=a.length,y=t.length,b=n.length,w=r.length,E=_(i),x=[],S=[],k=[],T=h=0;if(!a)return U();if(o||!1!==o&&-1===a.indexOf(u)){for(var C=a.split(n),I=0;I<C.length;I++){if(k=C[I],h+=k.length,I!==C.length-1)h+=n.length;else if(g)return U();if(!r||k.substring(0,w)!==r){if(E){if(x=[],D(k.split(t)),M(),f)return U()}else D(k.split(t));if(s&&s<=I)return x=x.slice(0,s),U(!0)}}return U()}for(var A=a.indexOf(t,h),P=a.indexOf(n,h),N=new RegExp(p(d)+p(u),"g"),R=a.indexOf(u,h);;)if(a[h]===u)for(R=h,h++;;){if(-1===(R=a.indexOf(u,R+1)))return g||S.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:h}),j();if(R===v-1)return j(a.substring(h,R).replace(N,u));if(u===d&&a[R+1]===d)R++;else if(u===d||0===R||a[R-1]!==d){-1!==A&&A<R+1&&(A=a.indexOf(t,R+1));var O=F(-1===(P=-1!==P&&P<R+1?a.indexOf(n,R+1):P)?A:Math.min(A,P));if(a.substr(R+1+O,y)===t){k.push(a.substring(h,R).replace(N,u)),a[h=R+1+O+y]!==u&&(R=a.indexOf(u,h)),A=a.indexOf(t,h),P=a.indexOf(n,h);break}if(O=F(P),a.substring(R+1+O,R+1+O+b)===n){if(k.push(a.substring(h,R).replace(N,u)),L(R+1+O+b),A=a.indexOf(t,h),R=a.indexOf(u,h),E&&(M(),f))return U();if(s&&x.length>=s)return U(!0);break}S.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:h}),R++}}else if(r&&0===k.length&&a.substring(h,h+w)===r){if(-1===P)return U();h=P+b,P=a.indexOf(n,h),A=a.indexOf(t,h)}else if(-1!==A&&(A<P||-1===P))k.push(a.substring(h,A)),h=A+y,A=a.indexOf(t,h);else{if(-1===P)break;if(k.push(a.substring(h,P)),L(P+b),E&&(M(),f))return U();if(s&&x.length>=s)return U(!0)}return j();function D(e){x.push(e),T=h}function F(e){var t=0;return-1!==e&&(e=a.substring(R+1,e))&&""===e.trim()?e.length:t}function j(e){return g||(void 0===e&&(e=a.substring(h)),k.push(e),h=v,D(k),E&&M()),U()}function L(e){h=e,D(k),k=[],P=a.indexOf(n,h)}function U(r){if(e.header&&!m&&x.length&&!c){var i=x[0],s={},o=new Set(i);let t=!1;for(let n=0;n<i.length;n++){let r=i[n];if(s[r=_(e.transformHeader)?e.transformHeader(r,n):r]){let e,a=s[r];for(;e=r+"_"+a,a++,o.has(e););o.add(e),i[n]=e,s[r]++,t=!0,(l=null===l?{}:l)[e]=r}else s[r]=1,i[n]=r;o.add(r)}t&&console.warn("Duplicate headers found and renamed."),c=!0}return{data:x,errors:S,meta:{delimiter:t,linebreak:n,aborted:f,truncated:!!r,cursor:T+(m||0),renamedHeaders:l}}}function M(){i(U()),x=[],S=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return h}}function g(e){var t=e.data,n=s[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,v(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(_(n.userStep)){for(var o=0;o<t.results.data.length&&(n.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},i),!r);o++);delete t.results}else _(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&v(t.workerId,t.results)}function v(e,t){var n=s[e];_(n.userComplete)&&n.userComplete(t),n.terminate(),delete s[e]}function y(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function w(e,t){return function(){e.apply(t,arguments)}}function _(e){return"function"==typeof e}return a.parse=function(t,r){var i=(r=r||{}).dynamicTyping||!1;if(_(i)&&(r.dynamicTypingFunction=i,i={}),r.dynamicTyping=i,r.transform=!!_(r.transform)&&r.transform,!r.worker||!a.WORKERS_SUPPORTED)return i=null,a.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),i=new(r.download?c:d)(r)):!0===t.readable&&_(t.read)&&_(t.on)?i=new h(r):(n.File&&t instanceof File||t instanceof Object)&&(i=new u(r)),i.stream(t);(i=(()=>{var t;return!!a.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=g,t.id=o++,s[t.id]=t)})()).userStep=r.step,i.userChunk=r.chunk,i.userComplete=r.complete,i.userError=r.error,r.step=_(r.step),r.chunk=_(r.chunk),r.complete=_(r.complete),r.error=_(r.error),delete r.worker,i.postMessage({input:t,config:r,workerId:i.id})},a.unparse=function(e,t){var n=!1,r=!0,i=",",s="\r\n",o='"',l=o+o,c=!1,u=null,d=!1,h=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(s=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+o),t.escapeFormulae instanceof RegExp?d=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(d=/^[=+\-@\t\r].*$/)}})(),new RegExp(p(o),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,c);if("object"==typeof e[0])return f(u||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||u),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function f(e,t,n){var o="",a=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(a&&r){for(var c=0;c<e.length;c++)0<c&&(o+=i),o+=m(e[c],c);0<t.length&&(o+=s)}for(var u=0;u<t.length;u++){var d=(a?e:t[u]).length,h=!1,f=a?0===Object.keys(t[u]).length:0===t[u].length;if(n&&!a&&(h="greedy"===n?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===n&&a){for(var p=[],g=0;g<d;g++){var v=l?e[g]:g;p.push(t[u][v])}h=""===p.join("").trim()}if(!h){for(var y=0;y<d;y++){0<y&&!f&&(o+=i);var b=a&&l?e[y]:y;o+=m(t[u][b],y)}u<t.length-1&&(!n||0<d&&!f)&&(o+=s)}}return o}function m(e,t){var r,s;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(s=!1,d&&"string"==typeof e&&d.test(e)&&(e="'"+e,s=!0),r=e.toString().replace(h,l),(s=s||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,a.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?o+r+o:r)}},a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=m,a.ParserHandle=f,a.NetworkStreamer=c,a.FileStreamer=u,a.StringStreamer=d,a.ReadableStreamStreamer=h,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},i=[];return this.each((function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var s=0;s<this.files.length;s++)i.push({file:this.files[s],inputElem:this,instanceConfig:t.extend({},r)})})),s(),this;function s(){if(0===i.length)_(e.complete)&&e.complete();else{var n,r,s,l,c=i[0];if(_(e.before)){var u=e.before(c.file,c.inputElem);if("object"==typeof u){if("abort"===u.action)return n="AbortError",r=c.file,s=c.inputElem,l=u.reason,void(_(e.error)&&e.error({name:n},r,s,l));if("skip"===u.action)return void o();"object"==typeof u.config&&(c.instanceConfig=t.extend(c.instanceConfig,u.config))}else if("skip"===u)return void o()}var d=c.instanceConfig.complete;c.instanceConfig.complete=function(e){_(d)&&d(e,c.file,c.inputElem),o()},a.parse(c.file,c.instanceConfig)}}function o(){i.splice(0,1),s()}}),i&&(n.onmessage=function(e){e=e.data,void 0===a.WORKER_ID&&e&&(a.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(u.prototype=Object.create(l.prototype)).constructor=u,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(l.prototype)).constructor=h,a},void 0===(i="function"===typeof n?n.apply(t,r):n)||(e.exports=i)},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e,t=n(43),r=n.t(t,2),i=n(391);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const o="popstate";function a(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,n,r){return void 0===n&&(n=null),s({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?h(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function d(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function h(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function f(t,n,r,i){void 0===i&&(i={});let{window:l=document.defaultView,v5Compat:h=!1}=i,f=l.history,p=e.Pop,m=null,g=v();function v(){return(f.state||{idx:null}).idx}function y(){p=e.Pop;let t=v(),n=null==t?null:t-g;g=t,m&&m({action:p,location:w.location,delta:n})}function b(e){let t="null"!==l.location.origin?l.location.origin:l.location.href,n="string"===typeof e?e:d(e);return n=n.replace(/ $/,"%20"),a(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,f.replaceState(s({},f.state,{idx:g}),""));let w={get action(){return p},get location(){return t(l,f)},listen(e){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(o,y),m=e,()=>{l.removeEventListener(o,y),m=null}},createHref:e=>n(l,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){p=e.Push;let i=u(w.location,t,n);r&&r(i,t),g=v()+1;let s=c(i,g),o=w.createHref(i);try{f.pushState(s,"",o)}catch(a){if(a instanceof DOMException&&"DataCloneError"===a.name)throw a;l.location.assign(o)}h&&m&&m({action:p,location:w.location,delta:1})},replace:function(t,n){p=e.Replace;let i=u(w.location,t,n);r&&r(i,t),g=v();let s=c(i,g),o=w.createHref(i);f.replaceState(s,"",o),h&&m&&m({action:p,location:w.location,delta:0})},go:e=>f.go(e)};return w}var p;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(p||(p={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,n){return void 0===n&&(n="/"),g(e,t,n,!1)}function g(e,t,n,r){let i=P(("string"===typeof t?h(t):t).pathname||"/",n);if(null==i)return null;let s=v(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=A(i);o=C(s[a],e,r)}return o}function v(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(a(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let l=F([r,o.relativePath]),c=n.concat(o);e.children&&e.children.length>0&&(a(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),v(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:T(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of y(e.path))i(e,t,r);else i(e,t)})),t}function y(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=y(r.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const b=/^:[\w-]+$/,w=3,_=2,E=1,x=10,S=-2,k=e=>"*"===e;function T(e,t){let n=e.split("/"),r=n.length;return n.some(k)&&(r+=S),t&&(r+=_),n.filter((e=>!k(e))).reduce(((e,t)=>e+(b.test(t)?w:""===t?E:x)),r)}function C(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",o=[];for(let a=0;a<r.length;++a){let e=r[a],l=a===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:F([s,u.pathname]),pathnameBase:j(F([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=F([s,u.pathnameBase]))}return o}function I(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);l("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function A(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function N(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function R(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function O(e,t){let n=R(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function D(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=h(e):(i=s({},e),a(!i.pathname||!i.pathname.includes("?"),N("?","pathname","search",i)),a(!i.pathname||!i.pathname.includes("#"),N("#","pathname","hash",i)),a(!i.search||!i.search.includes("#"),N("#","search","hash",i)));let o,l=""===e||""===i.pathname,c=l?"/":i.pathname;if(null==c)o=n;else{let e=t.length-1;if(!r&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}o=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?h(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:L(r),hash:U(i)}}(i,o),d=c&&"/"!==c&&c.endsWith("/"),f=(l||"."===c)&&n.endsWith("/");return u.pathname.endsWith("/")||!d&&!f||(u.pathname+="/"),u}const F=e=>e.join("/").replace(/\/\/+/g,"/"),j=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",U=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function M(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const z=["post","put","patch","delete"],V=(new Set(z),["get",...z]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B.apply(this,arguments)}const $=t.createContext(null);const q=t.createContext(null);const H=t.createContext(null);const K=t.createContext(null);const W=t.createContext({outlet:null,matches:[],isDataRoute:!1});const G=t.createContext(null);function Q(){return null!=t.useContext(K)}function J(){return Q()||a(!1),t.useContext(K).location}function Y(e){t.useContext(H).static||t.useLayoutEffect(e)}function X(){let{isDataRoute:e}=t.useContext(W);return e?function(){let{router:e}=le(oe.UseNavigateStable),n=ue(ae.UseNavigateStable),r=t.useRef(!1);return Y((()=>{r.current=!0})),t.useCallback((function(t,i){void 0===i&&(i={}),r.current&&("number"===typeof t?e.navigate(t):e.navigate(t,B({fromRouteId:n},i)))}),[e,n])}():function(){Q()||a(!1);let e=t.useContext($),{basename:n,future:r,navigator:i}=t.useContext(H),{matches:s}=t.useContext(W),{pathname:o}=J(),l=JSON.stringify(O(s,r.v7_relativeSplatPath)),c=t.useRef(!1);return Y((()=>{c.current=!0})),t.useCallback((function(t,r){if(void 0===r&&(r={}),!c.current)return;if("number"===typeof t)return void i.go(t);let s=D(t,JSON.parse(l),o,"path"===r.relative);null==e&&"/"!==n&&(s.pathname="/"===s.pathname?n:F([n,s.pathname])),(r.replace?i.replace:i.push)(s,r.state,r)}),[n,i,l,o,e])}()}function Z(){let{matches:e}=t.useContext(W),n=e[e.length-1];return n?n.params:{}}function ee(n,r,i,s){Q()||a(!1);let{navigator:o,static:l}=t.useContext(H),{matches:c}=t.useContext(W),u=c[c.length-1],d=u?u.params:{},f=(u&&u.pathname,u?u.pathnameBase:"/");u&&u.route;let p,g=J();if(r){var v;let e="string"===typeof r?h(r):r;"/"===f||(null==(v=e.pathname)?void 0:v.startsWith(f))||a(!1),p=e}else p=g;let y=p.pathname||"/",b=y;if("/"!==f){let e=f.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=!l&&i&&i.matches&&i.matches.length>0?i.matches:m(n,{pathname:b});let _=se(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:F([f,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:F([f,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),c,i,s);return r&&_?t.createElement(K.Provider,{value:{location:B({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},_):_}function te(){let e=function(){var e;let n=t.useContext(G),r=ce(ae.UseRouteError),i=ue(ae.UseRouteError);if(void 0!==n)return n;return null==(e=r.errors)?void 0:e[i]}(),n=M(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:s},r):null,null)}const ne=t.createElement(te,null);class re extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(W.Provider,{value:this.props.routeContext},t.createElement(G.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ie(e){let{routeContext:n,match:r,children:i}=e,s=t.useContext($);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),t.createElement(W.Provider,{value:n},i)}function se(e,n,r,i){var s;if(void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),null==e){var o;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(o=i)&&o.v7_partialHydration&&0===n.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let l=e,c=null==(s=r)?void 0:s.errors;if(null!=c){let e=l.findIndex((e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id])));e>=0||a(!1),l=l.slice(0,Math.min(l.length,e+1))}let u=!1,d=-1;if(r&&i&&i.v7_partialHydration)for(let t=0;t<l.length;t++){let e=l[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=t),e.route.id){let{loaderData:t,errors:n}=r,i=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||i){u=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight(((e,i,s)=>{let o,a=!1,h=null,f=null;var p;r&&(o=c&&i.route.id?c[i.route.id]:void 0,h=i.route.errorElement||ne,u&&(d<0&&0===s?(p="route-fallback",!1||de[p]||(de[p]=!0),a=!0,f=null):d===s&&(a=!0,f=i.route.hydrateFallbackElement||null)));let m=n.concat(l.slice(0,s+1)),g=()=>{let n;return n=o?h:a?f:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(ie,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===s)?t.createElement(re,{location:r.location,revalidation:r.revalidation,component:h,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var oe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(oe||{}),ae=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ae||{});function le(e){let n=t.useContext($);return n||a(!1),n}function ce(e){let n=t.useContext(q);return n||a(!1),n}function ue(e){let n=function(){let e=t.useContext(W);return e||a(!1),e}(),r=n.matches[n.matches.length-1];return r.route.id||a(!1),r.route.id}const de={};function he(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}r.startTransition;function fe(e){let{to:n,replace:r,state:i,relative:s}=e;Q()||a(!1);let{future:o,static:l}=t.useContext(H),{matches:c}=t.useContext(W),{pathname:u}=J(),d=X(),h=D(n,O(c,o.v7_relativeSplatPath),u,"path"===s),f=JSON.stringify(h);return t.useEffect((()=>d(JSON.parse(f),{replace:r,state:i,relative:s})),[d,f,s,r,i]),null}function pe(e){a(!1)}function me(n){let{basename:r="/",children:i=null,location:s,navigationType:o=e.Pop,navigator:l,static:c=!1,future:u}=n;Q()&&a(!1);let d=r.replace(/^\/*/,"/"),f=t.useMemo((()=>({basename:d,navigator:l,static:c,future:B({v7_relativeSplatPath:!1},u)})),[d,u,l,c]);"string"===typeof s&&(s=h(s));let{pathname:p="/",search:m="",hash:g="",state:v=null,key:y="default"}=s,b=t.useMemo((()=>{let e=P(p,d);return null==e?null:{location:{pathname:e,search:m,hash:g,state:v,key:y},navigationType:o}}),[d,p,m,g,v,y,o]);return null==b?null:t.createElement(H.Provider,{value:f},t.createElement(K.Provider,{children:i,value:b}))}function ge(e){let{children:t,location:n}=e;return ee(ve(t),n)}new Promise((()=>{}));t.Component;function ve(e,n){void 0===n&&(n=[]);let r=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let s=[...n,i];if(e.type===t.Fragment)return void r.push.apply(r,ve(e.props.children,s));e.type!==pe&&a(!1),e.props.index&&e.props.children&&a(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=ve(e.props.children,s)),r.push(o)})),r}var ye=n(950),be=n.t(ye,2);new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(em){}new Map;const we=r.startTransition;be.flushSync,r.useId;function _e(e){let{basename:n,children:r,future:i,window:s}=e,o=t.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),f((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return u("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:d(t)}),null,a)));let l=o.current,[c,h]=t.useState({action:l.action,location:l.location}),{v7_startTransition:p}=i||{},m=t.useCallback((e=>{p&&we?we((()=>h(e))):h(e)}),[h,p]);return t.useLayoutEffect((()=>l.listen(m)),[l,m]),t.useEffect((()=>he(i)),[i]),t.createElement(me,{basename:n,children:r,location:c.location,navigationType:c.action,navigator:l,future:i})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Ee,xe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ee||(Ee={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(xe||(xe={}));const Se=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ke={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;a||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Se(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Te;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Te extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ce=function(e){return function(e){const t=Se(e);return ke.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ie=function(e){try{return ke.decodeString(e,!0)}catch(em){console.error("base64Decode failed: ",em)}return null};const Ae=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Pe=()=>{try{return Ae()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(em){return}const t=e&&Ie(e[1]);return t&&JSON.parse(t)})()}catch(em){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${em}`)}},Ne=e=>{var t,n;return null===(n=null===(t=Pe())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Re=()=>{var e;return null===(e=Pe())||void 0===e?void 0:e.config},Oe=e=>{var t;return null===(t=Pe())||void 0===t?void 0:t[`_${e}`]};class De{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function Fe(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function je(){return!function(){var e;const t=null===(e=Pe())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(em){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Le(){try{return"object"===typeof indexedDB}catch(em){return!1}}class Ue extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ue.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Me.prototype.create)}}class Me{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(ze,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new Ue(n,s,t)}}const ze=/\{\$([^}]+)}/g;function Ve(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Be(n)&&Be(s)){if(!Ve(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Be(e){return null!==e&&"object"===typeof e}function $e(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function qe(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function He(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Ke{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=We),void 0===r.error&&(r.error=We),void 0===r.complete&&(r.complete=We);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(em){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(em){"undefined"!==typeof console&&console.error&&console.error(em)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function We(){}function Ge(e){return e&&e._delegate?e._delegate:e}class Qe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Je="[DEFAULT]";class Ye{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new De;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(em){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(em){if(r)return null;throw em}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Je})}catch(em){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(em){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Je?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.component?this.component.multipleInstances?e:Je:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Xe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ye(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Ze=[];var et;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(et||(et={}));const tt={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},nt=et.INFO,rt={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},it=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=rt[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class st{constructor(e){this.name=e,this._logLevel=nt,this._logHandler=it,this._userLogHandler=null,Ze.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?tt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...t),this._logHandler(this,et.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...t),this._logHandler(this,et.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,et.INFO,...t),this._logHandler(this,et.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,et.WARN,...t),this._logHandler(this,et.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,et.ERROR,...t),this._logHandler(this,et.ERROR,...t)}}let ot,at;const lt=new WeakMap,ct=new WeakMap,ut=new WeakMap,dt=new WeakMap,ht=new WeakMap;let ft={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ct.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ut.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return gt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function pt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(at||(at=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(vt(this),n),gt(lt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gt(e.apply(vt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(vt(this),t,...r);return ut.set(s,t.sort?t.sort():[t]),gt(s)}}function mt(e){return"function"===typeof e?pt(e):(e instanceof IDBTransaction&&function(e){if(ct.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ct.set(e,t)}(e),t=e,(ot||(ot=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,ft):e);var t}function gt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(gt(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&lt.set(t,e)})).catch((()=>{})),ht.set(t,e),t}(e);if(dt.has(e))return dt.get(e);const t=mt(e);return t!==e&&(dt.set(e,t),ht.set(t,e)),t}const vt=e=>ht.get(e);const yt=["get","getKey","getAll","getAllKeys","count"],bt=["put","add","delete","clear"],wt=new Map;function _t(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(wt.get(t))return wt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=bt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!yt.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return wt.set(t,s),s}ft=(e=>({...e,get:(t,n,r)=>_t(t,n)||e.get(t,n,r),has:(t,n)=>!!_t(t,n)||e.has(t,n)}))(ft);class Et{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const xt="@firebase/app",St="0.10.13",kt=new st("@firebase/app"),Tt="@firebase/app-compat",Ct="@firebase/analytics-compat",It="@firebase/analytics",At="@firebase/app-check-compat",Pt="@firebase/app-check",Nt="@firebase/auth",Rt="@firebase/auth-compat",Ot="@firebase/database",Dt="@firebase/data-connect",Ft="@firebase/database-compat",jt="@firebase/functions",Lt="@firebase/functions-compat",Ut="@firebase/installations",Mt="@firebase/installations-compat",zt="@firebase/messaging",Vt="@firebase/messaging-compat",Bt="@firebase/performance",$t="@firebase/performance-compat",qt="@firebase/remote-config",Ht="@firebase/remote-config-compat",Kt="@firebase/storage",Wt="@firebase/storage-compat",Gt="@firebase/firestore",Qt="@firebase/vertexai-preview",Jt="@firebase/firestore-compat",Yt="firebase",Xt="[DEFAULT]",Zt={[xt]:"fire-core",[Tt]:"fire-core-compat",[It]:"fire-analytics",[Ct]:"fire-analytics-compat",[Pt]:"fire-app-check",[At]:"fire-app-check-compat",[Nt]:"fire-auth",[Rt]:"fire-auth-compat",[Ot]:"fire-rtdb",[Dt]:"fire-data-connect",[Ft]:"fire-rtdb-compat",[jt]:"fire-fn",[Lt]:"fire-fn-compat",[Ut]:"fire-iid",[Mt]:"fire-iid-compat",[zt]:"fire-fcm",[Vt]:"fire-fcm-compat",[Bt]:"fire-perf",[$t]:"fire-perf-compat",[qt]:"fire-rc",[Ht]:"fire-rc-compat",[Kt]:"fire-gcs",[Wt]:"fire-gcs-compat",[Gt]:"fire-fst",[Jt]:"fire-fst-compat",[Qt]:"fire-vertex","fire-js":"fire-js",[Yt]:"fire-js-all"},en=new Map,tn=new Map,nn=new Map;function rn(e,t){try{e.container.addComponent(t)}catch(em){kt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,em)}}function sn(e){const t=e.name;if(nn.has(t))return kt.debug(`There were multiple attempts to register component ${t}.`),!1;nn.set(t,e);for(const n of en.values())rn(n,e);for(const n of tn.values())rn(n,e);return!0}function on(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function an(e){return void 0!==e.settings}const ln=new Me("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class cn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qe("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ln.create("app-deleted",{appName:this._name})}}const un="10.14.1";function dn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Xt,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw ln.create("bad-app-name",{appName:String(i)});if(n||(n=Re()),!n)throw ln.create("no-options");const s=en.get(i);if(s){if(Ve(n,s.options)&&Ve(r,s.config))return s;throw ln.create("duplicate-app",{appName:i})}const o=new Xe(i);for(const l of nn.values())o.addComponent(l);const a=new cn(n,r,o);return en.set(i,a),a}function hn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt;const t=en.get(e);if(!t&&e===Xt&&Re())return dn();if(!t)throw ln.create("no-app",{appName:e});return t}function fn(e,t,n){var r;let i=null!==(r=Zt[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void kt.warn(e.join(" "))}sn(new Qe(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const pn="firebase-heartbeat-store";let mn=null;function gn(){return mn||(mn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=gt(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(gt(o.result),e.oldVersion,e.newVersion,gt(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(pn)}catch(em){console.warn(em)}}}).catch((e=>{throw ln.create("idb-open",{originalErrorMessage:e.message})}))),mn}async function vn(e,t){try{const n=(await gn()).transaction(pn,"readwrite"),r=n.objectStore(pn);await r.put(t,yn(e)),await n.done}catch(em){if(em instanceof Ue)kt.warn(em.message);else{const t=ln.create("idb-set",{originalErrorMessage:null===em||void 0===em?void 0:em.message});kt.warn(t.message)}}}function yn(e){return`${e.name}!${e.options.appId}`}class bn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _n(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=wn();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(em){kt.warn(em)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=wn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),En(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),En(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Ce(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(em){return kt.warn(em),""}}}function wn(){return(new Date).toISOString().substring(0,10)}class _n{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Le()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await gn()).transaction(pn),n=await t.objectStore(pn).get(yn(e));return await t.done,n}catch(em){if(em instanceof Ue)kt.warn(em.message);else{const t=ln.create("idb-get",{originalErrorMessage:null===em||void 0===em?void 0:em.message});kt.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return vn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return vn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function En(e){return Ce(JSON.stringify({version:2,heartbeats:e})).length}var xn;xn="",sn(new Qe("platform-logger",(e=>new Et(e)),"PRIVATE")),sn(new Qe("heartbeat",(e=>new bn(e)),"PRIVATE")),fn(xt,St,xn),fn(xt,St,"esm2017"),fn("fire-js","");var Sn,kn,Tn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Cn={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),s=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=o(n)).j(t);d(c)||0<c.l(e);)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,kn=Cn.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(c))):i=(i=i.j(r)).add(o(c))}return i},Sn=Cn.Integer=r}).apply("undefined"!==typeof Tn?Tn:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var In,An,Pn,Nn,Rn,On,Dn,Fn,jn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ln={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof jn&&jn];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function x(e){i.setTimeout((()=>{throw e}),0)}function S(){var e=A;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new T),(e=>e.reset()));class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,I=!1,A=new class{constructor(){this.h=this.g=null}add(e,t){const n=k.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},P=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(N)}};var N=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(n){x(n)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}I=!1};function R(){this.s=this.s,this.C=this.C}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},O.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function F(e,t){if(O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:j[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&F.aa.h.call(this)}}d(F,O);var j={2:"touch",3:"pen",4:"mouse"};F.prototype.h=function(){F.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),U=0;function M(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++U,this.da=this.fa=!1}function z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}V.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=$(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new M(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function K(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)K(e,t[s],n,r,i);return null}return n=te(n),e&&e[L]?e.K(t,n,o(r)?!!r.capture:!!r,i):W(e,t,n,!1,r,i)}function W(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[q]=l=new V(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)D||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Y(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[L]?e.L(t,n,o(r)?!!r.capture:!!r,i):W(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[L]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(s=e.g[t],n,r,i))&&(z(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,i)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Y(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[q]=null)):z(e)}}}function Y(e){return e in H?H[e]:H[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new F(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&J(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new V(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var i=t;_(t=new O(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&B(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se((()=>{e.g=null,e.i&&(e.i=!1,oe(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,R),ne.prototype[L]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)z(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}d(le,R);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&J(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){O.call(this,"d")}function be(){O.call(this,"c")}d(ye,O),d(be,O);var we={},_e=null;function Ee(){return _e=_e||new ne}function xe(e){O.call(this,we.La,e)}function Se(e){const t=Ee();re(t,new xe(t))}function ke(e,t){O.call(this,we.STAT_EVENT,e),this.stat=t}function Te(e){const t=Ee();re(t,new ke(t,e))}function Ce(e,t){O.call(this,we.Ma,e),this.size=t}function Ie(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ae(){this.g=!0}function Pe(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return de(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",d(xe,O),we.STAT_EVENT="statevent",d(ke,O),we.Ma="timingevent",d(Ce,O),Ae.prototype.xa=function(){this.g=!1},Ae.prototype.info=function(){};var Ne,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Oe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function De(){}function Fe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}d(De,pe),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},Ne=new De;var Le={},Ue={};function Me(e,t,n){e.L=1,e.v=dt(ot(t)),e.m=n,e.P=!0,ze(e,null)}function ze(e,t){e.F=Date.now(),$e(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),kt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new je,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var o=K(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ue:(n=Number(t.substring(n,r)),isNaN(n)?Le:(r+=1)+n>t.length?Ue:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ie(c(e.ba,e),t)}function He(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ke(e){0==e.j.G||e.J||ln(e.j,e)}function We(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Jt(n)}rn(n),Te(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ie(c(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&an(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=hn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(He(a),$e(a)),r.g=o}else nn(r);0<n.i.length&&Xt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Se()}catch(u){}}Fe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Ht(e)?t.j():this.Y(e)},Fe.prototype.Y=function(e){try{if(e==this.g)e:{const h=Ht(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Kt(this.g)))){this.J||4!=h||7==t||Se(),He(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var r=Kt(this.g);e="";var s=r.length,o=4==Ht(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){We(this),Ke(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Te(12),We(this),Ke(this);break e}Pe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Be(this,a),e==Ue){4==h&&(this.s=4,Te(14),n=!1),Pe(this.i,this.l,null,"[Incomplete Response]");break}if(e==Le){this.s=4,Te(15),Pe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Pe(this.i,this.l,e,null),Ge(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Te(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(d),d.M=!0,Te(11))}}else Pe(this.i,this.l,a,"[Invalid Chunked Response]"),We(this),Ke(this)}else Pe(this.i,this.l,a,null),Ge(this,a);4==h&&We(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=Ht(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=E(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),We(this),Ke(this)}}}catch(Un){}},Fe.prototype.cancel=function(){this.J=!0,We(this)},Fe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Se(),Te(17)),We(this),this.s=2,Ke(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(Et(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(xt(this,t),kt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new _t(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Et(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function xt(e,t){Et(e),t=Tt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function St(e,t){return Et(e),t=Tt(e,t),e.g.has(t)}function kt(e,t,n){xt(e,t),0<n.length&&(e.i=null,e.g.set(Tt(e,t),h(n)),e.h+=n.length)}function Tt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function It(){this.g=new fe}function At(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;o(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(em){throw t.push(r+"type="+encodeURIComponent("_badmap")),em}}function Pt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Nt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ot(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Dt(e)}function Dt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ft(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function jt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ft(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Lt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){Et(this),this.i=null,e=Tt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Et(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Et(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Et(this);let t=[];if("string"===typeof e)St(this,e)&&(t=t.concat(this.g.get(Tt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Et(this),this.i=null,St(this,e=Tt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},d(Pt,pe),Pt.prototype.g=function(){return new Nt(this.l,this.j)},Pt.prototype.i=(mt={},function(){return mt}),d(Nt,ne),(e=Nt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Dt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ot(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ot(this):Dt(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ot(this))},e.Qa=function(e){this.g&&(this.response=e,Ot(this))},e.ga=function(){this.g&&Ot(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Nt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Lt,ne);var Ut=/^https?$/i,Mt=["POST","PUT"];function zt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),$t(e)}function Vt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Ht(e)||2!=e.Z()))if(e.u&&4==Ht(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==Ht(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Ut.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<Ht(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Vt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){qt(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(em){}}}function qt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Ht(e){return e.g?e.g.readyState:0}function Kt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Vn){return null}}function Wt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wt("baseRetryDelayMs",5e3,e),this.cb=Wt("retryDelaySeedMs",1e4,e),this.Wa=Wt("forwardChannelMaxRetries",2,e),this.wa=Wt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new It,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Fe(e,e.j,t)).L=2,t.v=dt(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}dn(e)}function Jt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Yt(e){Jt(e),e.u&&(i.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||P(),I||(C(),I=!0),A.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&jt(r,e.m,e.o),n=new Fe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Me(n,r,t)}function en(e,t){e.H&&y(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{At(a,e,"req"+n+"_")}catch(Un){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||P(),I||(C(),I=!0),A.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ie(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function on(e){e.g=new Fe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&jt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(ot(t)),n.m=null,n.P=!0,ze(n,e)}function an(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ee(),new Ce(r,n)),Xt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ie(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),dt(r),t?function(e,t){const n=new Ae;if(i.Image){const r=new Image;r.onload=u(Ct,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ct,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ct,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ct,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ae;const n=new AbortController,r=setTimeout((()=>{n.abort(),Ct(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)})).catch((()=>{clearTimeout(r),Ct(0,0,!1,t)}))}(r.toString(),n)}else Te(2);e.G=0,e.l&&e.l.sa(t),dn(e),Yt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Lt(new Pt({eb:n})):new Lt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Lt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ne.g(),this.v=this.o?me(this.o):me(Ne),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void zt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Mt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){zt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Lt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Te(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=hn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Fe(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),_(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Ft(s)))+"&"+t:this.m&&jt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Me(i,n,null)):Me(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Ye(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ie(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),Jt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Jt(this),rn(this),Te(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},d(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},d(vn,ye),d(yn,be),d(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new vn(e))},bn.prototype.sa=function(e){re(this.g,new yn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Fn=Ln.createWebChannelTransport=function(){return new mn},Dn=Ln.getStatEventTarget=function(){return Ee()},On=Ln.Event=we,Rn=Ln.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Nn=Ln.ErrorCode=Re,Oe.COMPLETE="complete",Pn=Ln.EventType=Oe,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,An=Ln.WebChannel=ge,Ln.FetchXmlHttpFactory=Pt,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,In=Ln.XhrIo=Lt}).apply("undefined"!==typeof jn?jn:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Un="@firebase/firestore";class Mn{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");let zn="10.14.0";const Vn=new st("@firebase/firestore");function Bn(){return Vn.logLevel}function $n(e){if(Vn.logLevel<=et.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Kn);Vn.debug(`Firestore (${zn}): ${e}`,...i)}}function qn(e){if(Vn.logLevel<=et.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Kn);Vn.error(`Firestore (${zn}): ${e}`,...i)}}function Hn(e){if(Vn.logLevel<=et.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Kn);Vn.warn(`Firestore (${zn}): ${e}`,...i)}}function Kn(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Wn(){const e=`FIRESTORE (${zn}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw qn(e),new Error(e)}function Gn(e,t){e||Wn()}function Qn(e,t){return e}const Jn={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yn extends Ue{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Zn{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class er{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Mn.UNAUTHENTICATED)))}shutdown(){}}class tr{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class nr{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Gn(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Xn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xn,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{$n("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):($n("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xn)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?($n("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Gn("string"==typeof t.accessToken),new Zn(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Gn(null===e||"string"==typeof e),new Mn(e)}}class rr{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ir{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new rr(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Mn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class sr{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class or{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Gn(void 0===this.o);const n=e=>{null!=e.error&&$n("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,$n("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{$n("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):$n("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Gn("string"==typeof e.token),this.R=e.token,new sr(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ar(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class lr{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=ar(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function cr(e,t){return e<t?-1:e>t?1:0}function ur(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class dr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Yn(Jn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Yn(Jn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Yn(Jn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yn(Jn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dr.fromMillis(Date.now())}static fromDate(e){return dr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new dr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?cr(this.nanoseconds,e.nanoseconds):cr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class hr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new hr(e)}static min(){return new hr(new dr(0,0))}static max(){return new hr(new dr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class fr{constructor(e,t,n){void 0===t?t=0:t>e.length&&Wn(),void 0===n?n=e.length-t:n>e.length-t&&Wn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===fr.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof fr?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class pr extends fr{construct(e,t,n){return new pr(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Yn(Jn.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new pr(e)}static emptyPath(){return new pr([])}}const mr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gr extends fr{construct(e,t,n){return new gr(e,t,n)}static isValidIdentifier(e){return mr.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new gr(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Yn(Jn.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Yn(Jn.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Yn(Jn.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Yn(Jn.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gr(t)}static emptyPath(){return new gr([])}}class vr{constructor(e){this.path=e}static fromPath(e){return new vr(pr.fromString(e))}static fromName(e){return new vr(pr.fromString(e).popFirst(5))}static empty(){return new vr(pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===pr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return pr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vr(new pr(e.slice()))}}class yr{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}yr.UNKNOWN_ID=-1;function br(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=hr.fromTimestamp(1e9===r?new dr(n+1,0):new dr(n,r));return new _r(i,vr.empty(),t)}function wr(e){return new _r(e.readTime,e.key,-1)}class _r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new _r(hr.min(),vr.empty(),-1)}static max(){return new _r(hr.max(),vr.empty(),-1)}}function Er(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=vr.comparator(e.documentKey,t.documentKey),0!==n?n:cr(e.largestBatchId,t.largestBatchId))}const xr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Sr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function kr(e){if(e.code!==Jn.FAILED_PRECONDITION||e.message!==xr)throw e;$n("LocalStore","Unexpectedly lost primary lease")}class Tr{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Wn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Tr(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Tr?t:Tr.resolve(t)}catch(e){return Tr.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Tr.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Tr.reject(t)}static resolve(e){return new Tr(((t,n)=>{t(e)}))}static reject(e){return new Tr(((t,n)=>{n(e)}))}static waitFor(e){return new Tr(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Tr.resolve(!1);for(const n of e)t=t.next((e=>e?Tr.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Tr(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Tr(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function Cr(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ir(e){return"IndexedDbTransactionError"===e.name}class Ar{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Pr(e){return null==e}function Nr(e){return 0===e&&1/e==-1/0}function Rr(e){return"number"==typeof e&&Number.isInteger(e)&&!Nr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}Ar.oe=-1;const Or=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Dr=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Fr=Dr,jr=[...Fr,"indexConfiguration","indexState","indexEntries"];function Lr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ur(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Mr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class zr{constructor(e,t){this.comparator=e,this.root=t||Br.EMPTY}insert(e,t){return new zr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Br.BLACK,null,null))}remove(e){return new zr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Br.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vr(this.root,e,this.comparator,!0)}}class Vr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Br{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Br.RED,this.left=null!=r?r:Br.EMPTY,this.right=null!=i?i:Br.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Br(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Br.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Br.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Br.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Wn();if(this.right.isRed())throw Wn();const e=this.left.check();if(e!==this.right.check())throw Wn();return e+(this.isRed()?0:1)}}Br.EMPTY=null,Br.RED=!0,Br.BLACK=!1,Br.EMPTY=new class{constructor(){this.size=0}get key(){throw Wn()}get value(){throw Wn()}get color(){throw Wn()}get left(){throw Wn()}get right(){throw Wn()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Br(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $r{constructor(e){this.comparator=e,this.data=new zr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qr(this.data.getIterator())}getIteratorFrom(e){return new qr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof $r))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $r(this.comparator);return t.data=e,t}}class qr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Hr{constructor(e){this.fields=e,e.sort(gr.comparator)}static empty(){return new Hr([])}unionWith(e){let t=new $r(gr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Hr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ur(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Kr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Wr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Kr("Invalid base64 string: "+e):e}}(e);return new Wr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Wr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return cr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wr.EMPTY_BYTE_STRING=new Wr("");const Gr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(e){if(Gn(!!e),"string"==typeof e){let t=0;const n=Gr.exec(e);if(Gn(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Jr(e.seconds),nanos:Jr(e.nanos)}}function Jr(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Yr(e){return"string"==typeof e?Wr.fromBase64String(e):Wr.fromUint8Array(e)}function Xr(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zr(e){const t=e.mapValue.fields.__previous_value__;return Xr(t)?Zr(t):t}function ei(e){const t=Qr(e.mapValue.fields.__local_write_time__.timestampValue);return new dr(t.seconds,t.nanos)}class ti{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class ni{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ni("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ni&&e.projectId===this.projectId&&e.database===this.database}}const ri={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ii(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xr(e)?4:wi(e)?9007199254740991:yi(e)?10:11:Wn()}function si(e,t){if(e===t)return!0;const n=ii(e);if(n!==ii(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ei(e).isEqual(ei(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Qr(e.timestampValue),r=Qr(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Yr(e.bytesValue).isEqual(Yr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Jr(e.geoPointValue.latitude)===Jr(t.geoPointValue.latitude)&&Jr(e.geoPointValue.longitude)===Jr(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Jr(e.integerValue)===Jr(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Jr(e.doubleValue),r=Jr(t.doubleValue);return n===r?Nr(n)===Nr(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ur(e.arrayValue.values||[],t.arrayValue.values||[],si);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Lr(n)!==Lr(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!si(n[i],r[i])))return!1;return!0}(e,t);default:return Wn()}}function oi(e,t){return void 0!==(e.values||[]).find((e=>si(e,t)))}function ai(e,t){if(e===t)return 0;const n=ii(e),r=ii(t);if(n!==r)return cr(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return cr(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Jr(e.integerValue||e.doubleValue),r=Jr(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return li(e.timestampValue,t.timestampValue);case 4:return li(ei(e),ei(t));case 5:return cr(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Yr(e),r=Yr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=cr(n[i],r[i]);if(0!==e)return e}return cr(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=cr(Jr(e.latitude),Jr(t.latitude));return 0!==n?n:cr(Jr(e.longitude),Jr(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ci(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,c=null===(r=a.value)||void 0===r?void 0:r.arrayValue,u=cr((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:ci(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ri.mapValue&&t===ri.mapValue)return 0;if(e===ri.mapValue)return 1;if(t===ri.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=cr(r[o],s[o]);if(0!==e)return e;const t=ai(n[r[o]],i[s[o]]);if(0!==t)return t}return cr(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Wn()}}function li(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return cr(e,t);const n=Qr(e),r=Qr(t),i=cr(n.seconds,r.seconds);return 0!==i?i:cr(n.nanos,r.nanos)}function ci(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ai(n[i],r[i]);if(e)return e}return cr(n.length,r.length)}function ui(e){return di(e)}function di(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Qr(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Yr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return vr.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=di(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${di(e.fields[i])}`;return n+"}"}(e.mapValue):Wn()}function hi(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function fi(e){return!!e&&"integerValue"in e}function pi(e){return!!e&&"arrayValue"in e}function mi(e){return!!e&&"nullValue"in e}function gi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function vi(e){return!!e&&"mapValue"in e}function yi(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ur(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=bi(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=bi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function wi(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class _i{constructor(e){this.value=e}static empty(){return new _i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!vi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bi(t)}setAll(e){let t=gr.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=bi(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());vi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];vi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ur(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new _i(bi(this.value))}}function Ei(e){const t=[];return Ur(e.fields,((e,n)=>{const r=new gr([e]);if(vi(n)){const e=Ei(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Hr(t)}class xi{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new xi(e,0,hr.min(),hr.min(),hr.min(),_i.empty(),0)}static newFoundDocument(e,t,n,r){return new xi(e,1,t,hr.min(),n,r,0)}static newNoDocument(e,t){return new xi(e,2,t,hr.min(),hr.min(),_i.empty(),0)}static newUnknownDocument(e,t){return new xi(e,3,t,hr.min(),hr.min(),_i.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(hr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_i.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_i.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=hr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof xi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Si{constructor(e,t){this.position=e,this.inclusive=t}}function ki(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?vr.comparator(vr.fromName(o.referenceValue),n.key):ai(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ti(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!si(e.position[n],t.position[n]))return!1;return!0}class Ci{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Ii(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ai{}class Pi extends Ai{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ui(e,t,n):"array-contains"===t?new Bi(e,n):"in"===t?new $i(e,n):"not-in"===t?new qi(e,n):"array-contains-any"===t?new Hi(e,n):new Pi(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Mi(e,n):new zi(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ai(t,this.value)):null!==t&&ii(this.value)===ii(t)&&this.matchesComparison(ai(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Wn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ni extends Ai{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ni(e,t)}matches(e){return Ri(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ri(e){return"and"===e.op}function Oi(e){return Di(e)&&Ri(e)}function Di(e){for(const t of e.filters)if(t instanceof Ni)return!1;return!0}function Fi(e){if(e instanceof Pi)return e.field.canonicalString()+e.op.toString()+ui(e.value);if(Oi(e))return e.filters.map((e=>Fi(e))).join(",");{const t=e.filters.map((e=>Fi(e))).join(",");return`${e.op}(${t})`}}function ji(e,t){return e instanceof Pi?function(e,t){return t instanceof Pi&&e.op===t.op&&e.field.isEqual(t.field)&&si(e.value,t.value)}(e,t):e instanceof Ni?function(e,t){return t instanceof Ni&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&ji(n,t.filters[r])),!0)}(e,t):void Wn()}function Li(e){return e instanceof Pi?function(e){return`${e.field.canonicalString()} ${e.op} ${ui(e.value)}`}(e):e instanceof Ni?function(e){return e.op.toString()+" {"+e.getFilters().map(Li).join(" ,")+"}"}(e):"Filter"}class Ui extends Pi{constructor(e,t,n){super(e,t,n),this.key=vr.fromName(n.referenceValue)}matches(e){const t=vr.comparator(e.key,this.key);return this.matchesComparison(t)}}class Mi extends Pi{constructor(e,t){super(e,"in",t),this.keys=Vi("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class zi extends Pi{constructor(e,t){super(e,"not-in",t),this.keys=Vi("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Vi(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>vr.fromName(e.referenceValue)))}class Bi extends Pi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return pi(t)&&oi(t.arrayValue,this.value)}}class $i extends Pi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&oi(this.value.arrayValue,t)}}class qi extends Pi{constructor(e,t){super(e,"not-in",t)}matches(e){if(oi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!oi(this.value.arrayValue,t)}}class Hi extends Pi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!pi(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>oi(this.value.arrayValue,e)))}}class Ki{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function Wi(e){return new Ki(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Gi(e){const t=Qn(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Fi(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Pr(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>ui(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>ui(e))).join(",")),t.ue=e}return t.ue}function Qi(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ii(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ji(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ti(e.startAt,t.startAt)&&Ti(e.endAt,t.endAt)}function Ji(e){return vr.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Yi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Xi(e,t,n,r,i,s,o,a){return new Yi(e,t,n,r,i,s,o,a)}function Zi(e){return new Yi(e)}function es(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ts(e){return null!==e.collectionGroup}function ns(e){const t=Qn(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new $r(gr.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Ci(r,n))})),e.has(gr.keyField().canonicalString())||t.ce.push(new Ci(gr.keyField(),n))}return t.ce}function rs(e){const t=Qn(e);return t.le||(t.le=is(t,ns(e))),t.le}function is(e,t){if("F"===e.limitType)return Wi(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Ci(e.field,t)}));const n=e.endAt?new Si(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Si(e.startAt.position,e.startAt.inclusive):null;return Wi(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function ss(e,t){const n=e.filters.concat([t]);return new Yi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function os(e,t,n){return new Yi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function as(e,t){return Qi(rs(e),rs(t))&&e.limitType===t.limitType}function ls(e){return`${Gi(rs(e))}|lt:${e.limitType}`}function cs(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Li(e))).join(", ")}]`),Pr(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>ui(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>ui(e))).join(",")),`Target(${t})`}(rs(e))}; limitType=${e.limitType})`}function us(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):vr.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ns(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ki(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ns(e),t))&&!(e.endAt&&!function(e,t,n){const r=ki(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ns(e),t))}(e,t)}function ds(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function hs(e){return(t,n)=>{let r=!1;for(const i of ns(e)){const e=fs(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function fs(e,t,n){const r=e.field.isKeyField()?vr.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ai(r,i):Wn()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Wn()}}class ps{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ur(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return Mr(this.inner)}size(){return this.innerSize}}const ms=new zr(vr.comparator);function gs(){return ms}const vs=new zr(vr.comparator);function ys(){let e=vs;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function bs(e){let t=vs;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ws(){return Es()}function _s(){return Es()}function Es(){return new ps((e=>e.toString()),((e,t)=>e.isEqual(t)))}const xs=new zr(vr.comparator),Ss=new $r(vr.comparator);function ks(){let e=Ss;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Ts=new $r(cr);function Cs(){return Ts}function Is(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nr(t)?"-0":t}}function As(e){return{integerValue:""+e}}function Ps(e,t){return Rr(t)?As(t):Is(e,t)}class Ns{constructor(){this._=void 0}}function Rs(e,t,n){return e instanceof Fs?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Xr(t)&&(t=Zr(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof js?Ls(e,t):e instanceof Us?Ms(e,t):function(e,t){const n=Ds(e,t),r=Vs(n)+Vs(e.Pe);return fi(n)&&fi(e.Pe)?As(r):Is(e.serializer,r)}(e,t)}function Os(e,t,n){return e instanceof js?Ls(e,t):e instanceof Us?Ms(e,t):n}function Ds(e,t){return e instanceof zs?function(e){return fi(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Fs extends Ns{}class js extends Ns{constructor(e){super(),this.elements=e}}function Ls(e,t){const n=Bs(t);for(const r of e.elements)n.some((e=>si(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Us extends Ns{constructor(e){super(),this.elements=e}}function Ms(e,t){let n=Bs(t);for(const r of e.elements)n=n.filter((e=>!si(e,r)));return{arrayValue:{values:n}}}class zs extends Ns{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Vs(e){return Jr(e.integerValue||e.doubleValue)}function Bs(e){return pi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class $s{constructor(e,t){this.version=e,this.transformResults=t}}class qs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qs}static exists(e){return new qs(void 0,e)}static updateTime(e){return new qs(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hs(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ks{}function Ws(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ro(e.key,qs.none()):new Xs(e.key,e.data,qs.none());{const n=e.data,r=_i.empty();let i=new $r(gr.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Zs(e.key,r,new Hr(i.toArray()),qs.none())}}function Gs(e,t,n){e instanceof Xs?function(e,t,n){const r=e.value.clone(),i=to(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Zs?function(e,t,n){if(!Hs(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=to(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(eo(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Qs(e,t,n,r){return e instanceof Xs?function(e,t,n,r){if(!Hs(e.precondition,t))return n;const i=e.value.clone(),s=no(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zs?function(e,t,n,r){if(!Hs(e.precondition,t))return n;const i=no(e.fieldTransforms,r,t),s=t.data;return s.setAll(eo(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Hs(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Js(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ds(r.transform,e||null);null!=i&&(null===n&&(n=_i.empty()),n.set(r.field,i))}return n||null}function Ys(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ur(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof js&&t instanceof js||e instanceof Us&&t instanceof Us?ur(e.elements,t.elements,si):e instanceof zs&&t instanceof zs?si(e.Pe,t.Pe):e instanceof Fs&&t instanceof Fs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Xs extends Ks{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Zs extends Ks{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function eo(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function to(e,t,n){const r=new Map;Gn(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Os(o,a,n[i]))}return r}function no(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Rs(e,s,t))}return r}class ro extends Ks{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class io extends Ks{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class so{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Gs(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Qs(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Qs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=_s();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Ws(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(hr.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ks())}isEqual(e){return this.batchId===e.batchId&&ur(this.mutations,e.mutations,((e,t)=>Ys(e,t)))&&ur(this.baseMutations,e.baseMutations,((e,t)=>Ys(e,t)))}}class oo{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Gn(e.mutations.length===n.length);let r=xs;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new oo(e,t,n,r)}}class ao{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class lo{constructor(e,t){this.count=e,this.unchangedNames=t}}var co,uo;function ho(e){switch(e){default:return Wn();case Jn.CANCELLED:case Jn.UNKNOWN:case Jn.DEADLINE_EXCEEDED:case Jn.RESOURCE_EXHAUSTED:case Jn.INTERNAL:case Jn.UNAVAILABLE:case Jn.UNAUTHENTICATED:return!1;case Jn.INVALID_ARGUMENT:case Jn.NOT_FOUND:case Jn.ALREADY_EXISTS:case Jn.PERMISSION_DENIED:case Jn.FAILED_PRECONDITION:case Jn.ABORTED:case Jn.OUT_OF_RANGE:case Jn.UNIMPLEMENTED:case Jn.DATA_LOSS:return!0}}function fo(e){if(void 0===e)return qn("GRPC error has no .code"),Jn.UNKNOWN;switch(e){case co.OK:return Jn.OK;case co.CANCELLED:return Jn.CANCELLED;case co.UNKNOWN:return Jn.UNKNOWN;case co.DEADLINE_EXCEEDED:return Jn.DEADLINE_EXCEEDED;case co.RESOURCE_EXHAUSTED:return Jn.RESOURCE_EXHAUSTED;case co.INTERNAL:return Jn.INTERNAL;case co.UNAVAILABLE:return Jn.UNAVAILABLE;case co.UNAUTHENTICATED:return Jn.UNAUTHENTICATED;case co.INVALID_ARGUMENT:return Jn.INVALID_ARGUMENT;case co.NOT_FOUND:return Jn.NOT_FOUND;case co.ALREADY_EXISTS:return Jn.ALREADY_EXISTS;case co.PERMISSION_DENIED:return Jn.PERMISSION_DENIED;case co.FAILED_PRECONDITION:return Jn.FAILED_PRECONDITION;case co.ABORTED:return Jn.ABORTED;case co.OUT_OF_RANGE:return Jn.OUT_OF_RANGE;case co.UNIMPLEMENTED:return Jn.UNIMPLEMENTED;case co.DATA_LOSS:return Jn.DATA_LOSS;default:return Wn()}}(uo=co||(co={}))[uo.OK=0]="OK",uo[uo.CANCELLED=1]="CANCELLED",uo[uo.UNKNOWN=2]="UNKNOWN",uo[uo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uo[uo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uo[uo.NOT_FOUND=5]="NOT_FOUND",uo[uo.ALREADY_EXISTS=6]="ALREADY_EXISTS",uo[uo.PERMISSION_DENIED=7]="PERMISSION_DENIED",uo[uo.UNAUTHENTICATED=16]="UNAUTHENTICATED",uo[uo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uo[uo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uo[uo.ABORTED=10]="ABORTED",uo[uo.OUT_OF_RANGE=11]="OUT_OF_RANGE",uo[uo.UNIMPLEMENTED=12]="UNIMPLEMENTED",uo[uo.INTERNAL=13]="INTERNAL",uo[uo.UNAVAILABLE=14]="UNAVAILABLE",uo[uo.DATA_LOSS=15]="DATA_LOSS";let po=null;function mo(){return new TextEncoder}const go=new Sn([4294967295,4294967295],0);function vo(e){const t=mo().encode(e),n=new kn;return n.update(t),new Uint8Array(n.digest())}function yo(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Sn([n,r],0),new Sn([i,s],0)]}class bo{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new wo(`Invalid padding: ${t}`);if(n<0)throw new wo(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new wo(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new wo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Sn.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Sn.fromNumber(n)));return 1===r.compare(go)&&(r=new Sn([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=vo(e),[n,r]=yo(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new bo(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=vo(e),[n,r]=yo(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _o{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Eo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _o(hr.min(),r,new zr(cr),gs(),ks())}}class Eo{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Eo(n,t,ks(),ks(),ks())}}class xo{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class So{constructor(e,t){this.targetId=e,this.me=t}}class ko{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wr.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class To{constructor(){this.fe=0,this.ge=Ao(),this.pe=Wr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ks(),t=ks(),n=ks();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Wn()}})),new Eo(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Ao()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Gn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Co{constructor(e){this.Le=e,this.Be=new Map,this.ke=gs(),this.qe=Io(),this.Qe=new zr(cr)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Wn()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Ji(i))if(0===n){const e=new vr(i.path);this.Ue(t,e,xi.newNoDocument(e,hr.min()))}else Gn(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==po||po.et(function(e,t,n,r,i){var s,o,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==h?void 0:h.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Yr(n).toUint8Array()}catch(e){if(e instanceof Kr)return Hn("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new bo(s,r,i)}catch(e){return Hn(e instanceof wo?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Ji(i.target)){const t=new vr(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,xi.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=ks();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new _o(e,t,this.Qe,this.ke,n);return this.ke=gs(),this.qe=Io(),this.Qe=new zr(cr),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new To,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new $r(cr),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||$n("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new To),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Io(){return new zr(vr.comparator)}function Ao(){return new zr(vr.comparator)}const Po={asc:"ASCENDING",desc:"DESCENDING"},No={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro={and:"AND",or:"OR"};class Oo{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Do(e,t){return e.useProto3Json||Pr(t)?t:{value:t}}function Fo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function jo(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Lo(e,t){return Fo(e,t.toTimestamp())}function Uo(e){return Gn(!!e),hr.fromTimestamp(function(e){const t=Qr(e);return new dr(t.seconds,t.nanos)}(e))}function Mo(e,t){return zo(e,t).canonicalString()}function zo(e,t){const n=function(e){return new pr(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Vo(e){const t=pr.fromString(e);return Gn(aa(t)),t}function Bo(e,t){return Mo(e.databaseId,t.path)}function $o(e,t){const n=Vo(t);if(n.get(1)!==e.databaseId.projectId)throw new Yn(Jn.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Yn(Jn.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new vr(Wo(n))}function qo(e,t){return Mo(e.databaseId,t)}function Ho(e){const t=Vo(e);return 4===t.length?pr.emptyPath():Wo(t)}function Ko(e){return new pr(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Wo(e){return Gn(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Go(e,t,n){return{name:Bo(e,t),fields:n.value.mapValue.fields}}function Qo(e,t){let n;if(t instanceof Xs)n={update:Go(e,t.key,t.value)};else if(t instanceof ro)n={delete:Bo(e,t.key)};else if(t instanceof Zs)n={update:Go(e,t.key,t.data),updateMask:oa(t.fieldMask)};else{if(!(t instanceof io))return Wn();n={verify:Bo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Fs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof js)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Us)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zs)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Wn()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Lo(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Wn()}(e,t.precondition)),n}function Jo(e,t){return{documents:[qo(e,t.path)]}}function Yo(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=qo(e,i);const s=function(e){if(0!==e.length)return sa(Ni.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:ra(e.field),direction:ea(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Do(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Xo(e){let t=Ho(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Gn(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Zo(e);return t instanceof Ni&&Oi(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Ci(ia(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Pr(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Si(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Si(n,t)}(n.endAt)),Xi(t,i,o,s,a,"F",l,c)}function Zo(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ia(e.unaryFilter.field);return Pi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=ia(e.unaryFilter.field);return Pi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ia(e.unaryFilter.field);return Pi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ia(e.unaryFilter.field);return Pi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Wn()}}(e):void 0!==e.fieldFilter?function(e){return Pi.create(ia(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Wn()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ni.create(e.compositeFilter.filters.map((e=>Zo(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Wn()}}(e.compositeFilter.op))}(e):Wn()}function ea(e){return Po[e]}function ta(e){return No[e]}function na(e){return Ro[e]}function ra(e){return{fieldPath:e.canonicalString()}}function ia(e){return gr.fromServerFormat(e.fieldPath)}function sa(e){return e instanceof Pi?function(e){if("=="===e.op){if(gi(e.value))return{unaryFilter:{field:ra(e.field),op:"IS_NAN"}};if(mi(e.value))return{unaryFilter:{field:ra(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(gi(e.value))return{unaryFilter:{field:ra(e.field),op:"IS_NOT_NAN"}};if(mi(e.value))return{unaryFilter:{field:ra(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ra(e.field),op:ta(e.op),value:e.value}}}(e):e instanceof Ni?function(e){const t=e.getFilters().map((e=>sa(e)));return 1===t.length?t[0]:{compositeFilter:{op:na(e.op),filters:t}}}(e):Wn()}function oa(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function aa(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class la{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:hr.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:hr.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Wr.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new la(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ca{constructor(e){this.ct=e}}function ua(e){const t=Xo({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?os(t,t.limit,"L"):t}class da{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Jr(e.integerValue));else if("doubleValue"in e){const n=Jr(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Nr(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Qr(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Yr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?wi(e)?this.dt(t,Number.MAX_SAFE_INTEGER):yi(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Wn()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Jr(o)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),vr.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}da.vt=new da;class ha{constructor(){this.un=new fa}addToCollectionParentIndex(e,t){return this.un.add(t),Tr.resolve()}getCollectionParents(e,t){return Tr.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Tr.resolve()}deleteFieldIndex(e,t){return Tr.resolve()}deleteAllFieldIndexes(e){return Tr.resolve()}createTargetIndexes(e,t){return Tr.resolve()}getDocumentsMatchingTarget(e,t){return Tr.resolve(null)}getIndexType(e,t){return Tr.resolve(0)}getFieldIndexes(e,t){return Tr.resolve([])}getNextCollectionGroupToUpdate(e){return Tr.resolve(null)}getMinOffset(e,t){return Tr.resolve(_r.min())}getMinOffsetFromCollectionGroup(e,t){return Tr.resolve(_r.min())}updateCollectionGroup(e,t,n){return Tr.resolve()}updateIndexEntries(e,t){return Tr.resolve()}}class fa{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new $r(pr.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new $r(pr.comparator)).toArray()}}new Uint8Array(0);class pa{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new pa(e,pa.DEFAULT_COLLECTION_PERCENTILE,pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}pa.DEFAULT_COLLECTION_PERCENTILE=10,pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pa.DEFAULT=new pa(41943040,pa.DEFAULT_COLLECTION_PERCENTILE,pa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pa.DISABLED=new pa(-1,0,0);class ma{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ma(0)}static kn(){return new ma(-1)}}class ga{constructor(){this.changes=new ps((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Tr.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class va{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ya{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Qs(n.mutation,e,Hr.empty(),dr.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ks()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ks();const r=ws();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ys();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=ws();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ks())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=gs();const s=Es(),o=Es();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Zs)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Qs(o.mutation,t,o.mutation.getFieldMask(),dr.now())):s.set(t.key,Hr.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new va(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Es();let r=new zr(((e,t)=>e-t)),i=ks();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Hr.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||ks()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=_s();l.forEach((e=>{if(!i.has(e)){const r=Ws(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Tr.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return vr.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ts(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Tr.resolve(ws());let o=-1,a=i;return s.next((t=>Tr.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Tr.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,ks()))).next((e=>({batchId:o,changes:bs(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new vr(t)).next((e=>{let t=ys();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=ys();return this.indexManager.getCollectionParents(e,i).next((o=>Tr.forEach(o,(o=>{const a=function(e,t){return new Yi(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,xi.newInvalidDocument(r)))}));let n=ys();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&Qs(s.mutation,r,Hr.empty(),dr.now()),us(t,r)&&(n=n.insert(e,r))})),n}))}}class ba{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Tr.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Uo(e.createTime)}}(t)),Tr.resolve()}getNamedQuery(e,t){return Tr.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:ua(e.bundledQuery),readTime:Uo(e.readTime)}}(t)),Tr.resolve()}}class wa{constructor(){this.overlays=new zr(vr.comparator),this.Ir=new Map}getOverlay(e,t){return Tr.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ws();return Tr.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),Tr.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),Tr.resolve()}getOverlaysForCollection(e,t,n){const r=ws(),i=t.length+1,s=new vr(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Tr.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new zr(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ws(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=ws(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Tr.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new ao(t,n));let i=this.Ir.get(t);void 0===i&&(i=ks(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class _a{constructor(){this.sessionToken=Wr.EMPTY_BYTE_STRING}getSessionToken(e){return Tr.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Tr.resolve()}}class Ea{constructor(){this.Tr=new $r(xa.Er),this.dr=new $r(xa.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new xa(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new xa(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new vr(new pr([])),n=new xa(t,e),r=new xa(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new vr(new pr([])),n=new xa(t,e),r=new xa(t,e+1);let i=ks();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new xa(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class xa{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return vr.comparator(e.key,t.key)||cr(e.wr,t.wr)}static Ar(e,t){return cr(e.wr,t.wr)||vr.comparator(e.key,t.key)}}class Sa{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new $r(xa.Er)}checkEmpty(e){return Tr.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new so(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.br=this.br.add(new xa(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Tr.resolve(s)}lookupMutationBatch(e,t){return Tr.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Tr.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Tr.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Tr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new xa(t,0),r=new xa(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),Tr.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new $r(cr);return t.forEach((e=>{const t=new xa(e,0),r=new xa(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),Tr.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;vr.isDocumentKey(i)||(i=i.child(""));const s=new xa(new vr(i),0);let o=new $r(cr);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.wr)),!0)}),s),Tr.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Gn(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Tr.forEach(t.mutations,(r=>{const i=new xa(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new xa(t,0),r=this.br.firstAfterOrEqual(n);return Tr.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Tr.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ka{constructor(e){this.Mr=e,this.docs=new zr(vr.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Tr.resolve(n?n.document.mutableCopy():xi.newInvalidDocument(t))}getEntries(e,t){let n=gs();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():xi.newInvalidDocument(e))})),Tr.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=gs();const s=t.path,o=new vr(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Er(wr(o),n)<=0||(r.has(o.key)||us(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Tr.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Wn()}Or(e,t){return Tr.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Ta(this)}getSize(e){return Tr.resolve(this.size)}}class Ta extends ga{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),Tr.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Ca{constructor(e){this.persistence=e,this.Nr=new ps((e=>Gi(e)),Qi),this.lastRemoteSnapshotVersion=hr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ea,this.targetCount=0,this.kr=ma.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),Tr.resolve()}getLastRemoteSnapshotVersion(e){return Tr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Tr.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Tr.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Tr.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ma(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Tr.resolve()}updateTargetData(e,t){return this.Kn(t),Tr.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Tr.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Tr.waitFor(i).next((()=>r))}getTargetCount(e){return Tr.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Tr.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Tr.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Tr.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Tr.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Tr.resolve(n)}containsKey(e,t){return Tr.resolve(this.Br.containsKey(t))}}class Ia{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Ar(0),this.Kr=!1,this.Kr=!0,this.$r=new _a,this.referenceDelegate=e(this),this.Ur=new Ca(this),this.indexManager=new ha,this.remoteDocumentCache=function(e){return new ka(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new ca(t),this.Gr=new ba(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Sa(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){$n("MemoryPersistence","Starting transaction:",e);const r=new Aa(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return Tr.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class Aa extends Sr{constructor(e){super(),this.currentSequenceNumber=e}}class Pa{constructor(e){this.persistence=e,this.Jr=new Ea,this.Yr=null}static Zr(e){return new Pa(e)}get Xr(){if(this.Yr)return this.Yr;throw Wn()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Tr.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Tr.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Tr.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Tr.forEach(this.Xr,(n=>{const r=vr.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,hr.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Tr.or([()=>Tr.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Na{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=ks(),r=ks();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Na(e,t.fromCache,n,r)}}class Ra{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Oa{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=je()?8:Cr(Fe())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Ra;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(Bn()<=et.DEBUG&&$n("QueryEngine","SDK will not create cache indexes for query:",cs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Tr.resolve()):(Bn()<=et.DEBUG&&$n("QueryEngine","Query:",cs(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Bn()<=et.DEBUG&&$n("QueryEngine","The SDK decides to create cache indexes for query:",cs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rs(t))):Tr.resolve())}Yi(e,t){if(es(t))return Tr.resolve(null);let n=rs(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=os(t,null,"F"),n=rs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=ks(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,os(t,null,"F")):this.rs(e,s,t,n)}))))})))))}Zi(e,t,n,r){return es(t)||r.isEqual(hr.min())?Tr.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Tr.resolve(null):(Bn()<=et.DEBUG&&$n("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),cs(t)),this.rs(e,s,t,br(r,-1)).next((e=>e)))}))}ts(e,t){let n=new $r(hs(e));return t.forEach(((t,r)=>{us(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Bn()<=et.DEBUG&&$n("QueryEngine","Using full collection scan to execute query:",cs(t)),this.Ji.getDocumentsMatchingQuery(e,t,_r.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Da{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new zr(cr),this._s=new ps((e=>Gi(e)),Qi),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ya(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function Fa(e,t,n,r){return new Da(e,t,n,r)}async function ja(e,t){const n=Qn(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=ks();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function La(e){const t=Qn(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function Ua(e,t,n){let r=ks(),i=ks();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=gs();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(hr.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):$n("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Ps:r,Is:i}}))}function Ma(e,t){const n=Qn(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function za(e,t){const n=Qn(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,Tr.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new la(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function Va(e,t,n){const r=Qn(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Ir(e))throw e;$n("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function Ba(e,t,n){const r=Qn(e);let i=hr.min(),s=ks();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Qn(e),i=r._s.get(n);return void 0!==i?Tr.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,rs(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:hr.min(),n?s:ks()))).next((e=>($a(r,ds(t),e),{documents:e,Ts:s})))))}function $a(e,t,n){let r=e.us.get(t)||hr.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}class qa{constructor(){this.activeTargetIds=Cs()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ha{constructor(){this.so=new qa,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new qa,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ka{_o(e){}shutdown(){}}class Wa{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){$n("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){$n("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ga=null;function Qa(){return null===Ga?Ga=268435456+Math.round(2147483648*Math.random()):Ga++,"0x"+Ga.toString(16)}const Ja={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ya{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Xa="WebChannelConnection";class Za extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,i){const s=Qa(),o=this.xo(e,t.toUriEncodedString());$n("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,r,i),this.No(e,o,a,n).then((t=>($n("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw Hn("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+zn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Ja[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Qa();return new Promise(((s,o)=>{const a=new In;a.setWithCredentials(!0),a.listenOnce(Pn.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Nn.NO_ERROR:const t=a.getResponseJson();$n(Xa,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Nn.TIMEOUT:$n(Xa,`RPC '${e}' ${i} timed out`),o(new Yn(Jn.DEADLINE_EXCEEDED,"Request time out"));break;case Nn.HTTP_ERROR:const n=a.getStatus();if($n(Xa,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Jn).indexOf(t)>=0?t:Jn.UNKNOWN}(t.status);o(new Yn(e,t.message))}else o(new Yn(Jn.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Yn(Jn.UNAVAILABLE,"Connection failed."));break;default:Wn()}}finally{$n(Xa,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);$n(Xa,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Qa(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Fn(),o=Dn(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");$n(Xa,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);let d=!1,h=!1;const f=new Ya({Io:t=>{h?$n(Xa,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||($n(Xa,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),$n(Xa,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,An.EventType.OPEN,(()=>{h||($n(Xa,`RPC '${e}' stream ${r} transport opened.`),f.yo())})),p(u,An.EventType.CLOSE,(()=>{h||(h=!0,$n(Xa,`RPC '${e}' stream ${r} transport closed`),f.So())})),p(u,An.EventType.ERROR,(t=>{h||(h=!0,Hn(Xa,`RPC '${e}' stream ${r} transport errored:`,t),f.So(new Yn(Jn.UNAVAILABLE,"The operation could not be completed")))})),p(u,An.EventType.MESSAGE,(t=>{var n;if(!h){const i=t.data[0];Gn(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){$n(Xa,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=co[e];if(void 0!==t)return fo(t)}(t),i=o.message;void 0===n&&(n=Jn.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),h=!0,f.So(new Yn(n,i)),u.close()}else $n(Xa,`RPC '${e}' stream ${r} received:`,i),f.bo(i)}})),p(o,On.STAT_EVENT,(t=>{t.stat===Rn.PROXY?$n(Xa,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Rn.NOPROXY&&$n(Xa,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.wo()}),0),f}}function el(){return"undefined"!=typeof document?document:null}function tl(e){return new Oo(e,!0)}class nl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&$n("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class rl{constructor(e,t,n,r,i,s,o,a){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new nl(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Jn.RESOURCE_EXHAUSTED?(qn(t.toString()),qn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Jn.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new Yn(Jn.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return $n("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():($n("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class il extends rl{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Wn()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Gn(void 0===t||"string"==typeof t),Wr.fromBase64String(t||"")):(Gn(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Wr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Jn.UNKNOWN:fo(e.code);return new Yn(t,e.message||"")}(o);n=new ko(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=$o(e,r.document.name),s=Uo(r.document.updateTime),o=r.document.createTime?Uo(r.document.createTime):hr.min(),a=new _i({mapValue:{fields:r.document.fields}}),l=xi.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new xo(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=$o(e,r.document),s=r.readTime?Uo(r.readTime):hr.min(),o=xi.newNoDocument(i,s),a=r.removedTargetIds||[];n=new xo([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=$o(e,r.document),s=r.removedTargetIds||[];n=new xo([],s,i,null)}else{if(!("filter"in t))return Wn();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new lo(r,i),o=e.targetId;n=new So(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return hr.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?hr.min():t.readTime?Uo(t.readTime):hr.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Ko(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Ji(r)?{documents:Jo(e,r)}:{query:Yo(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=jo(e,t.resumeToken);const r=Do(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(hr.min())>0){n.readTime=Fo(e,t.snapshotVersion.toTimestamp());const r=Do(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Wn()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Ko(this.serializer),t.removeTarget=e,this.a_(t)}}class sl extends rl{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Gn(!!e.streamToken),this.lastStreamToken=e.streamToken,Gn(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Gn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Gn(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Uo(e.updateTime):Uo(t);return n.isEqual(hr.min())&&(n=Uo(t)),new $s(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Uo(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Ko(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Qo(this.serializer,e)))};this.a_(t)}}class ol extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Yn(Jn.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Mo(e,zo(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Jn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yn(Jn.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Lo(e,zo(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Jn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yn(Jn.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class al{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(qn(t),this.D_=!1):$n("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class ll{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{vl(this)&&($n("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Qn(e);t.L_.add(4),await ul(t),t.q_.set("Unknown"),t.L_.delete(4),await cl(t)}(this))}))})),this.q_=new al(n,r)}}async function cl(e){if(vl(e))for(const t of e.B_)await t(!0)}async function ul(e){for(const t of e.B_)await t(!1)}function dl(e,t){const n=Qn(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),gl(n)?ml(n):jl(n).r_()&&fl(n,t))}function hl(e,t){const n=Qn(e),r=jl(n);n.N_.delete(t),r.r_()&&pl(n,t),0===n.N_.size&&(r.r_()?r.o_():vl(n)&&n.q_.set("Unknown"))}function fl(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(hr.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}jl(e).A_(t)}function pl(e,t){e.Q_.xe(t),jl(e).R_(t)}function ml(e){e.Q_=new Co({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),jl(e).start(),e.q_.v_()}function gl(e){return vl(e)&&!jl(e).n_()&&e.N_.size>0}function vl(e){return 0===Qn(e).L_.size}function yl(e){e.Q_=void 0}async function bl(e){e.q_.set("Online")}async function wl(e){e.N_.forEach(((t,n)=>{fl(e,t)}))}async function _l(e,t){yl(e),gl(e)?(e.q_.M_(t),ml(e)):e.q_.set("Unknown")}async function El(e,t,n){if(e.q_.set("Online"),t instanceof ko&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){$n("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await xl(e,n)}else if(t instanceof xo?e.Q_.Ke(t):t instanceof So?e.Q_.He(t):e.Q_.We(t),!n.isEqual(hr.min()))try{const t=await La(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Wr.EMPTY_BYTE_STRING,r.snapshotVersion)),pl(e,t);const i=new la(r.target,t,n,r.sequenceNumber);fl(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){$n("RemoteStore","Failed to raise snapshot:",t),await xl(e,t)}}async function xl(e,t,n){if(!Ir(t))throw t;e.L_.add(1),await ul(e),e.q_.set("Offline"),n||(n=()=>La(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{$n("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await cl(e)}))}function Sl(e,t){return t().catch((n=>xl(e,n,t)))}async function kl(e){const t=Qn(e),n=Ll(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Tl(t);)try{const e=await Ma(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,Cl(t,e)}catch(e){await xl(t,e)}Il(t)&&Al(t)}function Tl(e){return vl(e)&&e.O_.length<10}function Cl(e,t){e.O_.push(t);const n=Ll(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Il(e){return vl(e)&&!Ll(e).n_()&&e.O_.length>0}function Al(e){Ll(e).start()}async function Pl(e){Ll(e).p_()}async function Nl(e){const t=Ll(e);for(const n of e.O_)t.m_(n.mutations)}async function Rl(e,t,n){const r=e.O_.shift(),i=oo.from(r,t,n);await Sl(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await kl(e)}async function Ol(e,t){t&&Ll(e).V_&&await async function(e,t){if(function(e){return ho(e)&&e!==Jn.ABORTED}(t.code)){const n=e.O_.shift();Ll(e).s_(),await Sl(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await kl(e)}}(e,t),Il(e)&&Al(e)}async function Dl(e,t){const n=Qn(e);n.asyncQueue.verifyOperationInProgress(),$n("RemoteStore","RemoteStore received new credentials");const r=vl(n);n.L_.add(3),await ul(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await cl(n)}async function Fl(e,t){const n=Qn(e);t?(n.L_.delete(2),await cl(n)):t||(n.L_.add(2),await ul(n),n.q_.set("Unknown"))}function jl(e){return e.K_||(e.K_=function(e,t,n){const r=Qn(e);return r.w_(),new il(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:bl.bind(null,e),Ro:wl.bind(null,e),mo:_l.bind(null,e),d_:El.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),gl(e)?ml(e):e.q_.set("Unknown")):(await e.K_.stop(),yl(e))}))),e.K_}function Ll(e){return e.U_||(e.U_=function(e,t,n){const r=Qn(e);return r.w_(),new sl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Pl.bind(null,e),mo:Ol.bind(null,e),f_:Nl.bind(null,e),g_:Rl.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await kl(e)):(await e.U_.stop(),e.O_.length>0&&($n("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class Ul{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ul(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Yn(Jn.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ml(e,t){if(qn("AsyncQueue",`${t}: ${e}`),Ir(e))return new Yn(Jn.UNAVAILABLE,`${t}: ${e}`);throw e}class zl{constructor(e){this.comparator=e?(t,n)=>e(t,n)||vr.comparator(t.key,n.key):(e,t)=>vr.comparator(e.key,t.key),this.keyedMap=ys(),this.sortedSet=new zr(this.comparator)}static emptySet(e){return new zl(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zl))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new zl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Vl{constructor(){this.W_=new zr(vr.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Wn():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Bl{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Bl(e,t,zl.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&as(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class $l{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class ql{constructor(){this.queries=Hl(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Qn(e),r=n.queries;n.queries=Hl(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new Yn(Jn.ABORTED,"Firestore shutting down"))}}function Hl(){return new ps((e=>ls(e)),as)}async function Kl(e,t){const n=Qn(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new $l,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ml(e,`Initialization of query '${cs(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&Jl(n)}async function Wl(e,t){const n=Qn(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Gl(e,t){const n=Qn(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&Jl(n)}function Ql(e,t,n){const r=Qn(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function Jl(e){e.Y_.forEach((e=>{e.next()}))}var Yl,Xl;(Xl=Yl||(Yl={})).ea="default",Xl.Cache="cache";class Zl{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Bl(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Bl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Yl.Cache}}class ec{constructor(e){this.key=e}}class tc{constructor(e){this.key=e}}class nc{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ks(),this.mutatedKeys=ks(),this.Aa=hs(e),this.Ra=new zl(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Vl,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=us(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Aa(u,a)>0||l&&this.Aa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wn()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const o=t&&!r?this.ya():[],a=0===this.da.size&&this.current&&!r?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new Bl(this.query,e.Ra,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Vl,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ks(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new tc(e))})),this.da.forEach((n=>{e.has(n)||t.push(new ec(n))})),t}ba(e){this.Ta=e.Ts,this.da=ks();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Bl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class rc{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ic{constructor(e){this.key=e,this.va=!1}}class sc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new ps((e=>ls(e)),as),this.Ma=new Map,this.xa=new Set,this.Oa=new zr(vr.comparator),this.Na=new Map,this.La=new Ea,this.Ba={},this.ka=new Map,this.qa=ma.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function oc(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Cc(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await lc(r,t,n,!0),i}async function ac(e,t){const n=Cc(e);await lc(n,t,!0,!1)}async function lc(e,t,n,r){const i=await za(e.localStore,rs(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await cc(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&dl(e.remoteStore,i),a}async function cc(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Ba(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return _c(e,t.targetId,a.wa),a.snapshot}(e,t,n,r);const s=await Ba(e.localStore,t,!0),o=new nc(t,s.Ts),a=o.ma(s.documents),l=Eo.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);_c(e,n,c.wa);const u=new rc(t,n,o);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function uc(e,t,n){const r=Qn(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter((e=>!as(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Va(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&hl(r.remoteStore,i.targetId),bc(r,i.targetId)})).catch(kr)):(bc(r,i.targetId),await Va(r.localStore,i.targetId,!0))}async function dc(e,t){const n=Qn(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),hl(n.remoteStore,r.targetId))}async function hc(e,t){const n=Qn(e);try{const e=await function(e,t){const n=Qn(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Wr.EMPTY_BYTE_STRING,hr.min()).withLastLimboFreeSnapshotVersion(hr.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Ur.updateTargetData(e,c))}));let a=gs(),l=ks();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Ua(e,s,t.documentUpdates).next((e=>{a=e.Ps,l=e.Is}))),!r.isEqual(hr.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Tr.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(Gn(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Gn(r.va):e.removedDocuments.size>0&&(Gn(r.va),r.va=!1))})),await Sc(n,e,t)}catch(e){await kr(e)}}function fc(e,t,n){const r=Qn(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Qn(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&Jl(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function pc(e,t,n){const r=Qn(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new zr(vr.comparator);e=e.insert(s,xi.newNoDocument(s,hr.min()));const n=ks().add(s),i=new _o(hr.min(),new Map,new zr(cr),e,n);await hc(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),xc(r)}else await Va(r.localStore,t,!1).then((()=>bc(r,t,n))).catch(kr)}async function mc(e,t){const n=Qn(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Qn(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Tr.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);Gn(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ks();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);yc(n,r,null),vc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sc(n,e)}catch(e){await kr(e)}}async function gc(e,t,n){const r=Qn(e);try{const e=await function(e,t){const n=Qn(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Gn(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);yc(r,t,n),vc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Sc(r,e)}catch(n){await kr(n)}}function vc(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function yc(e,t,n){const r=Qn(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function bc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||wc(e,t)}))}function wc(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(hl(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),xc(e))}function _c(e,t,n){for(const r of n)r instanceof ec?(e.La.addReference(r.key,t),Ec(e,r)):r instanceof tc?($n("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||wc(e,r.key)):Wn()}function Ec(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||($n("SyncEngine","New document in limbo: "+n),e.xa.add(r),xc(e))}function xc(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new vr(pr.fromString(t)),r=e.qa.next();e.Na.set(r,new ic(n)),e.Oa=e.Oa.insert(n,r),dl(e.remoteStore,new la(rs(Zi(n.path)),r,"TargetPurposeLimboResolution",Ar.oe))}}async function Sc(e,t,n){const r=Qn(e),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,a)=>{o.push(r.Ka(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Na.Wi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Ca.d_(i),await async function(e,t){const n=Qn(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Tr.forEach(t,(t=>Tr.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Tr.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Ir(e))throw e;$n("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function kc(e,t){const n=Qn(e);if(!n.currentUser.isEqual(t)){$n("SyncEngine","User change. New user:",t.toKey());const e=await ja(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Yn(Jn.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Sc(n,e.hs)}}function Tc(e,t){const n=Qn(e),r=n.Na.get(t);if(r&&r.va)return ks().add(r.key);{let e=ks();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function Cc(e){const t=Qn(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=hc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=pc.bind(null,t),t.Ca.d_=Gl.bind(null,t.eventManager),t.Ca.$a=Ql.bind(null,t.eventManager),t}function Ic(e){const t=Qn(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=mc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=gc.bind(null,t),t}class Ac{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Fa(this.persistence,new Oa,e.initialUser,this.serializer)}Ga(e){return new Ia(Pa.Zr,this.serializer)}Wa(e){return new Ha}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ac.provider={build:()=>new Ac};class Pc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>fc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=kc.bind(null,this.syncEngine),await Fl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ql}createDatastore(e){const t=tl(e.databaseInfo.databaseId),n=function(e){return new Za(e)}(e.databaseInfo);return function(e,t,n,r){return new ol(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ll(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>fc(this.syncEngine,e,0)),Wa.D()?new Wa:new Ka)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new sc(e,t,n,r,i,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Qn(e);$n("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await ul(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Pc.provider={build:()=>new Pc};class Nc{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):qn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class Rc{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Mn.UNAUTHENTICATED,this.clientId=lr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{$n("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>($n("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ml(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Oc(e,t){e.asyncQueue.verifyOperationInProgress(),$n("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ja(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Dc(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Fc(e);$n("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Dl(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Dl(t.remoteStore,n))),e._onlineComponents=t}async function Fc(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){$n("FirestoreClient","Using user provided OfflineComponentProvider");try{await Oc(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Jn.FAILED_PRECONDITION||e.code===Jn.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Hn("Error using user provided cache. Falling back to memory cache: "+n),await Oc(e,new Ac)}}else $n("FirestoreClient","Using default OfflineComponentProvider"),await Oc(e,new Ac);return e._offlineComponents}async function jc(e){return e._onlineComponents||(e._uninitializedComponentsProvider?($n("FirestoreClient","Using user provided OnlineComponentProvider"),await Dc(e,e._uninitializedComponentsProvider._online)):($n("FirestoreClient","Using default OnlineComponentProvider"),await Dc(e,new Pc))),e._onlineComponents}function Lc(e){return jc(e).then((e=>e.syncEngine))}async function Uc(e){const t=await jc(e),n=t.eventManager;return n.onListen=oc.bind(null,t.syncEngine),n.onUnlisten=uc.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=ac.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=dc.bind(null,t.syncEngine),n}function Mc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Xn;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Nc({next:a=>{s.Za(),t.enqueueAndForget((()=>Wl(e,o)));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new Yn(Jn.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new Yn(Jn.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Zl(Zi(n.path),s,{includeMetadataChanges:!0,_a:!0});return Kl(e,o)}(await Uc(e),e.asyncQueue,t,n,r))),r.promise}function zc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Xn;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Nc({next:n=>{s.Za(),t.enqueueAndForget((()=>Wl(e,o))),n.fromCache&&"server"===r.source?i.reject(new Yn(Jn.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Zl(n,s,{includeMetadataChanges:!0,_a:!0});return Kl(e,o)}(await Uc(e),e.asyncQueue,t,n,r))),r.promise}function Vc(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Bc=new Map;function $c(e,t,n){if(!n)throw new Yn(Jn.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function qc(e){if(!vr.isDocumentKey(e))throw new Yn(Jn.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Hc(e){if(vr.isDocumentKey(e))throw new Yn(Jn.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Kc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Wn()}function Wc(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Yn(Jn.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Kc(e);throw new Yn(Jn.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Gc{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Yn(Jn.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Yn(Jn.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Yn(Jn.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vc(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Yn(Jn.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Yn(Jn.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Yn(Jn.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qc{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gc({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Yn(Jn.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Yn(Jn.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gc(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new er;switch(e.type){case"firstParty":return new ir(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Yn(Jn.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Bc.get(e);t&&($n("ComponentProvider","Removing Datastore"),Bc.delete(e),t.terminate())}(this),Promise.resolve()}}function Jc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=Wc(e,Qc))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Hn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Mn.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ce(JSON.stringify({alg:"none",type:"JWT"})),Ce(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Yn(Jn.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Mn(s)}e._authCredentials=new tr(new Zn(t,n))}}class Yc{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yc(this.firestore,e,this._query)}}class Xc{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xc(this.firestore,e,this._key)}}class Zc extends Yc{constructor(e,t,n){super(e,t,Zi(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xc(this.firestore,null,new vr(e))}withConverter(e){return new Zc(this.firestore,e,this._path)}}function eu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Ge(e),$c("collection","path",t),e instanceof Qc){const n=pr.fromString(t,...r);return Hc(n),new Zc(e,null,n)}{if(!(e instanceof Xc||e instanceof Zc))throw new Yn(Jn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(pr.fromString(t,...r));return Hc(n),new Zc(e.firestore,null,n)}}function tu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Ge(e),1===arguments.length&&(t=lr.newId()),$c("doc","path",t),e instanceof Qc){const n=pr.fromString(t,...r);return qc(n),new Xc(e,null,new vr(n))}{if(!(e instanceof Xc||e instanceof Zc))throw new Yn(Jn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(pr.fromString(t,...r));return qc(n),new Xc(e.firestore,e instanceof Zc?e.converter:null,new vr(n))}}class nu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new nl(this,"async_queue_retry"),this.Vu=()=>{const e=el();e&&$n("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=el();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=el();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Xn;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(em){if(!Ir(em))throw em;$n("AsyncQueue","Operation failed with retryable error: "+em)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw qn("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Ul.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&Wn()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function ru(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class iu extends Qc{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new nu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nu(e),this._firestoreClient=void 0,await e}}}function su(e){if(e._terminated)throw new Yn(Jn.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||ou(e),e._firestoreClient}function ou(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new ti(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Vc(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Rc(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class au{constructor(e){this._byteString=e}static fromBase64String(e){try{return new au(Wr.fromBase64String(e))}catch(e){throw new Yn(Jn.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new au(Wr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class lu{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Yn(Jn.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gr(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cu{constructor(e){this._methodName=e}}class uu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Yn(Jn.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Yn(Jn.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return cr(this._lat,e._lat)||cr(this._long,e._long)}}class du{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const hu=/^__.*__$/;class fu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Zs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xs(e,this.data,t,this.fieldTransforms)}}class pu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Zs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function mu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Wn()}}class gu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(mu(this.Cu)&&hu.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class vu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||tl(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new gu({Cu:e,methodName:t,qu:n,path:gr.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yu(e){const t=e._freezeSettings(),n=tl(e._databaseId);return new vu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function bu(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);Cu("Data must be an object, but it was:",o,r);const a=ku(r,o);let l,c;if(s.merge)l=new Hr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Iu(t,r,n);if(!o.contains(i))throw new Yn(Jn.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ru(e,i)||e.push(i)}l=new Hr(e),c=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=o.fieldTransforms;return new fu(new _i(a),l,c)}class wu extends cu{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wu}}function _u(e,t,n,r){const i=e.Qu(1,t,n);Cu("Data must be an object, but it was:",i,r);const s=[],o=_i.empty();Ur(r,((e,r)=>{const a=Pu(t,e,n);r=Ge(r);const l=i.Nu(a);if(r instanceof wu)s.push(a);else{const e=Su(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new Hr(s);return new pu(o,a,i.fieldTransforms)}function Eu(e,t,n,r,i,s){const o=e.Qu(1,t,n),a=[Iu(t,r,n)],l=[i];if(s.length%2!=0)throw new Yn(Jn.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(Iu(t,s[h])),l.push(s[h+1]);const c=[],u=_i.empty();for(let h=a.length-1;h>=0;--h)if(!Ru(c,a[h])){const e=a[h];let t=l[h];t=Ge(t);const n=o.Nu(e);if(t instanceof wu)c.push(e);else{const r=Su(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new Hr(c);return new pu(u,d,o.fieldTransforms)}function xu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Su(n,e.Qu(r?4:3,t))}function Su(e,t){if(Tu(e=Ge(e)))return Cu("Unsupported field value:",t,e),ku(e,t);if(e instanceof cu)return function(e,t){if(!mu(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Su(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ge(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ps(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=dr.fromDate(e);return{timestampValue:Fo(t.serializer,n)}}if(e instanceof dr){const n=new dr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Fo(t.serializer,n)}}if(e instanceof uu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof au)return{bytesValue:jo(t.serializer,e._byteString)};if(e instanceof Xc){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Mo(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof du)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return Is(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${Kc(e)}`)}(e,t)}function ku(e,t){const n={};return Mr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ur(e,((e,r)=>{const i=Su(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Tu(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof dr||e instanceof uu||e instanceof au||e instanceof Xc||e instanceof cu||e instanceof du)}function Cu(e,t,n){if(!Tu(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Kc(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function Iu(e,t,n){if((t=Ge(t))instanceof lu)return t._internalPath;if("string"==typeof t)return Pu(e,t);throw Nu("Field path arguments must be of type string or ",e,!1,void 0,n)}const Au=new RegExp("[~\\*/\\[\\]]");function Pu(e,t,n){if(t.search(Au)>=0)throw Nu(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new lu(...t.split("."))._internalPath}catch(r){throw Nu(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Nu(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Yn(Jn.INVALID_ARGUMENT,a+e+l)}function Ru(e,t){return e.some((e=>e.isEqual(t)))}class Ou{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xc(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Du(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Fu("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Du extends Ou{data(){return super.data()}}function Fu(e,t){return"string"==typeof t?Pu(e,t):t instanceof lu?t._internalPath:t._delegate._internalPath}function ju(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Yn(Jn.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lu{}class Uu extends Lu{}function Mu(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Lu&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof Bu)).length,n=e.filter((e=>e instanceof zu)).length;if(t>1||t>0&&n>0)throw new Yn(Jn.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class zu extends Uu{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new zu(e,t,n)}_apply(e){const t=this._parse(e);return Hu(e._query,t),new Yc(e.firestore,e.converter,ss(e._query,t))}_parse(e){const t=yu(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Yn(Jn.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){qu(o,s);const t=[];for(const n of o)t.push($u(r,e,n));a={arrayValue:{values:t}}}else a=$u(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||qu(o,s),a=xu(n,t,o,"in"===s||"not-in"===s);return Pi.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Vu(e,t,n){const r=t,i=Fu("where",e);return zu._create(i,r,n)}class Bu extends Lu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bu(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Ni.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Hu(n,i),n=ss(n,i)}(e._query,t),new Yc(e.firestore,e.converter,ss(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function $u(e,t,n){if("string"==typeof(n=Ge(n))){if(""===n)throw new Yn(Jn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ts(t)&&-1!==n.indexOf("/"))throw new Yn(Jn.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(pr.fromString(n));if(!vr.isDocumentKey(r))throw new Yn(Jn.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hi(e,new vr(r))}if(n instanceof Xc)return hi(e,n._key);throw new Yn(Jn.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kc(n)}.`)}function qu(e,t){if(!Array.isArray(e)||0===e.length)throw new Yn(Jn.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Hu(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Yn(Jn.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Yn(Jn.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Ku{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Wn()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Ur(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Jr(e.doubleValue)));return new du(i)}convertGeoPoint(e){return new uu(Jr(e.latitude),Jr(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Zr(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ei(e));default:return null}}convertTimestamp(e){const t=Qr(e);return new dr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=pr.fromString(e);Gn(aa(n));const r=new ni(n.get(1),n.get(3)),i=new vr(n.popFirst(5));return r.isEqual(t)||qn(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Wu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Gu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qu extends Ou{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Ju(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Fu("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ju extends Qu{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Yu{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Gu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Ju(this._firestore,this._userDataWriter,n.key,n,new Gu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Yn(Jn.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Ju(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Gu(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Ju(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Gu(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Xu(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Xu(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wn()}}function Zu(e){e=Wc(e,Xc);const t=Wc(e.firestore,iu);return Mc(su(t),e._key).then((n=>ld(t,e,n)))}class ed extends Ku{constructor(e){super(),this.firestore=e}convertBytes(e){return new au(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xc(this.firestore,null,t)}}function td(e){e=Wc(e,Yc);const t=Wc(e.firestore,iu),n=su(t),r=new ed(t);return ju(e._query),zc(n,e._query).then((n=>new Yu(t,r,e,n)))}function nd(e,t,n){e=Wc(e,Xc);const r=Wc(e.firestore,iu),i=Wu(e.converter,t,n);return ad(r,[bu(yu(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,qs.none())])}function rd(e,t,n){e=Wc(e,Xc);const r=Wc(e.firestore,iu),i=yu(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=Ge(t))||t instanceof lu?Eu(i,"updateDoc",e._key,t,n,a):_u(i,"updateDoc",e._key,t),ad(r,[s.toMutation(e._key,qs.exists(!0))])}function id(e){return ad(Wc(e.firestore,iu),[new ro(e._key,qs.none())])}function sd(e,t){const n=Wc(e.firestore,iu),r=tu(e),i=Wu(e.converter,t);return ad(n,[bu(yu(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,qs.exists(!1))]).then((()=>r))}function od(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=Ge(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||ru(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(ru(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,d,h;if(e instanceof Xc)d=Wc(e.firestore,iu),h=Zi(e._key.path),u={next:t=>{n[l]&&n[l](ld(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Wc(e,Yc);d=Wc(t.firestore,iu),h=t._query;const r=new ed(d);u={next:e=>{n[l]&&n[l](new Yu(d,r,t,e))},error:n[l+1],complete:n[l+2]},ju(e._query)}return function(e,t,n,r){const i=new Nc(r),s=new Zl(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Kl(await Uc(e),s))),()=>{i.Za(),e.asyncQueue.enqueueAndForget((async()=>Wl(await Uc(e),s)))}}(su(d),h,c,u)}function ad(e,t){return function(e,t){const n=new Xn;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Ic(e);try{const e=await function(e,t){const n=Qn(e),r=dr.now(),i=t.reduce(((e,t)=>e.add(t.key)),ks());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=gs(),l=ks();return n.cs.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Js(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Zs(e.key,t,Ei(t.value.mapValue),qs.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:bs(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new zr(cr)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Sc(r,e.changes),await kl(r.remoteStore)}catch(e){const t=Ml(e,"Failed to persist write");n.reject(t)}}(await Lc(e),t,n))),n.promise}(su(e),t)}function ld(e,t,n){const r=n.docs.get(t._key),i=new ed(e);return new Qu(e,i,t._key,r,new Gu(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){zn=e}(un),sn(new Qe("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new iu(new nr(e.getProvider("auth-internal")),new or(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Yn(Jn.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),fn(Un,"4.7.3",e),fn(Un,"4.7.3","esm2017")}();fn("firebase","10.14.1","app");function cd(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function ud(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dd=ud,hd=new Me("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fd=new st("@firebase/auth");function pd(e){if(fd.logLevel<=et.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];fd.error(`Auth (${un}): ${e}`,...n)}}function md(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw bd(e,...n)}function gd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return bd(e,...n)}function vd(e,t,n){const r=Object.assign(Object.assign({},dd()),{[t]:n});return new Me("auth","Firebase",r).create(t,{appName:e.name})}function yd(e){return vd(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return hd.create(e,...n)}function wd(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw bd(t,...r)}}function _d(e){const t="INTERNAL ASSERTION FAILED: "+e;throw pd(t),new Error(t)}function Ed(e,t){e||_d(t)}function xd(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Sd(){return"http:"===kd()||"https:"===kd()}function kd(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Td(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Sd()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Cd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ed(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Td()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Id(e,t){Ed(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ad{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void _d("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void _d("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void _d("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Pd={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Nd=new Cd(3e4,6e4);function Rd(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Od(e,t,n,r){return Dd(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=$e(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),Ad.fetch()(jd(e,e.config.apiHost,n,o),l)}))}async function Dd(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Pd),t);try{const t=new Ud(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Md(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Md(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Md(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Md(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw vd(e,a,o);md(e,a)}}catch(em){if(em instanceof Ue)throw em;md(e,"network-request-failed",{message:String(em)})}}async function Fd(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Od(e,t,n,r,i);return"mfaPendingCredential"in s&&md(e,"multi-factor-auth-required",{_serverResponse:s}),s}function jd(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Id(e.config,i):`${e.config.apiScheme}://${i}`}function Ld(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ud{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(gd(this.auth,"network-request-failed"))),Nd.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Md(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=gd(e,t,r);return i.customData._tokenResponse=n,i}function zd(e){return void 0!==e&&void 0!==e.enterprise}class Vd{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ld(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Bd(e,t){return Od(e,"GET","/v2/recaptchaConfig",Rd(e,t))}async function $d(e,t){return Od(e,"POST","/v1/accounts:lookup",t)}function qd(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(em){}}function Hd(e){return 1e3*Number(e)}function Kd(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return pd("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ie(n);return e?JSON.parse(e):(pd("Failed to decode base64 JWT payload"),null)}catch(em){return pd("Caught error parsing JWT payload as JSON",null===em||void 0===em?void 0:em.toString()),null}}function Wd(e){const t=Kd(e);return wd(t,"internal-error"),wd("undefined"!==typeof t.exp,"internal-error"),wd("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Gd(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(em){throw em instanceof Ue&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(em)&&e.auth.currentUser===e&&await e.auth.signOut(),em}}class Qd{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(em){return void("auth/network-request-failed"===(null===em||void 0===em?void 0:em.code)&&this.schedule(!0))}this.schedule()}}class Jd{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qd(this.lastLoginAt),this.creationTime=qd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Yd(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Gd(e,$d(n,{idToken:r}));wd(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Xd(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Jd(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function Xd(e){return e.map((e=>{var{providerId:t}=e,n=cd(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Zd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wd(e.idToken,"internal-error"),wd("undefined"!==typeof e.idToken,"internal-error"),wd("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Wd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wd(0!==e.length,"internal-error");const t=Wd(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(wd(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Dd(e,{},(async()=>{const n=$e({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=jd(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ad.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Zd;return n&&(wd("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(wd("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(wd("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zd,this.toJSON())}_performRefresh(){return _d("not implemented")}}function eh(e,t){wd("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class th{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=cd(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Qd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Jd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Gd(this,this.stsTokenManager.getToken(this.auth,e));return wd(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Ge(e),r=await n.getIdToken(t),i=Kd(r);wd(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:qd(Hd(i.auth_time)),issuedAtTime:qd(Hd(i.iat)),expirationTime:qd(Hd(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ge(e);await Yd(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(wd(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new th(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){wd(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Yd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(an(this.auth.app))return Promise.reject(yd(this.auth));const e=await this.getIdToken();return await Gd(this,async function(e,t){return Od(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:_,stsTokenManager:E}=t;wd(y&&E,e,"internal-error");const x=Zd.fromJSON(this.name,E);wd("string"===typeof y,e,"internal-error"),eh(u,e.name),eh(d,e.name),wd("boolean"===typeof b,e,"internal-error"),wd("boolean"===typeof w,e,"internal-error"),eh(h,e.name),eh(f,e.name),eh(p,e.name),eh(m,e.name),eh(g,e.name),eh(v,e.name);const S=new th({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:x,createdAt:g,lastLoginAt:v});return _&&Array.isArray(_)&&(S.providerData=_.map((e=>Object.assign({},e)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Zd;r.updateFromServerResponse(t);const i=new th({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Yd(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];wd(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Xd(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new Zd;o.updateFromIdToken(n);const a=new th({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Jd(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const nh=new Map;function rh(e){Ed(e instanceof Function,"Expected a class definition");let t=nh.get(e);return t?(Ed(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,nh.set(e,t),t)}class ih{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ih.type="NONE";const sh=ih;function oh(e,t,n){return`firebase:${e}:${t}:${n}`}class ah{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=oh(this.userKey,r.apiKey,i),this.fullPersistenceKey=oh("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?th._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ah(rh(sh),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||rh(sh);const s=oh(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=th._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new ah(i,e,n)):new ah(i,e,n)}}function lh(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(hh(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ch(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ph(t))return"Blackberry";if(mh(t))return"Webos";if(uh(t))return"Safari";if((t.includes("chrome/")||dh(t))&&!t.includes("edge/"))return"Chrome";if(fh(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/firefox\//i.test(e)}function uh(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/crios\//i.test(e)}function hh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/iemobile/i.test(e)}function fh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/android/i.test(e)}function ph(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/blackberry/i.test(e)}function mh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/webos/i.test(e)}function gh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function vh(){return function(){const e=Fe();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function yh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return gh(e)||fh(e)||mh(e)||ph(e)||/windows phone/i.test(e)||hh(e)}function bh(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=lh(Fe());break;case"Worker":t=`${lh(Fe())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${un}/${r}`}class wh{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(em){r(em)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(em){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===em||void 0===em?void 0:em.message})}}}class _h{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Eh{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sh(this),this.idTokenSubscription=new Sh(this),this.beforeStateQueue=new wh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=rh(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await ah.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(em){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await $d(this,{idToken:e}),n=await th._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(an(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(em){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(em)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return wd(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(em){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(em){if("auth/network-request-failed"!==(null===em||void 0===em?void 0:em.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(an(this.app))return Promise.reject(yd(this));const t=e?Ge(e):null;return t&&wd(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&wd(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return an(this.app)?Promise.reject(yd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return an(this.app)?Promise.reject(yd(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(rh(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Od(e,"GET","/v2/passwordPolicy",Rd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new _h(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Me("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Od(e,"POST","/v2/accounts:revokeToken",Rd(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&rh(e)||this._popupRedirectResolver;wd(t,this,"argument-error"),this.redirectPersistenceManager=await ah.create(this,[rh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(wd(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wd(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bh(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(fd.logLevel<=et.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];fd.warn(`Auth (${un}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function xh(e){return Ge(e)}class Sh{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Ke(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return wd(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Th(e){return kh.loadJS(e)}function Ch(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Ih{constructor(e){this.type="recaptcha-enterprise",this.auth=xh(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;zd(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Bd(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Vd(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&zd(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=kh.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Th(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ah(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Ih(e);let s;try{s=await i.verify(n)}catch(a){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ph(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ah(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Ah(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Nh(e,t,n){const r=xh(e);wd(r._canInitEmulator,r,"emulator-config-failed"),wd(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Rh(t),{host:o,port:a}=function(e){const t=Rh(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Oh(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Oh(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Rh(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Oh(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Dh{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _d("not implemented")}_getIdTokenResponse(e){return _d("not implemented")}_linkToIdToken(e,t){return _d("not implemented")}_getReauthenticationResolver(e){return _d("not implemented")}}async function Fh(e,t){return Od(e,"POST","/v1/accounts:signUp",t)}async function jh(e,t){return Fd(e,"POST","/v1/accounts:signInWithPassword",Rd(e,t))}class Lh extends Dh{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Lh(e,t,"password")}static _fromEmailAndCode(e,t){return new Lh(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ph(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",jh);case"emailLink":return async function(e,t){return Fd(e,"POST","/v1/accounts:signInWithEmailLink",Rd(e,t))}(e,{email:this._email,oobCode:this._password});default:md(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ph(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Fh);case"emailLink":return async function(e,t){return Fd(e,"POST","/v1/accounts:signInWithEmailLink",Rd(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:md(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Uh(e,t){return Fd(e,"POST","/v1/accounts:signInWithIdp",Rd(e,t))}class Mh extends Dh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Mh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):md("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=cd(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Mh(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Uh(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Uh(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Uh(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$e(t)}return e}}const zh={USER_NOT_FOUND:"user-not-found"};class Vh extends Dh{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Vh({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Vh({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Fd(e,"POST","/v1/accounts:signInWithPhoneNumber",Rd(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Fd(e,"POST","/v1/accounts:signInWithPhoneNumber",Rd(e,t));if(n.temporaryProof)throw Md(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Fd(e,"POST","/v1/accounts:signInWithPhoneNumber",Rd(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),zh)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Vh({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Bh{constructor(e){var t,n,r,i,s,o;const a=qe(He(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);wd(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=qe(He(e)).link,n=t?qe(He(t)).deep_link_id:null,r=qe(He(e)).deep_link_id;return(r?qe(He(r)).link:null)||r||n||t||e}(e);try{return new Bh(t)}catch(n){return null}}}class $h{constructor(){this.providerId=$h.PROVIDER_ID}static credential(e,t){return Lh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Bh.parseLink(t);return wd(n,"argument-error"),Lh._fromEmailAndCode(e,n.code,n.tenantId)}}$h.PROVIDER_ID="password",$h.EMAIL_PASSWORD_SIGN_IN_METHOD="password",$h.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class qh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Hh extends qh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Kh extends Hh{constructor(){super("facebook.com")}static credential(e){return Mh._fromParams({providerId:Kh.PROVIDER_ID,signInMethod:Kh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kh.credentialFromTaggedObject(e)}static credentialFromError(e){return Kh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Kh.credential(t.oauthAccessToken)}catch(n){return null}}}Kh.FACEBOOK_SIGN_IN_METHOD="facebook.com",Kh.PROVIDER_ID="facebook.com";class Wh extends Hh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Mh._fromParams({providerId:Wh.PROVIDER_ID,signInMethod:Wh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wh.credentialFromTaggedObject(e)}static credentialFromError(e){return Wh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Wh.credential(n,r)}catch(i){return null}}}Wh.GOOGLE_SIGN_IN_METHOD="google.com",Wh.PROVIDER_ID="google.com";class Gh extends Hh{constructor(){super("github.com")}static credential(e){return Mh._fromParams({providerId:Gh.PROVIDER_ID,signInMethod:Gh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gh.credentialFromTaggedObject(e)}static credentialFromError(e){return Gh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Gh.credential(t.oauthAccessToken)}catch(n){return null}}}Gh.GITHUB_SIGN_IN_METHOD="github.com",Gh.PROVIDER_ID="github.com";class Qh extends Hh{constructor(){super("twitter.com")}static credential(e,t){return Mh._fromParams({providerId:Qh.PROVIDER_ID,signInMethod:Qh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qh.credentialFromTaggedObject(e)}static credentialFromError(e){return Qh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Qh.credential(n,r)}catch(i){return null}}}async function Jh(e,t){return Fd(e,"POST","/v1/accounts:signUp",Rd(e,t))}Qh.TWITTER_SIGN_IN_METHOD="twitter.com",Qh.PROVIDER_ID="twitter.com";class Yh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await th._fromIdTokenResponse(e,n,r),s=Xh(n);return new Yh({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Xh(n);return new Yh({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Xh(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Zh extends Ue{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Zh.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Zh(e,t,n,r)}}function ef(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Zh._fromErrorAndOperation(e,n,t,r);throw n}))}async function tf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Gd(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Yh._forOperation(e,"link",r)}async function nf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(an(r.app))return Promise.reject(yd(r));const i="reauthenticate";try{const s=await Gd(e,ef(r,i,t,e),n);wd(s.idToken,r,"internal-error");const o=Kd(s.idToken);wd(o,r,"internal-error");const{sub:a}=o;return wd(e.uid===a,r,"user-mismatch"),Yh._forOperation(e,i,s)}catch(em){throw"auth/user-not-found"===(null===em||void 0===em?void 0:em.code)&&md(r,"user-mismatch"),em}}async function rf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(an(e.app))return Promise.reject(yd(e));const r="signIn",i=await ef(e,r,t),s=await Yh._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function sf(e,t){return rf(xh(e),t)}async function of(e){const t=xh(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function af(e){return Ge(e).signOut()}new WeakMap;const lf="__sak";class cf{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lf,"1"),this.storage.removeItem(lf),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class uf extends cf{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yh(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);vh()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uf.type="LOCAL";const df=uf;class hf extends cf{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hf.type="SESSION";const ff=hf;class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new pf(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function mf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}pf.receivers=[];class gf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=mf("",20);r.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function vf(){return window}function yf(){return"undefined"!==typeof vf().WorkerGlobalScope&&"function"===typeof vf().importScripts}const bf="firebaseLocalStorageDb",wf="firebaseLocalStorage",_f="fbase_key";class Ef{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function xf(e,t){return e.transaction([wf],t?"readwrite":"readonly").objectStore(wf)}function Sf(){const e=indexedDB.open(bf,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(wf,{keyPath:_f})}catch(em){n(em)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(wf)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(bf);return new Ef(e).toPromise()}(),t(await Sf()))}))}))}async function kf(e,t,n){const r=xf(e,!0).put({[_f]:t,value:n});return new Ef(r).toPromise()}function Tf(e,t){const n=xf(e,!0).delete(t);return new Ef(n).toPromise()}class Cf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Sf()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(em){if(t++>3)throw em;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(yf()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new gf(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sf();return await kf(e,lf,"1"),await Tf(e,lf),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>kf(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=xf(e,!1).get(t),r=await new Ef(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Tf(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=xf(e,!1).getAll();return new Ef(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Cf.type="LOCAL";const If=Cf;Ch("rcb"),new Cd(3e4,6e4);const Af="recaptcha";async function Pf(e,t,n){var r;const i=await n.verify();try{let s;if(wd("string"===typeof i,e,"argument-error"),wd(n.type===Af,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){wd("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Od(e,"POST","/v2/accounts/mfaEnrollment:start",Rd(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{wd("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;wd(n,e,"missing-multi-factor-info");const o=await function(e,t){return Od(e,"POST","/v2/accounts/mfaSignIn:start",Rd(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Od(e,"POST","/v1/accounts:sendVerificationCode",Rd(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Nf{constructor(e){this.providerId=Nf.PROVIDER_ID,this.auth=xh(e)}verifyPhoneNumber(e,t){return Pf(this.auth,e,Ge(t))}static credential(e,t){return Vh._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Nf.credentialFromTaggedObject(t)}static credentialFromError(e){return Nf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Vh._fromTokenResponse(n,r):null}}function Rf(e,t){return t?rh(t):(wd(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Nf.PROVIDER_ID="phone",Nf.PHONE_SIGN_IN_METHOD="phone";class Of extends Dh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Uh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Uh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Df(e){return rf(e.auth,new Of(e),e.bypassAuthState)}function Ff(e){const{auth:t,user:n}=e;return wd(n,t,"internal-error"),nf(n,new Of(e),e.bypassAuthState)}async function jf(e){const{auth:t,user:n}=e;return wd(n,t,"internal-error"),tf(n,new Of(e),e.bypassAuthState)}class Lf{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(em){this.reject(em)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(em){this.reject(em)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Df;case"linkViaPopup":case"linkViaRedirect":return jf;case"reauthViaPopup":case"reauthViaRedirect":return Ff;default:md(this.auth,"internal-error")}}resolve(e){Ed(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ed(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Uf=new Cd(2e3,1e4);class Mf extends Lf{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Mf.currentPopupAction&&Mf.currentPopupAction.cancel(),Mf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wd(e,this.auth,"internal-error"),e}async onExecution(){Ed(1===this.filter.length,"Popup operations only handle one event");const e=mf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(gd(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(gd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Mf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(gd(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Uf.get())};e()}}Mf.currentPopupAction=null;const zf=new Map;class Vf extends Lf{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=zf.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=qf(t),r=$f(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(em){e=()=>Promise.reject(em)}zf.set(this.auth._key(),e)}return this.bypassAuthState||zf.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Bf(e,t){zf.set(e._key(),t)}function $f(e){return rh(e._redirectPersistence)}function qf(e){return oh("pendingRedirect",e.config.apiKey,e.name)}async function Hf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(an(e.app))return Promise.reject(yd(e));const r=xh(e),i=Rf(r,t),s=new Vf(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Kf{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gf(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Gf(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(gd(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wf(e))}saveEventToCache(e){this.cachedEventUids.add(Wf(e)),this.lastProcessedEventTime=Date.now()}}function Wf(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Gf(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Qf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jf=/^https?/;async function Yf(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Od(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Xf(r))return}catch(n){}md(e,"unauthorized-domain")}function Xf(e){const t=xd(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Jf.test(n))return!1;if(Qf.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Zf=new Cd(3e4,6e4);function ep(){const e=vf().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function tp(e){return new Promise(((t,n)=>{var r,i,s;function o(){ep(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ep(),n(gd(e,"network-request-failed"))},timeout:Zf.get()})}if(null===(i=null===(r=vf().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=vf().gapi)||void 0===s?void 0:s.load)){const t=Ch("iframefcb");return vf()[t]=()=>{gapi.load?o():n(gd(e,"network-request-failed"))},Th(`${kh.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw np=null,e}))}let np=null;const rp=new Cd(5e3,15e3),ip={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function op(e){const t=e.config;wd(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Id(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:un},i=sp.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${$e(r).slice(1)}`}async function ap(e){const t=await function(e){return np=np||tp(e),np}(e),n=vf().gapi;return wd(n,e,"internal-error"),t.open({where:document.body,url:op(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ip,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=gd(e,"network-request-failed"),s=vf().setTimeout((()=>{r(i)}),rp.get());function o(){vf().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const lp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cp{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(em){}}}function up(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},lp),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Fe().toLowerCase();n&&(a=dh(c)?"_blank":n),ch(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return gh(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new cp(null);const d=window.open(t||"",a,u);wd(d,e,"popup-blocked");try{d.focus()}catch(em){}return new cp(d)}const dp="__/auth/handler",hp="emulator/auth/handler",fp=encodeURIComponent("fac");async function pp(e,t,n,r,i,s){wd(e.config.authDomain,e,"auth-domain-config-required"),wd(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:un,eventId:i};if(t instanceof qh){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Hh){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${fp}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${dp}`;return Id(t,hp)}(e)}?${$e(a).slice(1)}${c}`}const mp="webStorageSupport";const gp=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ff,this._completeRedirectFn=Hf,this._overrideRedirectResult=Bf}async _openPopup(e,t,n,r){var i;Ed(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return up(e,await pp(e,t,n,xd(),r),mf())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){vf().location.href=e}(await pp(e,t,n,xd(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ed(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await ap(e),n=new Kf(e);return t.register("authEvent",(t=>{wd(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(mp,{type:mp},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[mp];void 0!==i&&t(!!i),md(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Yf(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return yh()||uh()||gh()}};var vp="@firebase/auth",yp="1.7.9";class bp{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wd(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const wp=Oe("authIdTokenMaxAge")||300;let _p=null;var Ep;kh={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=gd("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ep="Browser",sn(new Qe("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;wd(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:Ep,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bh(Ep)},c=new Eh(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(rh);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),sn(new Qe("auth-internal",(e=>(e=>new bp(e))(xh(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),fn(vp,yp,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ep)),fn(vp,yp,"esm2017");const xp=dn({apiKey:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",authDomain:"fir-project-vercel.firebaseapp.com",projectId:"fir-project-vercel",storageBucket:"fir-project-vercel.firebasestorage.app",messagingSenderId:"1077273582238",appId:"1:1077273582238:web:f283266eaa4796fac7f98f"}),Sp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hn();const t=on(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=on(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Ve(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;md(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:gp,persistence:[If,df,ff]}),r=Oe("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>wp)return;const r=null===t||void 0===t?void 0:t.token;_p!==r&&(_p=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Ge(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){Ge(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const s=Ne("auth");return s&&Nh(n,`http://${s}`),n}(xp),kp=function(e,t){const n="string"==typeof e?e:t||"(default)",r=on("object"==typeof e?e:hn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Ne(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Jc(r,...e)}return r}(xp);var Tp=n(579);const Cp=function(e){let{setUser:n,setRole:r,setPatientId:i,user:s,setError:o}=e;const[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[d,h]=(0,t.useState)(""),[f,p]=(0,t.useState)(!1),m=X(),g=J(),{username:v,password:y}=g.state||{};(0,t.useEffect)((()=>{v&&l(v),y&&u(y)}),[v,y]);const b=(0,t.useCallback)((e=>{m("patient"===e?"/patient/select-doctor":"doctor"===e?"/doctor/chat":"admin"===e?"/admin":"/login"),console.log(`Redirected to ${e} route`)}),[m]);(0,t.useEffect)((()=>{const e=function(e,t,n,r){return Ge(e).onAuthStateChanged(t,n,r)}(Sp,(async e=>{if(e){console.log("User already authenticated:",{uid:e.uid,email:e.email});try{const t=await e.getIdToken(!0),s={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api",o=await fetch(`${s}/users/${e.uid}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"x-user-uid":e.uid,"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(!o.ok){const e=await o.text();return console.error("Failed to fetch user data on auth state change:",o.status,e),h("Failed to fetch user data. Please log in again."),n(null),r(null),i(null),localStorage.removeItem("userId"),localStorage.removeItem("patientId"),void m("/login")}const a=await o.json();if(!a||!a.role)throw new Error("Invalid user data received from server, missing role");const l={uid:e.uid,email:e.email,role:a.role,patientId:a.patientId||null,name:a.name||null,sex:a.sex||null,age:a.age||null};n(l),r(a.role),"patient"===a.role&&a.patientId&&(i(a.patientId),localStorage.setItem("patientId",a.patientId)),localStorage.setItem("userId",e.uid),b(a.role)}catch(d){console.error("Error during auth state change:",d.message),h(`Authentication error: ${d.message}`),n(null),r(null),i(null),localStorage.removeItem("userId"),localStorage.removeItem("patientId"),m("/login")}}else n(null),r(null),i(null),localStorage.removeItem("userId"),localStorage.removeItem("patientId")}));return()=>e()}),[m,n,r,i,b]);const w=e=>t=>{d&&h(""),e(t.target.value)};return(0,Tp.jsxs)("div",{className:"login-container",children:[(0,Tp.jsxs)("div",{className:"login-card",children:[(0,Tp.jsx)("h2",{children:"Login"}),(0,Tp.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!f){if(h(""),p(!0),!a.trim())return h("Email is required."),p(!1),void console.error("Login validation error: Email is empty");if(!a.endsWith("@gmail.com"))return h("Please enter a valid Gmail address (e.g., example@gmail.com)."),p(!1),void console.error("Login validation error: Invalid email domain, must end with @gmail.com");console.log("Attempting login with:",{email:a,password:c});try{const e=await function(e,t,n){return an(e.app)?Promise.reject(yd(e)):sf(Ge(e),$h.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&of(e),t}))}(Sp,a,c),s=e.user;console.log("User logged in successfully:",{uid:s.uid,email:s.email});const o=await s.getIdToken(!0);console.log("Firebase ID token:",o.substring(0,10)+"...");const l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api";console.log("Fetching user data from:",`${l}/users/${s.uid}`);const u=await fetch(`${l}/users/${s.uid}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"x-user-uid":s.uid,"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});console.log("API response status:",u.status,"OK:",u.ok);const d=await u.text();if(console.log("Raw API response:",d),!u.ok)throw console.error("API Error:",u.status,d),new Error(`HTTP error! status: ${u.status}, text: ${d}`);let h;try{h=JSON.parse(d)}catch(t){throw console.error("JSON parsing failed:",t.message,"Raw response:",d),new Error("Failed to parse API response as JSON")}if(console.log("User data received from API:",h),!h||!h.role)throw console.error("Invalid user data:",h),new Error("Invalid user data received from server, missing role");const f={uid:s.uid,email:a,role:h.role,patientId:h.patientId||null,name:h.name||null,sex:h.sex||null,age:h.age||null};console.log("Setting user state:",f),n(f),r(h.role),"patient"===h.role&&h.patientId&&(i(h.patientId),localStorage.setItem("patientId",h.patientId),console.log("Set patientId in localStorage:",h.patientId)),localStorage.setItem("userId",s.uid),console.log("Set userId in localStorage:",s.uid),b(h.role)}catch(d){console.error("Login process error:",{message:d.message,code:d.code,stack:d.stack}),"auth/invalid-credential"===d.code?h("Invalid email or password. Please try again."):"auth/user-not-found"===d.code?h("User not found. Please register first."):"auth/wrong-password"===d.code?h("Incorrect password. Please try again."):d.message.includes("HTTP error")?d.message.includes("404")?h("User data not found on server. Please register or contact support."):h("Failed to fetch user data. Please check the server or try again later."):h(`Login failed: ${d.message}`),o(`Login failed: ${d.message}`)}finally{console.log("Login process completed, isLoading set to false"),p(!1)}}},children:[(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"email",children:"Email"}),(0,Tp.jsx)("input",{type:"email",id:"email",value:a,onChange:w(l),required:!0,placeholder:"Enter your Gmail address (e.g., example@gmail.com)"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"password",children:"Password"}),(0,Tp.jsx)("input",{type:"password",id:"password",value:c,onChange:w(u),required:!0,placeholder:"Enter your password"})]}),d&&(0,Tp.jsx)("p",{className:"error-message",children:d}),(0,Tp.jsx)("button",{type:"submit",disabled:f,className:"login-button",children:f?(0,Tp.jsxs)("svg",{className:"spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Tp.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Tp.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Login"})]}),(0,Tp.jsxs)("p",{className:"register-prompt",children:["First Time Login?"," ",(0,Tp.jsx)("span",{className:"register-link",onClick:()=>{console.log("First Time Login clicked, redirecting to /register"),m("/register",{state:{username:a,password:c}})},children:"Register here"})]})]}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n\n        .login-container {\n          min-height: 100vh;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          padding: 20px;\n          font-family: 'Poppins', sans-serif;\n        }\n\n        .login-card {\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          padding: 40px;\n          border-radius: 15px;\n          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n          width: 100%;\n          max-width: 400px;\n          text-align: center;\n          animation: fadeIn 0.5s ease-in-out;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .login-card:hover {\n          transform: translateY(-5px);\n          box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);\n        }\n\n        h2 {\n          font-size: 2.5rem;\n          color: #FFFFFF;\n          margin-bottom: 30px;\n          position: relative;\n        }\n\n        h2::after {\n          content: '';\n          width: 50px;\n          height: 4px;\n          background: #6E48AA;\n          position: absolute;\n          bottom: -10px;\n          left: 50%;\n          transform: translateX(-50%);\n          border-radius: 2px;\n        }\n\n        .form-group {\n          margin-bottom: 25px;\n          text-align: left;\n        }\n\n        label {\n          display: block;\n          font-size: 1rem;\n          color: #E0E0E0;\n          margin-bottom: 8px;\n          font-weight: 500;\n        }\n\n        input {\n          width: 100%;\n          padding: 12px 15px;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 8px;\n          font-size: 1rem;\n          color: #FFFFFF;\n          background: rgba(255, 255, 255, 0.1);\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        input:focus {\n          outline: none;\n          border-color: #6E48AA;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n          background: rgba(255, 255, 255, 0.15);\n        }\n\n        input::placeholder {\n          color: #A0A0A0;\n        }\n\n        .error-message {\n          color: #E74C3C;\n          font-size: 0.9rem;\n          margin-bottom: 20px;\n          animation: shake 0.5s ease;\n        }\n\n        .login-button {\n          width: 100%;\n          padding: 12px;\n          border: none;\n          border-radius: 8px;\n          font-size: 1.1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n          position: relative;\n          overflow: hidden;\n          background: #6E48AA;\n          color: #FFFFFF;\n        }\n\n        .login-button:disabled {\n          background: #666;\n          color: #A0A0A0;\n          cursor: not-allowed;\n        }\n\n        .login-button:hover:not(:disabled) {\n          transform: scale(1.05);\n          background: #5A3E8B;\n        }\n\n        .login-button::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: -100%;\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(\n            90deg,\n            transparent,\n            rgba(255, 255, 255, 0.2),\n            transparent\n          );\n          transition: 0.5s;\n        }\n\n        .login-button:hover::before {\n          left: 100%;\n        }\n\n        .register-prompt {\n          margin-top: 20px;\n          font-size: 0.95rem;\n          color: #E0E0E0;\n        }\n\n        .register-link {\n          color: #6E48AA;\n          font-weight: 600;\n          cursor: pointer;\n          transition: color 0.3s ease, transform 0.3s ease;\n          display: inline-block;\n        }\n\n        .register-link:hover {\n          color: #5A3E8B;\n          transform: translateX(5px);\n        }\n\n        .spinner {\n          animation: spin 1s linear infinite;\n          width: 24px;\n          height: 24px;\n          margin: 0 auto;\n        }\n\n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes shake {\n          0%, 100% {\n            transform: translateX(0);\n          }\n          10%, 30%, 50%, 70%, 90% {\n            transform: translateX(-5px);\n          }\n          20%, 40%, 60%, 80% {\n            transform: translateX(5px);\n          }\n        }\n\n        @keyframes spin {\n          0% {\n            transform: rotate(0deg);\n          }\n          100% {\n            transform: rotate(360deg);\n          }\n        }\n      "})]})};const Ip=function(e){let{setUser:n,setRole:r,user:i}=e;const[s,o]=(0,t.useState)(""),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[d,h]=(0,t.useState)(""),[f,p]=(0,t.useState)(""),[m,g]=(0,t.useState)(""),[v,y]=(0,t.useState)(""),[b,w]=(0,t.useState)(""),[_,E]=(0,t.useState)(!1),[x,S]=(0,t.useState)(!1),k=X(),T=J(),{username:C,password:I}=T.state||{};return(0,t.useEffect)((()=>{C&&o(C),I&&l(I),(async()=>{const e="abcdefghijklmnopqrstuvwxyz0123456789";let t="";const n=eu(kp,"patients");for(;;){t="";for(let n=0;n<6;n++)t+=e[Math.floor(36*Math.random())];const r=Mu(n,Vu("patientId","==",t));if((await td(r)).empty)break;console.log(`Register.js: Generated patientId ${t} already exists, regenerating...`)}return t})().then((e=>{y(e),console.log("Register.js: Generated unique patientId:",e)})).catch((e=>{console.error("Register.js: Error generating patientId:",e),w("Failed to generate patient ID. Please try again.")}))}),[C,I]),(0,Tp.jsxs)("div",{className:"register-page",children:[(0,Tp.jsxs)("div",{className:"form-sections",children:[(0,Tp.jsxs)("div",{className:"form-section left-section",children:[(0,Tp.jsx)("h3",{children:"Patient Registration"}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"email",children:"Email"}),(0,Tp.jsx)("input",{type:"email",id:"email",value:s,onChange:e=>o(e.target.value),required:!0,placeholder:"Enter your Gmail address (e.g., example@gmail.com)"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"password",children:"Password"}),(0,Tp.jsx)("input",{type:"password",id:"password",value:a,onChange:e=>l(e.target.value),required:!0,placeholder:"Enter your password"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"name",children:"Name"}),(0,Tp.jsx)("input",{type:"text",id:"name",value:c,onChange:e=>u(e.target.value),required:!0,placeholder:"Enter your name"})]})]}),(0,Tp.jsxs)("div",{className:"form-section right-section",children:[(0,Tp.jsx)("h3",{children:"Additional Details"}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"sex",children:"Sex"}),(0,Tp.jsxs)("select",{id:"sex",value:d,onChange:e=>h(e.target.value),required:!0,children:[(0,Tp.jsx)("option",{value:"",disabled:!0,children:"Select sex"}),(0,Tp.jsx)("option",{value:"Male",children:"Male"}),(0,Tp.jsx)("option",{value:"Female",children:"Female"}),(0,Tp.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"age",children:"Age"}),(0,Tp.jsx)("input",{type:"number",id:"age",value:f,onChange:e=>p(e.target.value),required:!0,placeholder:"Enter your age",min:"1"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"address",children:"Address"}),(0,Tp.jsx)("input",{type:"text",id:"address",value:m,onChange:e=>g(e.target.value),required:!0,placeholder:"Enter your address"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"patientId",children:"Patient ID"}),(0,Tp.jsx)("input",{type:"text",id:"patientId",value:v,readOnly:!0,placeholder:"Auto-generated Patient ID"})]}),b&&(0,Tp.jsx)("p",{className:"error-message",children:b}),(0,Tp.jsxs)("div",{className:"terms-group",children:[(0,Tp.jsx)("input",{type:"checkbox",id:"terms",checked:x,onChange:e=>S(e.target.checked)}),(0,Tp.jsx)("label",{htmlFor:"terms",className:"terms-label",children:"I accept the terms and conditions of this site."})]}),(0,Tp.jsx)("button",{onClick:async e=>{if(e.preventDefault(),w(""),E(!0),!x)return w("You must accept the terms and conditions."),void E(!1);if(!s.trim())return w("Email is required."),void E(!1);if(!s.endsWith("@gmail.com"))return w("Email must be a valid Gmail address (e.g., example@gmail.com)."),void E(!1);if(!a)return w("Password is required."),void E(!1);if(!c.trim())return w("Name is required."),void E(!1);if(!d)return w("Sex is required."),void E(!1);if(!f||isNaN(f)||f<=0)return w("Please enter a valid age."),void E(!1);if(!m.trim())return w("Address is required."),void E(!1);if(!v)return w("Patient ID generation failed. Please try again."),void E(!1);console.log("Register.js: Attempting registration with:",{email:s,password:a,role:"patient"});try{const e=await async function(e,t,n){if(an(e.app))return Promise.reject(yd(e));const r=xh(e),i=Ph(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Jh),s=await i.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&of(e),t})),o=await Yh._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(Sp,s,a),i=e.user;console.log("Register.js: User registered in Firebase Auth:",i.uid);const o=tu(kp,"users",i.uid),l={uid:i.uid,email:s,role:"patient",createdAt:(new Date).toISOString(),name:c,sex:d,age:parseInt(f),address:m,patientId:v};await nd(o,l),console.log("Register.js: User data stored in Firestore (users):",i.uid);const u=tu(kp,"patients",v),h={uid:i.uid,patientId:v,name:c,sex:d,age:parseInt(f),address:m,createdAt:(new Date).toISOString()};await nd(u,h),console.log("Register.js: Patient data stored in Firestore (patients):",v);try{const e={patientId:v,name:c,sex:d,age:parseInt(f),address:m,uid:i.uid,createdAt:(new Date).toISOString()},t=await fetch("http://localhost:5005/store-patient-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"});if(!t.ok){const e=await t.text();throw new Error(`Failed to store patient profile: ${t.statusText} - ${e}`)}console.log("Register.js: Patient profile stored in backend:",v)}catch(t){console.error("Register.js: Backend storage error:",t.message),w(`Registration successful, but failed to store patient profile in backend: ${t.message}`)}const p={uid:i.uid,email:s,role:"patient",patientId:v,name:c,sex:d,age:f,address:m};n(p),r("patient"),localStorage.setItem("userId",i.uid),localStorage.setItem("patientId",v),k("/")}catch(b){console.error("Register.js: Registration error:",b.message),"auth/email-already-in-use"===b.code?w("This email is already registered. Please login instead."):"auth/invalid-email"===b.code?w("Please enter a valid Gmail address (e.g., example@gmail.com)."):"auth/weak-password"===b.code?w("Password should be at least 6 characters long."):w(`Registration failed: ${b.message}`)}finally{E(!1)}},disabled:_,className:"register-button",children:_?(0,Tp.jsxs)("svg",{className:"spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Tp.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Tp.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Register Now"}),(0,Tp.jsxs)("p",{className:"login-prompt",children:["Already have an account?"," ",(0,Tp.jsx)("span",{className:"login-link",onClick:()=>{k("/login",{state:{username:s,password:a}})},children:"Login here"})]}),i&&(0,Tp.jsx)("button",{onClick:()=>{n(null),r(null),localStorage.removeItem("userId"),localStorage.removeItem("patientId"),k("/login")},className:"logout-button",children:"Logout"})]})]}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');\n\n        .register-page {\n          min-height: 100vh;\n          width: 100vw;\n          display: flex;\n          justify-content: center;\n          align-items: flex-start;\n          background: linear-gradient(135deg, #6e48aa, #9d50bb);\n          font-family: 'Poppins', sans-serif;\n          overflow-y: auto;\n          margin: 0;\n          padding: 0;\n        }\n\n        .form-sections {\n          display: flex;\n          width: 100%;\n          height: 100%;\n          flex: 1;\n        }\n\n        .form-section {\n          padding: 40px;\n          flex: 1;\n          min-height: 100vh;\n          display: flex;\n          flex-direction: column;\n          justify-content: flex-start;\n        }\n\n        .left-section {\n          background: #ffffff;\n        }\n\n        .right-section {\n          background: #6e48aa;\n          color: #ffffff;\n        }\n\n        h3 {\n          font-size: 1.5rem;\n          font-weight: 600;\n          margin-bottom: 30px;\n          color: #6e48aa;\n        }\n\n        .right-section h3 {\n          color: #ffffff;\n        }\n\n        .form-group {\n          margin-bottom: 25px;\n          width: 100%;\n        }\n\n        label {\n          font-size: 1rem;\n          font-weight: 500;\n          display: block;\n          margin-bottom: 8px;\n          color: #6e48aa;\n        }\n\n        .right-section label {\n          color: #ffffff;\n        }\n\n        input,\n        select {\n          width: 100%;\n          padding: 10px 15px;\n          border: 2px solid #e0e0e0;\n          border-radius: 5px;\n          font-size: 1rem;\n          color: #333;\n          background: #ffffff;\n          transition: border-color 0.3s ease;\n        }\n\n        .right-section input,\n        .right-section select {\n          border: 2px solid rgba(255, 255, 255, 0.3);\n          background: #ffffff;\n          color: #333;\n        }\n\n        input:focus,\n        select:focus {\n          outline: none;\n          border-color: #6e48aa;\n        }\n\n        .right-section input:focus,\n        .right-section select:focus {\n          border-color: #ffffff;\n        }\n\n        input::placeholder,\n        select:invalid {\n          color: #bbb;\n        }\n\n        select option {\n          color: #333;\n          background: #ffffff;\n        }\n\n        select {\n          color: #333;\n        }\n\n        select:invalid {\n          color: #bbb;\n        }\n\n        input[readonly] {\n          background: #e9ecef;\n          cursor: not-allowed;\n          color: #333;\n        }\n\n        .error-message {\n          color: #ff4d4d;\n          font-size: 0.9rem;\n          margin-bottom: 20px;\n          text-align: center;\n          background: rgba(255, 77, 77, 0.1);\n          padding: 8px;\n          border-radius: 8px;\n          animation: shake 0.5s ease;\n        }\n\n        .terms-group {\n          display: flex;\n          align-items: center;\n          margin-bottom: 20px;\n        }\n\n        .terms-group input {\n          width: auto;\n          margin-right: 10px;\n        }\n\n        .terms-label {\n          font-size: 0.9rem;\n          color: #ffffff;\n          margin-bottom: 0;\n        }\n\n        .register-button {\n          width: 150px;\n          height: 50px; /* Adjusted from circular to rectangular */\n          background: #ffffff;\n          color: #6e48aa;\n          border: none;\n          border-radius: 8px;\n          font-size: 1.1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin: 20px auto;\n        }\n\n        .register-button:disabled {\n          background: #e0e0e0;\n          color: #999;\n          cursor: not-allowed;\n        }\n\n        .register-button:hover:not(:disabled) {\n          transform: scale(1.05);\n          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n        }\n\n        .logout-button {\n          display: block;\n          margin: 20px auto;\n          padding: 8px 16px;\n          background: #ff4d4d;\n          color: #fff;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .logout-button:hover {\n          background: #e43c3c;\n          transform: translateY(-2px);\n        }\n\n        .login-prompt {\n          font-size: 0.95rem;\n          color: #ffffff;\n          text-align: center;\n          margin-top: 20px;\n        }\n\n        .login-link {\n          color: #ffffff;\n          font-weight: 600;\n          cursor: pointer;\n          transition: color 0.3s ease;\n          text-decoration: underline;\n        }\n\n        .login-link:hover {\n          color: #e0e0e0;\n        }\n\n        .spinner {\n          animation: spin 1s linear infinite;\n          width: 24px;\n          height: 24px;\n          margin: 0 auto;\n        }\n\n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes shake {\n          0%, 100% {\n            transform: translateX(0);\n          }\n          10%, 30%, 50%, 70%, 90% {\n            transform: translateX(-5px);\n          }\n          20%, 40%, 60%, 80% {\n            transform: translateX(5px);\n          }\n        }\n\n        @keyframes spin {\n          0% {\n            transform: rotate(0deg);\n          }\n          100% {\n            transform: rotate(360deg);\n          }\n        }\n\n        @media (max-width: 768px) {\n          .form-sections {\n            flex-direction: column;\n          }\n\n          .form-section {\n            min-height: auto;\n          }\n\n          .register-page {\n            width: 100%;\n          }\n        }\n\n        @media (max-width: 480px) {\n          .form-section {\n            padding: 20px;\n          }\n\n          h3 {\n            font-size: 1.2rem;\n          }\n\n          .register-button {\n            width: 120px;\n            height: 40px;\n            font-size: 0.9rem;\n          }\n        }\n      "})]})};var Ap=n(92);const Pp={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api",Np=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;for(let o=1;o<=n;o++)try{const s=await fetch(e,t);if(!s.ok){const e=await s.text();let t=`Request failed: ${s.status} - ${s.statusText}`;try{var i;t=(null===(i=JSON.parse(e).error)||void 0===i?void 0:i.message)||e}catch{t=e||"Unknown server error"}if((503===s.status||429===s.status)&&o<n){const e=r*Math.pow(2,o-1);await new Promise((t=>setTimeout(t,e)));continue}throw new Error(`${t} (Status: ${s.status})`)}return s}catch(s){if(o===n)throw s;const e=r*Math.pow(2,o-1);await new Promise((t=>setTimeout(t,e)))}},Rp=e=>{switch(e.toLowerCase()){case"kn":case"kn-in":return"kn-IN";default:return"en-US"}};async function Op(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2?arguments[2]:void 0;if(!e||!(e instanceof Blob))throw new Error("Invalid audio blob: Must be a valid Blob object.");if(!t||"string"!==typeof t)throw new Error("Invalid language code: Must be a non-empty string.");if(!n||"string"!==typeof n)throw new Error("Invalid userId: Must be a non-empty string.");const r=Rp(t),i=new FormData;i.append("audio",e,`recording-${Date.now()}.webm`),i.append("language",r),i.append("uid",n);try{const e=await Np(`${Pp}/audio`,{method:"POST",headers:{"x-user-uid":n},body:i,credentials:"include"}),t=await e.json(),{transcription:s,detectedLanguage:o,audioUrl:a,translatedText:l,warning:c}=t;if(!s||!a)return{transcription:s||"[Transcription unavailable]",languageCode:r,detectedLanguage:o||r.split("-")[0],audioUrl:a||null,translatedText:l||s||"[Translation unavailable]",warning:c||"Incomplete response from server"};const u="kn-IN"===r&&l?l:s;return{transcription:s,languageCode:r,detectedLanguage:o||r.split("-")[0],audioUrl:a,translatedText:u,warning:c}}catch(s){throw new Error(`Transcription failed: ${s.message}`)}}async function Dp(e,t,n,r){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid text: Must be a non-empty string.");if(!t||"string"!==typeof t)throw new Error("Invalid source language code: Must be a non-empty string.");if(!n||"string"!==typeof n)throw new Error("Invalid target language code: Must be a non-empty string.");if(!r||"string"!==typeof r)throw new Error("Invalid userId: Must be a non-empty string.");const i=Rp(t),s=Rp(n);try{if(i===s)return e;const t=await Np(`${Pp}/audio/translate`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":r},body:JSON.stringify({text:e,sourceLanguageCode:i,targetLanguageCode:s}),credentials:"include"}),{translatedText:n}=await t.json();return n||e}catch(o){throw o}}async function Fp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2?arguments[2]:void 0;if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid text: Must be a non-empty string.");if(!t||"string"!==typeof t)throw new Error("Invalid language code: Must be a non-empty string.");if(!n||"string"!==typeof n)throw new Error("Invalid userId: Must be a non-empty string.");const r=Rp(t);try{const t=await Np(`${Pp}/audio/text-to-speech`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n},body:JSON.stringify({text:e,language:r}),credentials:"include"}),i=await t.json();if(!i.audioUrl||"string"!==typeof i.audioUrl)throw new Error("Text-to-speech response missing or invalid audioUrl.");return i.audioUrl.startsWith("https://storage.googleapis.com/"),i.audioUrl}catch(i){if(i.message.includes("404"))throw new Error("Text-to-speech endpoint not found (404). Please check server deployment.");if(i.message.includes("503"))throw new Error("Text-to-speech service unavailable (503). Please try again later.");if(i.message.includes("audioUrl"))throw new Error("Text-to-speech failed: Invalid or missing audio URL from server.");throw new Error(`Text-to-speech conversion failed: ${i.message}`)}}var jp=n(766);let Lp=null;async function Up(e,t){try{if(!e||!t)return{success:!1,message:"Both disease and medicine must be provided."};const n=e.trim().toLowerCase(),r=t.trim().toLowerCase(),i=await(async()=>{if(Lp)return console.log("medicineVerify.js: Using cached CSV data"),Lp;const e="/data/medicine_validation.csv";console.log("medicineVerify.js: Attempting to fetch medicine_validation.csv from:",e);try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch CSV: ${t.statusText}`);const n=await t.text();return console.log("medicineVerify.js: Successfully fetched medicine_validation.csv, parsing content..."),new Promise(((e,t)=>{jp.parse(n,{header:!1,skipEmptyLines:!0,complete:n=>{const r=n.data;if(console.log("medicineVerify.js: Parsed CSV rows:",r),0===r.length)return console.error("medicineVerify.js: No data found in medicine_validation.csv"),void t(new Error("No data found in medicine_validation.csv"));const i=r.filter((e=>e.length<2));if(i.length>0)return console.error("medicineVerify.js: Invalid CSV structure - some rows have fewer than 2 columns:",i),void t(new Error("Invalid CSV structure: Each row must have at least 2 columns (disease, medicine)"));Lp=r,e(r)},error:e=>{console.error("medicineVerify.js: PapaParse error while parsing CSV:",e.message),t(new Error(`PapaParse error: ${e.message}`))}})}))}catch(t){throw console.error("medicineVerify.js: Error fetching CSV:",t.message),t}})();for(const s of i)if(s[0].trim().toLowerCase()===n){for(const n of s.slice(1))if(n&&n.trim().toLowerCase()===r)return console.log(`medicineVerify.js: Verification successful: disease=${e}, medicine=${t}`),{success:!0,message:"Medication verified"};return console.log(`medicineVerify.js: Medicine "${t}" not found for disease "${e}"`),{success:!1,message:"Medicine not found for the specified disease."}}return console.log(`medicineVerify.js: Disease "${e}" not found in database`),{success:!1,message:"Disease not found in the database."}}catch(n){return console.error("medicineVerify.js: Error verifying medicine:",n.message),{success:!1,message:`Error verifying medicine: ${n.message}`}}}async function Mp(e,t,n,r,i,s){try{if(!e||!t||!n||!r||!i||!s)throw new Error("All fields (patientName, doctorName, disease, medicine, patientId, doctorId) are required to notify admin.");const o=await fetch("http://localhost:5005/notify-missed-dose",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:i,doctorId:s,message:`Invalid prescription: ${r} for ${n} (Patient: ${e}, Doctor: ${t})`})});if(!o.ok)throw new Error(`Failed to notify admin: ${o.statusText}`);return console.log("medicineVerify.js: Admin notified of invalid prescription."),{success:!0,message:"Admin notified of invalid prescription."}}catch(o){return console.error("medicineVerify.js: Error notifying admin:",o.message),{success:!1,message:`Error notifying admin: ${o.message}`}}}const zp=function(e){let{user:n,firebaseUser:r,role:i,patientId:s,handleLogout:o}=e;const{patientId:a,doctorId:l}=Z(),[c,u]=(0,t.useState)([]),[d,h]=(0,t.useState)(!1),[f,p]=(0,t.useState)(null),[m,g]=(0,t.useState)(""),[v,y]=(0,t.useState)(null),[b,w]=(0,t.useState)(null),[_,E]=(0,t.useState)(""),[x,S]=(0,t.useState)({}),[k,T]=(0,t.useState)(null),[C,I]=(0,t.useState)(!1),[A,P]=(0,t.useState)(null),[N,R]=(0,t.useState)(null),[O,D]=(0,t.useState)([]),[F,j]=(0,t.useState)(0),[L,U]=(0,t.useState)(0),[M,z]=(0,t.useState)([]),[V,B]=(0,t.useState)(null),$=(0,t.useRef)([]),q=(0,t.useRef)(null),H=(0,t.useRef)(null),K=(0,t.useRef)(null),W=(0,t.useRef)(new Map),G=(0,t.useRef)(null),Q=(0,t.useRef)(null),J=X(),Y=(null===n||void 0===n?void 0:n.uid)||"",ee=a||s||"",te={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api",ne={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.PUSHER_KEY||"2ed44c3ce3ef227d9924",re={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.PUSHER_CLUSTER||"ap2";(0,t.useEffect)((()=>{const e=window.fetch;return window.fetch=async function(){var t,n;console.log("Fetch request:",arguments.length<=0?void 0:arguments[0],{method:null===(t=arguments.length<=1?void 0:arguments[1])||void 0===t?void 0:t.method,mode:null===(n=arguments.length<=1?void 0:arguments[1])||void 0===n?void 0:n.mode});try{const t=await e(...arguments);return t.ok||console.warn(`Fetch failed: ${arguments.length<=0?void 0:arguments[0]} - Status ${t.status}`),t}catch(r){throw console.error(`Fetch error for ${arguments.length<=0?void 0:arguments[0]}:`,r),r}},()=>{window.fetch=e}}),[]);const ie=(0,t.useCallback)((()=>{var e;null===(e=K.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[]);(0,t.useEffect)((()=>{ie()}),[c,ie]),(0,t.useEffect)((()=>(m&&(G.current=setTimeout((()=>{g(""),T(null)}),5e3)),()=>clearTimeout(G.current))),[m]),(0,t.useEffect)((()=>{const e=M.map((e=>setTimeout((()=>{z((t=>t.filter((t=>t.id!==e.id))))}),5e3)));return()=>e.forEach(clearTimeout)}),[M]),(0,t.useEffect)((()=>{if(!Y||!ee||!l||"patient"!==i)return g("User authentication, role, or patient/doctor ID missing. Please log in as a patient."),void J("/login");"Notification"in window&&Notification.requestPermission().then((e=>{"granted"!==e&&g("Notification permission denied. Reminders may not work.")}));return(async()=>{try{const e=tu(kp,"patients",ee),t=await Zu(e);if(t.exists()&&t.data().uid===Y){const e=t.data(),n=e.languagePreference||"en";w(n),y(n),R({name:e.name||"N/A",patientId:ee,email:e.email||"N/A",languagePreference:n,sex:e.sex||"N/A",age:e.age||"N/A",address:e.address||"N/A"})}else g("Patient not found or unauthorized."),J("/login")}catch(e){g(`Failed to fetch patient data: ${e.message}`),J("/login")}})(),(async()=>{try{const e=eu(kp,`patients/${ee}/reminders`),t=(await td(e)).docs.map((e=>({id:e.id,...e.data(),status:e.data().status||"pending",snoozeCount:e.data().snoozeCount||0,scheduledTime:e.data().scheduledTime})));D(t),ae(t),le(t),ce(t)}catch(e){g(`Failed to fetch reminders: ${e.message}`)}})(),(async()=>{const e=localStorage.getItem(`lastContact_${ee}_${l}`),t=new Date;(!e||t-new Date(e)>6048e5)&&B(!0)})(),()=>{H.current&&(H.current.disconnect(),console.log("PatientChat.js: Pusher disconnected")),W.current.forEach((e=>clearTimeout(e))),W.current.clear(),clearTimeout(Q.current)}}),[Y,ee,l,i,J]),(0,t.useEffect)((()=>{const e=c.filter((e=>"doctor"===e.sender&&e.prescription));if(e.length>0){var t;const n=null===(t=e.sort(((e,t)=>t.timestamp.localeCompare(e.timestamp)))[0])||void 0===t?void 0:t.prescription;n&&(console.log("Processing prescription:",n,typeof n),oe(n))}}),[c]),(0,t.useEffect)((()=>{if(b)try{H.current=new Ap(ne,{cluster:re,authEndpoint:`${te}/pusher/auth`,auth:{headers:{"x-user-uid":Y}}}),H.current.connection.bind("error",(e=>{console.error("Pusher connection error:",e),g("Failed to connect to real-time messaging. Attempting to reconnect..."),setTimeout((()=>{H.current&&H.current.connect()}),2e3)})),H.current.connection.bind("connected",(()=>{console.log("Pusher connected successfully"),g("")}));const e=H.current.subscribe(`chat-${ee}-${l}`);e.bind("newMessage",(e=>{console.log("PatientChat.js: Received new message:",{...e,audioUrl:e.audioUrl?"[Audio URL]":null}),u((t=>t.some((t=>t.timestamp===e.timestamp&&t.sender===e.sender&&t.text===e.text&&t.audioUrl===e.audioUrl))?(console.log("PatientChat.js: Skipped duplicate message:",e.timestamp,e.text),t):[...t,e].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))))),"doctor"===e.sender&&(e.diagnosis||e.prescription)&&pe(e.diagnosis,e.prescription,e.timestamp)})),e.bind("missedDoseAlert",(e=>{z((t=>[...t,{...e,id:Date.now().toString()}]))}));const t=async()=>{try{var e,n;const t=`${te}/chats/${ee}/${l}`;console.log("Fetching messages:",{url:t,userId:Y});const s=await r.getIdToken(!0),o=await fetch(t,{headers:{"x-user-uid":Y,Authorization:`Bearer ${s}`},credentials:"include"});if(!o.ok){var i;if(404===o.status)return console.log("Chat not found, initializing empty chat"),void u([]);const e=await o.json();throw new Error(`Failed to fetch messages: ${o.statusText} - ${(null===(i=e.error)||void 0===i?void 0:i.message)||"Unknown error"}`)}const a=(await o.json()).messages||[];u(a.sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))));const c=a.filter((e=>"doctor"===e.sender)),d=(null===(e=c.filter((e=>e.diagnosis)).sort(((e,t)=>t.timestamp.localeCompare(e.timestamp)))[0])||void 0===e?void 0:e.diagnosis)||"",h=(null===(n=c.filter((e=>e.prescription)).sort(((e,t)=>t.timestamp.localeCompare(e.timestamp)))[0])||void 0===n?void 0:n.prescription)||"";(d||h)&&pe(d,h,"latest")}catch(s){console.error("Error fetching messages:",s),g(`Error fetching messages: ${s.message}`),s.message.includes("404")&&setTimeout(t,2e3)}};return t(),()=>{H.current&&(H.current.unsubscribe(`chat-${ee}-${l}`),H.current.disconnect(),console.log("PatientChat.js: Pusher disconnected"))}}catch(e){console.error("Pusher initialization failed:",e),g("Failed to initialize real-time messaging. Please refresh the page.")}}),[Y,ee,l,b,te,r,ne,re]);const se=(0,t.useCallback)((e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"kn":case"kn-in":return"kn-IN";default:return"en-US"}}),[]),oe=async e=>{if(console.log("setupMedicationSchedule: Received prescription:",e,typeof e),!e)return g("Prescription is missing or undefined."),void console.error("setupMedicationSchedule: Prescription is undefined or null");let t,n,r,i,s;if("object"===typeof e){t=e.medicine,n=e.dosage;const o=e.frequency||"";s=e.duration||"5";const a=o.split(" and ").map((e=>e.trim()));if(r=a[0]||"8:00 AM",i=a[1]||"8:00 PM",!t||!n||!r||!i||!s)return g("Invalid prescription object format. Missing required fields."),void console.error("setupMedicationSchedule: Invalid prescription object:",e)}else{if("string"!==typeof e)return g("Unsupported prescription format. Must be a string or object."),void console.error("setupMedicationSchedule: Unsupported prescription type:",typeof e);{const o=/(.+?),\s*(\d+mg),\s*(\d{1,2}[:.]\d{2}\s*(?:AM|PM))\s*and\s*(\d{1,2}[:.]\d{2}\s*(?:AM|PM)),\s*(\d+)\s*days?/i,a=e.match(o);if(!a)return g('Invalid prescription string format. Expected: "Medicine, dosage, time1 and time2, duration days"'),void console.error("setupMedicationSchedule: Invalid prescription string:",e);[,t,n,r,i,s]=a}}const o=parseInt(s,10);if(isNaN(o)||o<=0)return g("Invalid duration in prescription."),void console.error("setupMedicationSchedule: Invalid duration:",s);const a=e=>{const t=e.replace(".",":"),[n,r]=t.split(/\s*(AM|PM)/i);let[i,s]=n.split(":").map(Number);return"PM"===r.toUpperCase()&&12!==i&&(i+=12),"AM"===r.toUpperCase()&&12===i&&(i=0),{hours:i,minutes:s}},l=a(r),c=a(i),u=new Date,d=new Date(u);d.setDate(u.getDate()+o-1);const h=[];let f=new Date(u);for(;f<=d;){const e=new Date(f);if(e.setHours(l.hours,l.minutes,0,0),e>new Date){const r={medicine:t,dosage:n,scheduledTime:e.toISOString(),status:"pending",snoozeCount:0,createdAt:(new Date).toISOString(),patientId:ee};try{const e=eu(kp,`patients/${ee}/reminders`),t=await sd(e,r);h.push({id:t.id,...r})}catch(p){console.error("setupMedicationSchedule: Failed to add reminder1:",p),g(`Failed to add reminder: ${p.message}`)}}const r=new Date(f);if(r.setHours(c.hours,c.minutes,0,0),r>new Date){const e={medicine:t,dosage:n,scheduledTime:r.toISOString(),status:"pending",snoozeCount:0,createdAt:(new Date).toISOString(),patientId:ee};try{const t=eu(kp,`patients/${ee}/reminders`),n=await sd(t,e);h.push({id:n.id,...e})}catch(p){console.error("setupMedicationSchedule: Failed to add reminder2:",p),g(`Failed to add reminder: ${p.message}`)}}f.setDate(f.getDate()+1)}D((e=>[...e,...h])),ae(h),console.log("setupMedicationSchedule: Added reminders:",h)},ae=(0,t.useCallback)((e=>{e.forEach((e=>{if("pending"!==e.status&&"snoozed"!==e.status)return;const t=new Date(e.scheduledTime),n=new Date,r=t-n;if(r>0){const t=setTimeout((()=>{if("Notification"in window&&"granted"===Notification.permission){const t=new Notification("Medication Reminder",{body:`Time to take ${e.dosage} of ${e.medicine}. Tap to confirm or snooze.`,tag:`reminder-${e.id}`});t.onclick=()=>{de(e.id),t.close()},setTimeout((()=>{"pending"===e.status&&he(e.id)}),3e4)}}),r);W.current.set(e.id,t)}else t<n&&"pending"===e.status&&fe(e.id)}))}),[]),le=(0,t.useCallback)((e=>{if(0===e.length)return void j(0);const t=e.filter((e=>"taken"===e.status)).length,n=e.length;j((t/n*100).toFixed(2))}),[]),ce=(0,t.useCallback)((e=>{const t=e.filter((e=>"missed"===e.status)).length;U(t);let n=0;for(let r=0;r<e.length;r++)if("missed"===e[r].status){if(n++,n>=3){ue();break}}else n=0}),[]),ue=async()=>{try{await Mp(`Patient_${ee}`,"Doctor","Missed Doses Alert","Patient has missed 3 consecutive doses."),z((e=>[...e,{id:Date.now().toString(),message:"Alert: You have missed 3 consecutive doses. Notified your doctor."}]))}catch(e){g(`Failed to send missed dose alert: ${e.message}`)}},de=async e=>{try{const t=O.map((t=>t.id===e?{...t,status:"taken",confirmedAt:(new Date).toISOString()}:t));D(t);const n=tu(kp,`patients/${ee}/reminders`,e);await rd(n,{status:"taken",confirmedAt:(new Date).toISOString()}),le(t),ce(t),clearTimeout(W.current.get(e)),W.current.delete(e)}catch(t){g(`Failed to confirm reminder: ${t.message}`)}},he=async e=>{try{const t=O.find((t=>t.id===e));if(!t)return;const n=(t.snoozeCount||0)+1,r=new Date(new Date(t.scheduledTime).getTime()+9e5),i=O.map((t=>t.id===e?{...t,status:"snoozed",snoozeCount:n,scheduledTime:r.toISOString()}:t));D(i);const s=tu(kp,`patients/${ee}/reminders`,e);await rd(s,{status:"snoozed",snoozeCount:n,scheduledTime:r.toISOString()}),ae(i.filter((t=>t.id===e))),clearTimeout(W.current.get(e)),W.current.delete(e)}catch(t){g(`Failed to snooze reminder: ${t.message}`)}},fe=async e=>{try{const t=O.map((t=>t.id===e?{...t,status:"missed"}:t));D(t);const n=tu(kp,`patients/${ee}/reminders`,e);await rd(n,{status:"missed"}),ce(t),clearTimeout(W.current.get(e)),W.current.delete(e)}catch(t){g(`Failed to mark reminder as missed: ${t.message}`)}},pe=async(e,t,n)=>{if(!e||!t)return void S((e=>({...e,[n]:"Diagnosis or prescription is missing."})));const r="object"===typeof t?t.medicine:t;try{await Up(e,r)?S((t=>({...t,[n]:`Prescription "${r}" is valid for diagnosis "${e}".`}))):(S((t=>({...t,[n]:`Invalid prescription "${r}" for diagnosis "${e}".`}))),await Mp(`Patient_${ee}`,"Doctor",e,r))}catch(m){S((e=>({...e,[n]:`Error validating prescription: ${m.message}`}))),await Mp(`Patient_${ee}`,"Doctor",e,r)}},me=async e=>{const t=e.target.files[0];if(!t)return void g("No file selected. Please choose an image.");if(!Y||!ee||!l)return g("Authentication or patient/doctor ID missing. Please log in again."),void J("/login");console.log("Selected file:",{name:t.name,type:t.type,size:t.size});if(!["image/jpeg","image/png","image/gif"].includes(t.type))return g("Invalid file type. Please upload a JPEG, PNG, or GIF image."),void T({file:t,type:"image"});if(t.size>5242880)return g("File too large. Maximum size is 5MB."),void T({file:t,type:"image"});const n={sender:"patient",timestamp:(new Date).toISOString(),doctorId:l,userId:ee,messageType:"image"},i=new FormData;i.append("image",t),i.append("message",JSON.stringify(n)),i.append("sender","patient");const s=`${te}/chats/${ee}/${l}`;console.log("Uploading image:",{url:s,message:n,file:{name:t.name,type:t.type,size:t.size}});try{const e=await r.getIdToken(!0),t=await fetch(s,{method:"POST",headers:{"x-user-uid":Y,Authorization:`Bearer ${e}`},body:i,credentials:"include"});if(!t.ok){var o;const e=await t.json();throw new Error(`Image upload failed: ${t.statusText} - ${(null===(o=e.error)||void 0===o?void 0:o.message)||"Unknown error"}`)}const n=await t.json();if(!n.newMessage.imageUrl)throw new Error("Image upload succeeded, but no image URL was returned.");u((e=>[...e,n.newMessage].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(a){console.error("Image upload failed:",a),g(a.message),T({file:t,type:"image"})}},ge=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(n<=0)throw new Error("Text-to-speech conversion failed after retries. Please try again later.");try{const n=se(t),r=await Fp(e.trim(),n,Y),i=await fetch(r,{method:"HEAD",mode:"cors"});if(!i.ok)throw new Error(`Audio URL inaccessible: ${r} (Status: ${i.status}) - ${i.statusText}`);return r}catch(r){if(console.error(`Text-to-speech attempt ${4-n} failed:`,r),r.message.includes("404"))throw new Error("Text-to-speech service is unavailable (404). Please contact support.");if(r.message.includes("CORS"))throw new Error("CORS policy blocked audio access. Please contact support to update server settings.");return g(`Retrying text-to-speech... (Attempts remaining: ${n-1})`),await new Promise((e=>setTimeout(e,2e3))),ge(e,t,n-1)}},ve=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(n<=0)g("Failed to read aloud after retries. Please try again later.");else try{if(!e||"string"!==typeof e||""===e.trim())return void g("Cannot read aloud: No valid text provided.");const n=await ge(e,t);await async function(e){if(!e||"string"!==typeof e)throw new Error("Invalid audio URL: Must be a non-empty string.");return new Promise(((t,n)=>{const r=new Audio(e);r.onloadeddata=()=>{r.play().then((()=>{t()})).catch((e=>{n(new Error(`Playback failed: ${e.message}`))}))},r.onerror=e=>{n(new Error(`Failed to load audio: ${e.message}`))}}))}(n)}catch(r){if(console.error("Error reading aloud:",r),n>1&&r.message.includes("Failed to load audio"))return g(`Retrying audio playback... (Attempts remaining: ${n-1})`),await new Promise((e=>setTimeout(e,2e3))),ve(e,t,n-1);let i=`Error reading aloud: ${r.message}`;r.message.includes("Failed to load audio")?i="Error reading aloud: Audio file could not be loaded. It may be inaccessible or unsupported.":r.message.includes("CORS")?i="Error reading aloud: CORS policy blocked access. Please contact support.":r.message.includes("Playback failed")&&(i="Error reading aloud: Audio playback failed. Please check your browser or device audio settings."),g(i)}},ye=async()=>{if(!_.trim())return;const e={sender:"patient",text:_,translatedText:null,timestamp:(new Date).toISOString(),language:"en",recordingLanguage:"en",doctorId:l,userId:ee};u((t=>t.some((t=>t.timestamp===e.timestamp&&t.text===e.text))?(console.log("PatientChat.js: Skipped duplicate text message:",e.timestamp,e.text),t):[...t,e].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))))),E("");try{const n=`${te}/chats/${ee}/${l}`;console.log("Sending text message:",{url:n,message:e});const i=await r.getIdToken(!0),s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":Y,Authorization:`Bearer ${i}`},body:JSON.stringify({message:e}),credentials:"include"});if(!s.ok){var t;const e=await s.json();throw new Error(`Failed to save text message: ${s.statusText} - ${(null===(t=e.error)||void 0===t?void 0:t.message)||"Unknown error"}`)}const o=await s.json();u((t=>[...t.filter((t=>t.timestamp!==e.timestamp)),o.newMessage].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(n){console.error("Failed to save text message:",n),g(`Failed to save text message: ${n.message}`),n.message.includes("404")&&setTimeout((()=>ye()),2e3)}},be=async e=>{const t={sender:"patient",text:e,translatedText:null,timestamp:(new Date).toISOString(),language:"en",recordingLanguage:"en",doctorId:l,userId:ee};u((e=>e.some((e=>e.timestamp===t.timestamp&&e.text===t.text))?(console.log("PatientChat.js: Skipped duplicate quick reply:",t.timestamp,t.text),e):[...e,t].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))));try{const e=`${te}/chats/${ee}/${l}`;console.log("Sending quick reply:",{url:e,message:t});const i=await r.getIdToken(!0),s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":Y,Authorization:`Bearer ${i}`},body:JSON.stringify({message:t}),credentials:"include"});if(!s.ok){var n;const e=await s.json();throw new Error(`Failed to save quick reply message: ${s.statusText} - ${(null===(n=e.error)||void 0===n?void 0:n.message)||"Unknown error"}`)}const o=await s.json();u((e=>[...e.filter((e=>e.timestamp!==t.timestamp)),o.newMessage].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(i){console.error("Failed to save quick reply:",i),g(`Failed to save quick reply message: ${i.message}`)}},we=e=>{"yes"===e?(B(!1),localStorage.setItem(`lastContact_${ee}_${l}`,(new Date).toISOString())):(B(!1),J("/login"))};return null===b||null===v?(0,Tp.jsxs)("div",{className:"loading-container",children:[(0,Tp.jsx)("p",{children:"Loading language preference..."}),(0,Tp.jsx)("style",{children:"\n          .loading-container {\n            width: 100vw;\n            height: 100vh;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n            font-family: 'Poppins', sans-serif;\n            color: #E0E0E0;\n            font-size: 1.2rem;\n          }\n        "})]}):(0,Tp.jsxs)("div",{className:"patient-chat-container",children:[(0,Tp.jsxs)("div",{className:"chat-header",children:[(0,Tp.jsx)("button",{className:"hamburger-button",onClick:()=>I(!C),children:"\u2630"}),(0,Tp.jsxs)("h2",{children:["Patient Chat (ID: ",ee,")"]}),(0,Tp.jsx)("div",{className:"header-actions",children:(0,Tp.jsx)("button",{onClick:o,className:"logout-button",children:"Logout"})})]}),(0,Tp.jsxs)("div",{className:"chat-layout",children:[(0,Tp.jsxs)("div",{className:"sidebar "+(C?"open":""),children:[(0,Tp.jsxs)("div",{className:"sidebar-header",children:[(0,Tp.jsx)("h3",{children:"Menu"}),(0,Tp.jsx)("button",{className:"close-menu",onClick:()=>I(!1),children:"\u2715"})]}),(0,Tp.jsxs)("ul",{className:"menu-list",children:[(0,Tp.jsx)("li",{onClick:()=>{P("profile"),I(!1)},className:"profile"===A?"active":"",children:"View Profile"}),(0,Tp.jsx)("li",{onClick:()=>{P("reminders"),I(!1)},className:"reminders"===A?"active":"",children:"Reminders"}),(0,Tp.jsx)("li",{onClick:()=>{P("recommendations"),I(!1)},className:"recommendations"===A?"active":"",children:"Doctor's Recommendations"})]})]}),(0,Tp.jsxs)("div",{className:"chat-content",children:[V&&(0,Tp.jsxs)("div",{className:"doctor-prompt",children:[(0,Tp.jsx)("p",{children:"Allow communication with doctor? (First contact or 7+ days)"}),(0,Tp.jsx)("button",{onClick:()=>we("yes"),children:"Yes"}),(0,Tp.jsx)("button",{onClick:()=>we("no"),children:"No"})]}),"profile"===A&&N&&(0,Tp.jsxs)("div",{className:"profile-section",children:[(0,Tp.jsx)("h3",{children:"Patient Profile"}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Name:"})," ",N.name]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Patient ID:"})," ",N.patientId]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Email:"})," ",N.email]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Language Preference:"})," ","kn"===N.languagePreference?"Kannada":"English"]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Sex:"})," ",N.sex]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Age:"})," ",N.age]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Address:"})," ",N.address]}),(0,Tp.jsx)("button",{onClick:()=>P(null),className:"close-section-button",children:"Close"})]}),"reminders"===A&&(0,Tp.jsxs)("div",{className:"reminders-section",children:[(0,Tp.jsx)("h3",{children:"Medication Reminders"}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Adherence Rate:"})," ",F,"% (Taken ",O.filter((e=>"taken"===e.status)).length," of ",O.length,")"]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Missed Doses:"})," ",L]}),M.length>0&&(0,Tp.jsx)("div",{className:"missed-dose-alerts",children:M.map((e=>(0,Tp.jsx)("div",{className:"alert-item",children:(0,Tp.jsx)("p",{children:e.message})},e.id)))}),O.length>0?(0,Tp.jsxs)("div",{className:"reminders-table",children:[(0,Tp.jsxs)("div",{className:"table-header",children:[(0,Tp.jsx)("span",{children:"Medicine"}),(0,Tp.jsx)("span",{children:"Dosage"}),(0,Tp.jsx)("span",{children:"Time"}),(0,Tp.jsx)("span",{children:"Status"}),(0,Tp.jsx)("span",{children:"Actions"})]}),O.sort(((e,t)=>new Date(e.scheduledTime)-new Date(t.scheduledTime))).map((e=>(0,Tp.jsxs)("div",{className:"table-row",children:[(0,Tp.jsx)("span",{children:e.medicine}),(0,Tp.jsx)("span",{children:e.dosage}),(0,Tp.jsx)("span",{children:new Date(e.scheduledTime).toLocaleString()}),(0,Tp.jsx)("span",{children:e.status}),(0,Tp.jsx)("span",{children:"pending"===e.status||"snoozed"===e.status?(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("button",{onClick:()=>de(e.id),className:"confirm-button",children:"Taken"}),(0,Tp.jsx)("button",{onClick:()=>he(e.id),className:"snooze-button",children:"Snooze"})]}):"-"})]},e.id)))]}):(0,Tp.jsx)("p",{children:"No reminders set yet. Waiting for doctor's prescription."}),(0,Tp.jsx)("button",{onClick:()=>P(null),className:"close-section-button",children:"Close"})]}),"recommendations"===A&&(0,Tp.jsxs)("div",{className:"recommendations-section",children:[(0,Tp.jsx)("h3",{children:"Doctor's Recommendations"}),M.length>0&&(0,Tp.jsx)("div",{className:"missed-dose-alerts",children:M.map((e=>(0,Tp.jsx)("div",{className:"alert-item",children:(0,Tp.jsx)("p",{children:e.message})},e.id)))}),c.filter((e=>"doctor"===e.sender&&(e.diagnosis||e.prescription))).length>0?c.filter((e=>"doctor"===e.sender&&(e.diagnosis||e.prescription))).sort(((e,t)=>t.timestamp.localeCompare(e.timestamp))).map(((e,t)=>(0,Tp.jsxs)("div",{children:[e.diagnosis&&(0,Tp.jsxs)("div",{className:"recommendation-item",children:[(0,Tp.jsx)("strong",{children:"Diagnosis:"})," ","kn"===b&&e.translatedDiagnosis||e.diagnosis,(0,Tp.jsx)("div",{className:"read-aloud-container",children:"kn"===b?(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("button",{onClick:()=>ve("kn"===b&&e.translatedDiagnosis||e.diagnosis,"kn"),className:"read-aloud-button kannada",children:"\ud83d\udd0a Kannada"}),(0,Tp.jsx)("button",{onClick:()=>ve("kn"===b&&e.translatedDiagnosis||e.diagnosis,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"})]}):(0,Tp.jsx)("button",{onClick:()=>ve("kn"===b&&e.translatedDiagnosis||e.diagnosis,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"})})]}),e.prescription&&(0,Tp.jsxs)("div",{className:"recommendation-item",children:[(0,Tp.jsx)("strong",{children:"Prescription:"})," ","object"===typeof e.prescription?`${e.prescription.medicine}, ${e.prescription.dosage}, ${e.prescription.frequency}, ${e.prescription.duration}`:e.prescription,(0,Tp.jsx)("button",{onClick:()=>pe(e.diagnosis,e.prescription,e.timestamp),className:"validate-button",children:"\u2705 Validate"}),x[e.timestamp]&&(0,Tp.jsx)("span",{className:x[e.timestamp].includes("valid")?"validation-success":"validation-error",children:x[e.timestamp]})]})]},`${e.timestamp}-${t}`))):(0,Tp.jsx)("p",{children:"No recommendations from the doctor yet."}),(0,Tp.jsx)("button",{onClick:()=>P(null),className:"close-section-button",children:"Close"})]}),null===A&&(0,Tp.jsxs)("div",{className:"messages-container",children:[M.length>0&&(0,Tp.jsx)("div",{className:"missed-dose-alerts",children:M.map((e=>(0,Tp.jsx)("div",{className:"alert-item",children:(0,Tp.jsx)("p",{children:e.message})},e.id)))}),0===c.length&&(0,Tp.jsx)("p",{className:"no-messages",children:"No messages yet."}),c.map(((e,t)=>(0,Tp.jsx)("div",{className:"message "+("patient"===e.sender?"patient-message":"doctor-message"),children:(0,Tp.jsxs)("div",{className:"message-content",children:["patient"===e.sender&&e.audioUrl&&(0,Tp.jsx)(Tp.Fragment,{children:"en-US"===e.recordingLanguage?(0,Tp.jsxs)("div",{className:"message-block",children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}),(0,Tp.jsxs)("div",{className:"audio-container",children:[(0,Tp.jsx)("audio",{controls:!0,src:e.audioUrl,onError:()=>g("Failed to load audio. It may be inaccessible or unsupported.")}),(0,Tp.jsx)("div",{className:"read-aloud-container",children:(0,Tp.jsx)("button",{onClick:()=>ve(e.text,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"})}),(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]})]}):(0,Tp.jsxs)("div",{className:"message-block",children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}),e.translatedText&&(0,Tp.jsxs)("p",{className:"translated-text",children:["English: ",e.translatedText]}),(0,Tp.jsxs)("div",{className:"audio-container",children:[(0,Tp.jsx)("audio",{controls:!0,src:e.audioUrl,onError:()=>g("Failed to load audio. It may be inaccessible or unsupported.")}),(0,Tp.jsxs)("div",{className:"read-aloud-container",children:[(0,Tp.jsx)("button",{onClick:()=>ve(e.text,"kn"),className:"read-aloud-button kannada",children:"\ud83d\udd0a Kannada"}),(0,Tp.jsx)("button",{onClick:()=>ve(e.translatedText||e.text,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"})]}),(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]})]})}),"patient"===e.sender&&!e.audioUrl&&(0,Tp.jsx)("div",{className:"message-block",children:(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"})}),"doctor"===e.sender&&(0,Tp.jsxs)("div",{className:"message-block",children:["en"===b?(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}):(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}),e.translatedText&&(0,Tp.jsxs)("p",{className:"translated-text",children:["English: ",e.translatedText]})]}),e.audioUrl&&(0,Tp.jsxs)("div",{className:"audio-container",children:[(0,Tp.jsx)("audio",{controls:!0,src:e.audioUrl,onError:()=>g("Failed to load audio. It may be inaccessible or unsupported.")}),(0,Tp.jsx)("div",{className:"read-aloud-container",children:"en"===b?(0,Tp.jsx)("button",{onClick:()=>ve(e.text,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"}):(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("button",{onClick:()=>ve(e.text,"kn"),className:"read-aloud-button kannada",children:"\ud83d\udd0a Kannada"}),(0,Tp.jsx)("button",{onClick:()=>ve(e.translatedText||e.text,"en"),className:"read-aloud-button english",children:"\ud83d\udd0a English"})]})}),(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]})]}),e.imageUrl&&(0,Tp.jsx)("img",{src:e.imageUrl,alt:"Patient upload",className:"chat-image"}),e.audioError&&(0,Tp.jsx)("p",{className:"audio-error",children:e.audioError}),(0,Tp.jsx)("span",{className:"timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]})},`${e.timestamp}-${t}`))),(0,Tp.jsx)("div",{ref:K})]}),m&&(0,Tp.jsxs)("div",{className:"error-message",children:[m,k&&k.audioBlob&&(0,Tp.jsx)("button",{onClick:()=>(async(e,t)=>{if(!e||!t)return void g("Invalid retry data. Please start a new recording.");g("Retrying upload... (Attempts remaining: 3)");let n=3;const i=async()=>{try{console.log("Retrying upload with:",{language:t,audioBlobSize:e.size});const n=await Op(e,t,Y);if(!n.audioUrl)throw new Error("Transcription succeeded, but no audio URL was returned.");const i=await fetch(n.audioUrl,{method:"HEAD",mode:"cors"});if(!i.ok)throw new Error(`Audio URL inaccessible: ${n.audioUrl} (Status: ${i.status})`);g(""),T(null),clearTimeout(Q.current);const o={sender:"patient",text:n.transcription||"Transcription failed",translatedText:n.translatedText||"",timestamp:(new Date).toISOString(),language:t,recordingLanguage:t,doctorId:l,userId:ee,audioUrl:n.audioUrl},a=new FormData;a.append("audio",e,`audio_${(new Date).toISOString()}.webm`),a.append("message",JSON.stringify(o)),a.append("sender","patient");const c=`${te}/chats/${ee}/${l}`;console.log("Sending retry upload:",{url:c,message:o});const d=await r.getIdToken(!0),h=await fetch(c,{method:"POST",headers:{"x-user-uid":Y,Authorization:`Bearer ${d}`},body:a,credentials:"include"});if(!h.ok){var s;const e=await h.json();throw new Error(`Failed to save message: ${h.statusText} - ${(null===(s=e.error)||void 0===s?void 0:s.message)||"Unknown error"}`)}const f=await h.json();u((e=>e.some((e=>e.timestamp===f.newMessage.timestamp&&e.sender===f.newMessage.sender&&e.text===f.newMessage.text&&e.audioUrl===f.newMessage.audioUrl))?(console.log("PatientChat.js: Skipped duplicate retry message:",f.newMessage.timestamp,f.newMessage.text),e):[...e,f.newMessage].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(o){console.error("Retry upload failed:",o),n--,n>0?(g(`Retrying upload... (Attempts remaining: ${n})`),Q.current=setTimeout(i,2e3*(4-n))):(g(`Failed to transcribe audio after retries: ${o.message}`),T({audioBlob:e,language:t}),clearTimeout(Q.current))}};i()})(k.audioBlob,k.language),className:"retry-button",children:"Retry Upload"}),k&&"image"===k.type&&k.file&&(0,Tp.jsx)("button",{onClick:()=>me({target:{files:[k.file]}}),className:"retry-button",children:"Retry Image Upload"})]}),null===A&&(0,Tp.jsxs)("div",{className:"controls",children:[(0,Tp.jsxs)("div",{className:"language-buttons",children:[(0,Tp.jsx)("button",{onClick:()=>y("kn"),className:"kn"===v?"active-lang":"",children:"Kannada"}),(0,Tp.jsx)("button",{onClick:()=>y("en"),className:"en"===v?"active-lang":"",children:"English"})]}),(0,Tp.jsxs)("div",{className:"recording-buttons",children:[(0,Tp.jsx)("button",{onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});q.current=e;const t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});p(t),$.current=[],t.ondataavailable=e=>e.data.size>0&&$.current.push(e.data),t.onstop=async()=>{const e=new Blob($.current,{type:"audio/webm"});if(0===e.size)return void g("Recorded audio is empty. Please try again.");if(!Y)return g("User authentication failed. Please log in again."),void J("/login");const t=se(v);let n,i=null;try{const o=await Op(e,t,Y);n=o.transcription||"Transcription failed","kn-IN"===t?i=o.translatedText||await Dp(n,"kn-IN","en-US",Y):"en-US"===t&&"kn"===b&&(i=await Dp(n,"en-US","kn-IN",Y));const a={sender:"patient",text:n,translatedText:i,timestamp:(new Date).toISOString(),language:t,recordingLanguage:t,doctorId:l,userId:ee,audioUrl:o.audioUrl},c=new FormData;c.append("audio",e,`audio_${(new Date).toISOString()}.webm`),c.append("message",JSON.stringify(a)),c.append("sender","patient");const d=`${te}/chats/${ee}/${l}`;console.log("Sending audio message:",{url:d,message:a,audioSize:e.size});const h=await r.getIdToken(!0),f=await fetch(d,{method:"POST",headers:{"x-user-uid":Y,Authorization:`Bearer ${h}`},body:c,credentials:"include"});if(!f.ok){var s;const e=await f.json();throw new Error(`Failed to save message: ${f.statusText} - ${(null===(s=e.error)||void 0===s?void 0:s.message)||"Unknown error"}`)}const p=await f.json();u((e=>e.some((e=>e.timestamp===p.newMessage.timestamp&&e.sender===p.newMessage.sender&&e.text===p.newMessage.text&&e.audioUrl===p.newMessage.audioUrl))?(console.log("PatientChat.js: Skipped duplicate recording message:",p.newMessage.timestamp,p.newMessage.text),e):[...e,p.newMessage].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(o){console.error("Audio processing failed:",o),g(`Failed to process audio: ${o.message}`),T({audioBlob:e,language:t})}q.current&&(q.current.getTracks().forEach((e=>e.stop())),q.current=null)},t.start(),h(!0)}catch(e){console.error("Error starting recording:",e),g(`Error starting recording: ${e.message}`)}},disabled:d,className:d?"disabled-button":"start-button",children:"\ud83c\udf99\ufe0f Start Recording"}),(0,Tp.jsx)("button",{onClick:()=>{f&&(f.stop(),h(!1),q.current&&(q.current.getTracks().forEach((e=>e.stop())),q.current=null),p(null))},disabled:!d,className:d?"stop-button":"disabled-button",children:"\ud83d\uded1 Stop Recording"}),(0,Tp.jsxs)("label",{className:"image-upload",children:["\ud83d\udcf7 Upload Image",(0,Tp.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/gif",onChange:me,style:{display:"none"}})]})]}),(0,Tp.jsxs)("div",{className:"text-input-container",children:[(0,Tp.jsx)("input",{type:"text",value:_,onChange:e=>E(e.target.value),placeholder:"Type your message (English only)...",onKeyPress:e=>"Enter"===e.key&&ye()}),(0,Tp.jsx)("button",{onClick:ye,className:"send-button",children:"Send"})]}),(0,Tp.jsxs)("div",{className:"quick-replies",children:[(0,Tp.jsx)("button",{onClick:()=>be("Let's do it"),children:"Let's do it"}),(0,Tp.jsx)("button",{onClick:()=>be("Great!"),children:"Great!"})]})]})]})]}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n\n        .patient-chat-container {\n          width: 100vw;\n          height: 100vh;\n          display: flex;\n          flex-direction: column;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          font-family: 'Poppins', sans-serif;\n          color: #E0E0E0;\n          overflow: hidden;\n        }\n\n        .chat-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 15px 30px;\n          background: rgba(44, 26, 61, 0.8);\n          backdrop-filter: blur(10px);\n          border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .hamburger-button {\n          background: none;\n          border: none;\n          color: #FFFFFF;\n          font-size: 1.8rem;\n          cursor: pointer;\n          transition: transform 0.3s ease;\n        }\n\n        .hamburger-button:hover {\n          transform: scale(1.1);\n        }\n\n        .chat-header h2 {\n          font-size: 1.8rem;\n          font-weight: 600;\n          color: #FFFFFF;\n          position: relative;\n        }\n\n        .chat-header h2::after {\n          content: '';\n          width: 40px;\n          height: 4px;\n          background: #6E48AA;\n          position: absolute;\n          bottom: -5px;\n          left: 0;\n          border-radius: 2px;\n        }\n\n        .header-actions {\n          display: flex;\n          align-items: center;\n          gap: 15px;\n        }\n\n        .logout-button {\n          padding: 8px 20px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 25px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .logout-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .chat-layout {\n          display: flex;\n          flex: 1;\n          overflow: hidden;\n        }\n\n        .sidebar {\n          width: 0;\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          padding: 0;\n          border-right: 1px solid rgba(255, 255, 255, 0.1);\n          overflow-y: auto;\n          transition: width 0.3s ease, padding 0.3s ease;\n        }\n\n        .sidebar.open {\n          width: 250px;\n          padding: 20px;\n        }\n\n        .sidebar-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20px;\n        }\n\n        .sidebar-header h3 {\n          font-size: 1.5rem;\n          color: #FFFFFF;\n        }\n\n        .close-menu {\n          background: none;\n          border: none;\n          color: #FFFFFF;\n          font-size: 1.5rem;\n          cursor: pointer;\n          transition: transform 0.3s ease;\n        }\n\n        .close-menu:hover {\n          transform: scale(1.1);\n        }\n\n        .menu-list {\n          list-style: none;\n          padding: 0;\n        }\n\n        .menu-list li {\n          padding: 15px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 10px;\n          margin-bottom: 10px;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .menu-list li:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: translateX(5px);\n        }\n\n        .menu-list li.active {\n          background: #6E48AA;\n          color: #FFFFFF;\n        }\n\n        .chat-content {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          padding: 20px 30px;\n          overflow-y: auto;\n        }\n\n        .doctor-prompt {\n          background: rgba(255, 255, 255, 0.05);\n          padding: 15px;\n          border-radius: 10px;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .doctor-prompt button {\n          padding: 8px 20px;\n          margin: 0 10px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          cursor: pointer;\n          transition: background 0.3s ease;\n        }\n\n        .doctor-prompt button:hover {\n          background: #5A3E8B;\n        }\n\n        .profile-section,\n        .reminders-section,\n        .recommendations-section {\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          padding: 20px;\n          margin-bottom: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .profile-section h3,\n        .reminders-section h3,\n        .recommendations-section h3 {\n          font-size: 1.4rem;\n          font-weight: 600;\n          color: #FFFFFF;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .profile-section h3::before {\n          content: '\ud83d\udc64';\n          font-size: 1.4rem;\n        }\n\n        .reminders-section h3::before {\n          content: '\u23f0';\n          font-size: 1.4rem;\n        }\n\n        .recommendations-section h3::before {\n          content: '\u2695\ufe0f';\n          font-size: 1.4rem;\n        }\n\n        .profile-section p,\n        .reminders-section p,\n        .recommendations-section p {\n          font-size: 1rem;\n          margin-bottom: 10px;\n        }\n\n        .close-section-button {\n          padding: 8px 20px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n          margin-top: 10px;\n        }\n\n        .close-section-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .reminders-table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n\n        .table-header,\n        .table-row {\n          display: flex;\n          justify-content: space-between;\n          padding: 10px;\n          border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .table-header {\n          font-weight: 600;\n          color: #FFFFFF;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 10px 10px 0 0;\n        }\n\n        .table-row {\n          background: rgba(255, 255, 255, 0.05);\n        }\n\n        .table-header span,\n        .table-row span {\n          flex: 1;\n          text-align: center;\n        }\n\n        .table-row span:last-child {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .confirm-button {\n          padding: 5px 10px;\n          background: #27AE60;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 10px;\n          cursor: pointer;\n        }\n\n        .confirm-button:hover {\n          background: #219653;\n        }\n\n        .snooze-button {\n          padding: 5px 10px;\n          background: #F39C12;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 10px;\n          cursor: pointer;\n        }\n\n        .snooze-button:hover {\n          background: #E67E22;\n        }\n\n        .missed-dose-alerts {\n          background: rgba(231, 76, 60, 0.1);\n          border-radius: 10px;\n          padding: 15px;\n          margin-bottom: 20px;\n          border: 1px solid rgba(231, 76, 60, 0.3);\n        }\n\n        .alert-item {\n          background: rgba(231, 76, 60, 0.2);\n          border-radius: 8px;\n          padding: 10px;\n          margin-bottom: 10px;\n          animation: fadeIn 0.5s ease-in-out;\n        }\n\n        .alert-item p {\n          font-size: 1rem;\n          color: #E74C3C;\n        }\n\n        .recommendation-item {\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 10px;\n          padding: 15px;\n          margin-bottom: 10px;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          font-size: 1rem;\n          color: #E0E0E0;\n          flex-wrap: wrap;\n        }\n\n        .recommendation-item strong {\n          color: #FFFFFF;\n        }\n\n        .messages-container {\n          flex: 1;\n          padding: 20px;\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          overflow-y: auto;\n          margin-bottom: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .no-messages {\n          color: #A0A0A0;\n          font-size: 1rem;\n          text-align: center;\n          margin-top: 20px;\n        }\n\n        .message {\n          display: flex;\n          margin-bottom: 20px;\n          max-width: 70%;\n          position: relative;\n        }\n\n        .patient-message {\n          margin-left: auto;\n          justify-content: flex-end;\n        }\n\n        .doctor-message {\n          margin-right: auto;\n          justify-content: flex-start;\n        }\n\n        .message-content {\n          padding: 15px;\n          border-radius: 15px;\n          position: relative;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .patient-message .message-content {\n          background: #6E48AA;\n          color: #FFFFFF;\n          border-bottom-right-radius: 5px;\n        }\n\n        .doctor-message .message-content {\n          background: #4A3270;\n          color: #E0E0E0;\n          border-bottom-left-radius: 5px;\n        }\n\n        .message-content:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);\n        }\n\n        .message-block {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n        }\n\n        .primary-text {\n          margin: 0;\n          font-size: 1rem;\n          line-height: 1.4;\n        }\n\n        .translated-text {\n          font-size: 0.85rem;\n          font-style: italic;\n          color: #B0B0B0;\n          margin: 0;\n        }\n\n        .audio-container {\n          display: flex;\n          flex-direction: column;\n          gap: 5px;\n        }\n\n        .audio-container audio {\n          width: 100%;\n          border-radius: 10px;\n        }\n\n        .download-link {\n          font-size: 0.85rem;\n          color: #6E48AA;\n          text-decoration: none;\n          transition: color 0.3s ease;\n        }\n\n        .download-link:hover {\n          color: #9D50BB;\n          text-decoration: underline;\n        }\n\n        .read-aloud-button {\n          padding: 6px 12px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #FFFFFF;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .read-aloud-button:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: scale(1.05);\n        }\n\n        .validate-button {\n          padding: 6px 12px;\n          background: rgba(39, 174, 96, 0.2);\n          color: #27AE60;\n          border: 1px solid #27AE60;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .validate-button:hover {\n          background: rgba(39, 174, 96, 0.4);\n          transform: scale(1.05);\n        }\n\n        .validation-success {\n          margin-left: 10px;\n          font-size: 0.9rem;\n          color: #27AE60;\n        }\n\n        .validation-error {\n          margin-left: 10px;\n          font-size: 0.9rem;\n          color: #E74C3C;\n        }\n\n        .chat-image {\n          max-width: 100%;\n          border-radius: 10px;\n          margin-top: 10px;\n        }\n\n        .timestamp {\n          font-size: 0.8rem;\n          color: #A0A0A0;\n          margin-top: 8px;\n          display: block;\n        }\n\n        .audio-error {\n          font-size: 0.85rem;\n          color: #E74C3C;\n          margin-top: 5px;\n        }\n\n        .error-message {\n          color: #E74C3C;\n          font-size: 0.9rem;\n          text-align: center;\n          margin-bottom: 20px;\n          animation: shake 0.5s ease;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 10px;\n          background: rgba(231, 76, 60, 0.2);\n          padding: 10px;\n          border-radius: 8px;\n          border: 1px solid rgba(231, 76, 60, 0.3);\n        }\n\n        .retry-button {\n          padding: 6px 12px;\n          background: #F39C12;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .retry-button:hover {\n          background: #E67E22;\n          transform: scale(1.05);\n        }\n\n        .controls {\n          background: rgba(44, 26, 61, 0.8);\n          backdrop-filter: blur(10px);\n          padding: 20px;\n          border-radius: 15px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .language-buttons {\n          display: flex;\n          gap: 10px;\n          margin-bottom: 15px;\n        }\n\n        .language-buttons button {\n          padding: 8px 20px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #E0E0E0;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .language-buttons .active-lang {\n          background: #6E48AA;\n          color: #FFFFFF;\n          border-color: #6E48AA;\n          transform: scale(1.05);\n        }\n\n        .language-buttons button:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: scale(1.05);\n        }\n\n        .recording-buttons {\n          display: flex;\n          gap: 10px;\n          align-items: center;\n          margin-bottom: 15px;\n        }\n\n        .start-button {\n          padding: 8px 20px;\n          background: #27AE60;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .start-button:hover {\n          background: #219653;\n          transform: scale(1.05);\n        }\n        .stop-button {\n          padding: 8px 20px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .stop-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .disabled-button {\n          padding: 8px 20px;\n          background: #666;\n          color: #A0A0A0;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: not-allowed;\n        }\n\n        .image-upload {\n          padding: 8px 20px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #E0E0E0;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .image-upload:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: scale(1.05);\n        }\n\n        .text-input-container {\n          display: flex;\n          gap: 10px;\n          margin-bottom: 15px;\n        }\n\n        .text-input-container input {\n          flex: 1;\n          padding: 12px 20px;\n          background: rgba(255, 255, 255, 0.1);\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 25px;\n          font-size: 1rem;\n          color: #FFFFFF;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .text-input-container input:focus {\n          outline: none;\n          border-color: #6E48AA;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n          background: rgba(255, 255, 255, 0.05);\n        }\n\n        .text-input-container input::placeholder {\n          color: #A0A0A0;\n        }\n\n        .send-button {\n          padding: 12px 30px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 25px;\n          font-size: 1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .send-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .quick-replies {\n          display: flex;\n          gap: 10px;\n          justify-content: center;\n        }\n\n        .quick-replies button {\n          padding: 8px 20px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #E0E0E0;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 20px;\n          font-size: 0.9rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .quick-replies button:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: scale(1.05);\n        }\n\n        @keyframes shake {\n          0%, 100% { transform: translateX(0); }\n          10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }\n          20%, 40%, 60%, 80% { transform: translateX(5px); }\n        }\n\n        @keyframes fadeIn {\n          from { opacity: 0; transform: translateY(-10px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n      "})]})};const Vp=function(e){let{user:n,role:r,handleLogout:i,setError:s}=e;const[o,a]=(0,t.useState)(null),[l,c]=(0,t.useState)(""),[u,d]=(0,t.useState)([]),[h,f]=(0,t.useState)([]),[p,m]=(0,t.useState)([]),[g,v]=(0,t.useState)(""),[y,b]=(0,t.useState)(""),[w,_]=(0,t.useState)({medicine:"",dosage:"",frequency:"",duration:""}),[E,x]=(0,t.useState)(null),[S,k]=(0,t.useState)(!1),[T,C]=(0,t.useState)(!0),[I,A]=(0,t.useState)(!1),[P,N]=(0,t.useState)(null),[R,O]=(0,t.useState)(null),[D,F]=(0,t.useState)(!1),[j,L]=(0,t.useState)(null),[U,M]=(0,t.useState)("en"),[z,V]=(0,t.useState)(!1),[B,$]=(0,t.useState)(null),[q,H]=(0,t.useState)(!1),[K,W]=(0,t.useState)(""),[G,Q]=(0,t.useState)({}),[J,Y]=(0,t.useState)({}),Z=(0,t.useRef)(new Audio),ee=(0,t.useRef)(null),te=(0,t.useRef)([]),ne=(0,t.useRef)(null),re=X(),ie={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api",se=(0,t.useCallback)((()=>{var e;null===(e=ee.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[]);(0,t.useEffect)((()=>{se()}),[h,se]),(0,t.useEffect)((()=>{if("doctor"!==r||null===n||void 0===n||!n.uid)return s("Please log in as a doctor."),void re("/login",{replace:!0});(async()=>{try{const e=Mu(eu(kp,"doctors"),Vu("uid","==",n.uid)),t=await td(e);if(t.empty)return s("Doctor profile not found."),void C(!1);const r=t.docs[0].data();O(r.doctorId),$({name:r.name||"N/A",doctorId:r.doctorId||"N/A",email:r.email||"N/A"})}catch(e){s(`Failed to fetch doctor profile: ${e.message}`),C(!1)}})()}),[r,null===n||void 0===n?void 0:n.uid,re,s]),(0,t.useEffect)((()=>{if(!R)return;C(!0);const e=od(Mu(eu(kp,"doctor_assignments"),Vu("doctorId","==",R)),(e=>{const t=e.docs.map((e=>({patientId:e.data().patientId,doctorId:e.data().doctorId,timestamp:e.data().timestamp,patientName:e.data().patientName||`Patient ${e.data().patientId}`,age:e.data().age||"N/A",sex:e.data().sex||"N/A"})));d(t),C(!1),!o&&t.length>0&&(a(t[0].patientId),c(t[0].patientName))}),(e=>{s(`Failed to fetch patients: ${e.message}`),C(!1)}));return()=>e()}),[R,o,s]),(0,t.useEffect)((()=>{if(!R)return;(async()=>{try{const e=tu(kp,"doctor_accepted_patients",R),t=await Zu(e);t.exists()&&Y(t.data().accepted||{})}catch(e){console.error("Failed to fetch accepted patients:",e.message),s(`Failed to fetch accepted patients: ${e.message}`)}})()}),[R,s]),(0,t.useEffect)((()=>{if(!o||null===n||void 0===n||!n.uid||!R)return;const e=new Ap({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_PUSHER_APP_ID||"2ed44c3ce3ef227d9924",{cluster:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_PUSHER_CLUSTER||"ap2",authEndpoint:`${ie}/pusher/auth`,auth:{headers:{"x-user-uid":n.uid}}}),t=e.subscribe(`chat-${o}-${R}`);t.bind("new-message",(e=>{f((t=>{if(!t.some((t=>t.timestamp===e.timestamp&&t.text===e.text))){const n=[...t,e].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)));return"patient"===e.sender&&Q((t=>{var n;return{...t,[e.patientId]:{firstMessageTime:(null===(n=t[e.patientId])||void 0===n?void 0:n.firstMessageTime)||e.timestamp,lastMessageTime:e.timestamp}}})),n}return t}))})),t.bind("missedDoseAlert",(e=>{e.patientId===o&&m((t=>[...t,{...e,id:Date.now().toString()}]))}));return(async()=>{k(!0);try{const e=await fetch(`${ie}/chats/${o}/${R}`,{headers:{"x-user-uid":n.uid},credentials:"include"});if(!e.ok){const t=await e.text();throw new Error(`HTTP ${e.status}: ${t||"Failed to fetch messages"}`)}const t=(await e.json()).messages||[];f(t.sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))));const r=t.filter((e=>"patient"===e.sender));r.length>0&&Q((e=>({...e,[o]:{firstMessageTime:r[0].timestamp,lastMessageTime:r[r.length-1].timestamp}})))}catch(e){s(`Error fetching messages: ${e.message}`),console.error("Fetch messages error:",e)}finally{k(!1)}})(),(async()=>{try{const e=tu(kp,"patients",o),t=await Zu(e);M(t.exists()&&t.data().languagePreference||"en")}catch(e){s(`Failed to fetch language preference: ${e.message}`)}})(),(async()=>{try{const e=await fetch(`${ie}/admin`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({patientId:o,doctorId:R}),credentials:"include"});if(!e.ok){const t=await e.text();throw new Error(`HTTP ${e.status}: ${t||"Failed to fetch alerts"}`)}const t=(await e.json()).alerts||[];if(!Array.isArray(t))throw new Error("Invalid response format: Expected an array of notifications");m(t.filter((e=>e.patientId===o)).map((e=>({...e,id:e.id||Date.now().toString()}))))}catch(e){s(`Failed to fetch alerts: ${e.message}`),console.error("Fetch alerts error:",e)}})(),()=>{e.unsubscribe(`chat-${o}-${R}`),e.disconnect(),ne.current&&ne.current.getTracks().forEach((e=>e.stop()))}}),[o,null===n||void 0===n?void 0:n.uid,R,ie,s]),(0,t.useEffect)((()=>{if(!o||!u.length)return;const e=u.find((e=>e.patientId===o));if(!e)return;const t=G[o],n=new Date,r=(n-new Date(e.timestamp))/36e5;if(J[o]){const e=null!==t&&void 0!==t&&t.lastMessageTime?new Date(t.lastMessageTime):null;return void N((e?(n-e)/36e5:1/0)>=168?o:null)}if(!t||!t.firstMessageTime)return void N(r<=24?o:null);const i=(n-new Date(t.firstMessageTime))/36e5,s=(n-new Date(t.lastMessageTime))/36e5;N(i<=24||s>=168?o:null)}),[o,u,G,J]);const oe=(0,t.useCallback)((async e=>{if(o)if(e)try{const e=tu(kp,"doctor_accepted_patients",R);await nd(e,{accepted:{...J,[o]:!0}},{merge:!0}),Y((e=>({...e,[o]:!0}))),N(null)}catch(t){s(`Failed to accept patient: ${t.message}`),console.error("Accept patient error:",t)}else{const e={sender:"doctor",text:"Sorry, I am not available at the moment. Please chat with another doctor.",translatedText:"kn"===U?await Dp("Sorry, I am not available at the moment. Please chat with another doctor.","en","kn"):null,language:"en",recordingLanguage:"en",timestamp:(new Date).toISOString(),doctorId:R,patientId:o};try{const t=await fetch(`${ie}/chats/${o}/${R}`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({message:e,append:!0}),credentials:"include"});if(!t.ok)throw new Error(`HTTP ${t.status}: ${await t.text()}`);d((e=>e.filter((e=>e.patientId!==o)))),a(null),c(""),N(null)}catch(t){s(`Failed to send message: ${t.message}`),console.error("Diagnosis decision error:",t)}}else s("No patient selected.")}),[o,U,R,n.uid,ie,J,s]),ae=((0,t.useCallback)((async(e,t)=>{try{x(null),A(!0);const r=await Op(e,t,n.uid);return r.audioUrl?r:(s("Transcription succeeded, but no audio URL was returned."),null)}catch(r){return s(`Failed to transcribe audio: ${r.message}`),x({audioBlob:e,language:t}),console.error("Retry upload error:",r),null}finally{A(!1)}}),[n.uid,s]),(0,t.useCallback)((async()=>{if(o)try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});ne.current=e;const t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});L(t),te.current=[],t.ondataavailable=e=>e.data.size>0&&te.current.push(e.data),t.onstop=async()=>{const e=new Blob(te.current,{type:"audio/webm"});if(0===e.size)return s("Recorded audio is empty."),void A(!1);let t,r;A(!0);let i,a,l=null,c=null;try{if(t=await Op(e,"en-US",n.uid),i=t.audioUrl,!i)return s("Transcription succeeded, but no audio URL was returned."),void A(!1);r=t.transcription||"Transcription failed",a=await Fp(r,"en-US"),"kn"===U&&(l=await Dp(r,"en","kn"),c=await Fp(l,"kn-IN"))}catch(d){return s(`Failed to process audio: ${d.message}`),x({audioBlob:e,language:"en-US"}),A(!1),void console.error("Audio processing error:",d)}const u={sender:"doctor",text:r,translatedText:l,language:"en",recordingLanguage:"en",audioUrl:i,audioUrlEn:a,audioUrlKn:c,timestamp:(new Date).toISOString(),doctorId:R,patientId:o};try{const e=await fetch(`${ie}/chats/${o}/${R}`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({message:u,append:!0}),credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${await e.text()}`);f((e=>e.some((e=>e.timestamp===u.timestamp&&e.text===u.text))?e:[...e,u].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp)))))}catch(d){s(`Failed to send message: ${d.message}`),console.error("Send message error:",d)}finally{A(!1)}},t.start(),F(!0)}catch(e){s(`Failed to start recording: ${e.message}`),console.error("Recording error:",e)}else s("No patient selected.")}),[o,U,n.uid,ie,R,s])),le=(0,t.useCallback)((()=>{var e;j&&(j.stop(),F(!1),null===(e=ne.current)||void 0===e||e.getTracks().forEach((e=>e.stop())))}),[j]),ce=(0,t.useCallback)((async()=>{if(!g.trim()||!o||null===n||void 0===n||!n.uid||!R)return void s("Please type a message and select a patient.");A(!0);let e,t=null,r=null;try{e=await Fp(g,"en-US"),"kn"===U&&(t=await Dp(g,"en","kn"),r=await Fp(t,"kn-IN"));const i={sender:"doctor",text:g,translatedText:t,language:"en",recordingLanguage:"en",audioUrl:null,audioUrlEn:e,audioUrlKn:r,timestamp:(new Date).toISOString(),doctorId:R,patientId:o},s=await fetch(`${ie}/chats/${o}/${R}`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({message:i,append:!0}),credentials:"include"});if(!s.ok)throw new Error(`HTTP ${s.status}: ${await s.text()}`);f((e=>e.some((e=>e.timestamp===i.timestamp&&e.text===i.text))?e:[...e,i].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))))),v("")}catch(i){s(`Failed to send message: ${i.message}`),console.error("Send message error:",i)}finally{A(!1)}}),[g,o,null===n||void 0===n?void 0:n.uid,R,U,ie,s]),ue=(0,t.useCallback)((async()=>{if(!o||!R)return void s("No patient selected or doctor ID missing.");if("Diagnosis"===K&&!y.trim())return void s("Please enter a diagnosis.");if("Prescription"===K){const{medicine:e,dosage:t,frequency:n,duration:r}=w;if(!e.trim()||!t.trim()||!n.trim()||!r.trim())return void s("Please fill all prescription fields.");const i=h.filter((e=>"doctor"===e.sender&&e.diagnosis)).sort(((e,t)=>t.timestamp.localeCompare(e.timestamp)))[0];if(!i)return void s("Please provide a diagnosis first.")}if("Combined"===K&&(!y.trim()||!Object.values(w).every((e=>e.trim()))))return void s("Please fill all diagnosis and prescription fields.");const e="Prescription"===K||"Combined"===K?`${w.medicine}, ${w.dosage}, ${w.frequency}, ${w.duration}`:void 0,t={sender:"doctor",..."Diagnosis"===K||"Combined"===K?{diagnosis:y}:{},..."Prescription"===K||"Combined"===K?{prescription:{...w}}:{},timestamp:(new Date).toISOString(),doctorId:R,patientId:o};try{var r;const i=await fetch(`${ie}/chats/${o}/${R}`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({message:t,append:!0}),credentials:"include"});if(!i.ok)throw new Error(`HTTP ${i.status}: ${await i.text()}`);f((e=>e.some((e=>e.timestamp===t.timestamp))?e:[...e,t].sort(((e,t)=>e.timestamp.localeCompare(t.timestamp))))),await fetch(`${ie}/patients/${o}`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({..."Diagnosis"===K||"Combined"===K?{diagnosis:y}:{},..."Prescription"===K||"Combined"===K?{prescription:e}:{},doctorId:R}),credentials:"include"});const s=u.find((e=>e.patientId===o)),a="Prescription"===K?null===(r=h.filter((e=>"doctor"===e.sender&&e.diagnosis)).sort(((e,t)=>t.timestamp.localeCompare(e.timestamp)))[0])||void 0===r?void 0:r.diagnosis:y,c=await fetch(`${ie}/admin`,{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":n.uid},body:JSON.stringify({patientId:o,patientName:l,age:(null===s||void 0===s?void 0:s.age)||"N/A",sex:(null===s||void 0===s?void 0:s.sex)||"N/A",description:"N/A",disease:a||"N/A",medicine:"Prescription"===K||"Combined"===K?e:void 0,doctorId:R}),credentials:"include"});if(!c.ok)throw new Error(`HTTP ${c.status}: ${await c.text()}`);b(""),_({medicine:"",dosage:"",frequency:"",duration:""}),H(!1),W("")}catch(i){s(`Failed to send action: ${i.message}`),console.error("Send action error:",i)}}),[K,y,w,o,R,n.uid,l,u,h,ie,s]),de=(0,t.useCallback)((async(e,t,n)=>{try{if(!e&&(!n||"string"!==typeof n||""===n.trim()))return void s("Cannot read aloud: No valid audio or text provided.");const r="kn"===t?"kn-IN":"en-US",i=e||await Fp(n.trim(),r);Z.current.src=i,Z.current.play()}catch(r){s(`Failed to read aloud: ${r.message}`),console.error("Read aloud error:",r)}}),[s]),he=(0,t.useCallback)((e=>{m((t=>t.filter((t=>t.id!==e))))}),[]),fe=((0,t.useCallback)((()=>{s(""),x(null)}),[s]),(0,t.useCallback)((e=>e&&e.medicine&&e.dosage&&e.frequency&&e.duration),[])),pe=(0,t.useCallback)((async()=>{try{await i(),re("/login",{replace:!0})}catch(e){s(`Failed to log out: ${e.message}`),console.error("Logout error:",e)}}),[i,re,s]),me=(0,t.useMemo)((()=>(0,Tp.jsx)("ul",{className:"patient-list",children:u.map((e=>(0,Tp.jsxs)("li",{className:"patient-item "+(o===e.patientId?"selected":""),onClick:()=>{a(e.patientId),c(e.patientName),m([]),V(!1)},tabIndex:0,role:"button","aria-label":`Select patient ${e.patientName}`,children:[(0,Tp.jsx)("span",{children:e.patientName}),(0,Tp.jsx)("small",{children:new Date(e.timestamp).toLocaleDateString()})]},e.patientId)))})),[u,o]);return(0,Tp.jsxs)("div",{className:"doctor-chat-container",children:[(0,Tp.jsxs)("div",{className:"chat-header",children:[(0,Tp.jsx)("button",{className:"hamburger-button",onClick:()=>V(!z),"aria-label":"Toggle patient menu",children:"\u2630"}),(0,Tp.jsx)("h2",{children:o?`Chat with ${l}`:"Doctor Dashboard"}),(0,Tp.jsxs)("div",{className:"header-actions",children:[(0,Tp.jsx)("button",{onClick:()=>$(B),className:"profile-button","aria-label":"View doctor profile",children:"Profile"}),(0,Tp.jsx)("button",{onClick:pe,className:"logout-button","aria-label":"Log out",children:"Logout"})]})]}),(0,Tp.jsxs)("div",{className:"chat-layout",children:[(0,Tp.jsxs)("div",{className:"patient-sidebar "+(z?"open":""),children:[(0,Tp.jsxs)("div",{className:"sidebar-header",children:[(0,Tp.jsx)("h3",{children:"Assigned Patients"}),(0,Tp.jsx)("button",{className:"close-menu",onClick:()=>V(!1),"aria-label":"Close patient menu",children:"\u2715"})]}),T?(0,Tp.jsx)("p",{className:"loading-text",children:"Loading..."}):0===u.length?(0,Tp.jsx)("p",{className:"no-patients",children:"No patients assigned."}):me]}),(0,Tp.jsxs)("div",{className:"chat-content",children:[B&&(0,Tp.jsxs)("div",{className:"doctor-profile",children:[(0,Tp.jsx)("h3",{children:"Doctor Profile"}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Name:"})," ",B.name]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Doctor ID:"})," ",B.doctorId]}),(0,Tp.jsxs)("p",{children:[(0,Tp.jsx)("strong",{children:"Email:"})," ",B.email]}),(0,Tp.jsx)("button",{onClick:()=>$(null),className:"close-section-button","aria-label":"Close profile",children:"Close"})]}),o?P===o?(0,Tp.jsxs)("div",{className:"diagnosis-prompt",children:[(0,Tp.jsxs)("h3",{children:["Chat with ",l]}),(0,Tp.jsxs)("p",{children:[(()=>{const e=G[o];if(!e||!e.firstMessageTime)return"New patient (within 24 hours). ";return(new Date-new Date(e.lastMessageTime))/36e5>=168?"Last chat over 7 days ago. ":"New message from patient. "})(),"Chat now?"]}),(0,Tp.jsxs)("div",{className:"prompt-buttons",children:[(0,Tp.jsx)("button",{onClick:()=>oe(!0),className:"accept-button","aria-label":"Accept chat",children:"Yes"}),(0,Tp.jsx)("button",{onClick:()=>oe(!1),className:"decline-button","aria-label":"Decline chat",children:"No"})]})]}):(0,Tp.jsxs)("div",{className:"chat-main",children:[p.length>0&&(0,Tp.jsxs)("div",{className:"missed-dose-alerts",children:[(0,Tp.jsx)("h3",{children:"Missed Dose Alerts"}),p.map((e=>(0,Tp.jsxs)("div",{className:"alert-item",children:[(0,Tp.jsx)("p",{children:e.message||"Patient missed doses."}),(0,Tp.jsx)("button",{onClick:()=>he(e.id),className:"dismiss-button","aria-label":"Dismiss alert",children:"Dismiss"})]},e.id)))]}),(0,Tp.jsxs)("div",{className:"messages-container",children:[S?(0,Tp.jsx)("p",{className:"loading-text",children:"Loading messages..."}):0===h.length?(0,Tp.jsx)("p",{className:"no-messages",children:"No messages yet."}):h.map(((e,t)=>(0,Tp.jsx)("div",{className:"message "+("doctor"===e.sender?"doctor-message":"patient-message"),children:(0,Tp.jsxs)("div",{className:"message-content",children:["patient"===e.sender&&(0,Tp.jsx)("div",{className:"message-block",children:"en"===U?(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}),e.audioUrl&&(0,Tp.jsx)("div",{className:"audio-container",children:(0,Tp.jsxs)("audio",{controls:!0,"aria-label":"Patient audio message",children:[(0,Tp.jsx)("source",{src:e.audioUrl,type:"audio/webm"}),"Your browser does not support the audio element."]})}),e.audioUrlEn&&(0,Tp.jsx)("div",{className:"read-aloud-buttons",children:(0,Tp.jsx)("button",{onClick:()=>de(e.audioUrlEn,"en",e.text),className:"read-aloud-button","aria-label":"Read aloud in English",children:"\ud83d\udd0a (English)"})}),e.audioUrl&&(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]}):(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.text||"No transcription"}),e.translatedText&&(0,Tp.jsxs)("p",{className:"translated-text",children:["English: ",e.translatedText]}),e.audioUrl&&(0,Tp.jsx)("div",{className:"audio-container",children:(0,Tp.jsxs)("audio",{controls:!0,"aria-label":"Patient audio message",children:[(0,Tp.jsx)("source",{src:e.audioUrl,type:"audio/webm"}),"Your browser does not support the audio element."]})}),(e.audioUrlEn||e.audioUrlKn)&&(0,Tp.jsxs)("div",{className:"read-aloud-buttons",children:[e.audioUrlKn&&(0,Tp.jsx)("button",{onClick:()=>de(e.audioUrlKn,"kn",e.text),className:"read-aloud-button","aria-label":"Read aloud in Kannada",children:"\ud83d\udd0a (Kannada)"}),e.audioUrlEn&&(0,Tp.jsx)("button",{onClick:()=>de(e.audioUrlEn,"en",e.translatedText||e.text),className:"read-aloud-button","aria-label":"Read aloud in English",children:"\ud83d\udd0a (English)"})]}),e.audioUrl&&(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]})}),"doctor"===e.sender&&(0,Tp.jsxs)("div",{className:"message-block",children:[e.text&&(0,Tp.jsxs)(Tp.Fragment,{children:["kn"===U?(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("p",{className:"primary-text",children:e.translatedText||e.text}),(0,Tp.jsxs)("p",{className:"translated-text",children:["English: ",e.text]})]}):(0,Tp.jsx)("p",{className:"primary-text",children:e.text}),e.audioUrl&&(0,Tp.jsx)("div",{className:"audio-container",children:(0,Tp.jsxs)("audio",{controls:!0,"aria-label":"Doctor audio message",children:[(0,Tp.jsx)("source",{src:e.audioUrl,type:"audio/webm"}),"Your browser does not support the audio element."]})}),(e.audioUrlEn||e.audioUrlKn)&&(0,Tp.jsxs)("div",{className:"read-aloud-buttons",children:[e.audioUrlKn&&"kn"===U&&(0,Tp.jsx)("button",{onClick:()=>de(e.audioUrlKn,"kn",e.translatedText||e.text),className:"read-aloud-button","aria-label":"Read aloud in Kannada",children:"\ud83d\udd0a (Kannada)"}),e.audioUrlEn&&(0,Tp.jsx)("button",{onClick:()=>de(e.audioUrlEn,"en",e.text),className:"read-aloud-button","aria-label":"Read aloud in English",children:"\ud83d\udd0a (English)"})]}),e.audioUrl&&(0,Tp.jsx)("a",{href:e.audioUrl,download:!0,className:"download-link",children:"Download Audio"})]}),(e.diagnosis||e.prescription)&&(0,Tp.jsxs)("div",{className:"recommendation-item",children:[e.diagnosis?(0,Tp.jsxs)("div",{children:[(0,Tp.jsx)("strong",{children:"Diagnosis:"})," ",e.diagnosis,(0,Tp.jsx)("button",{onClick:()=>de(null,"en",e.diagnosis),className:"read-aloud-button","aria-label":"Read diagnosis aloud",children:"\ud83d\udd0a"})]}):(0,Tp.jsx)("p",{className:"missing-field",children:"Diagnosis not provided."}),e.prescription&&fe(e.prescription)?(0,Tp.jsxs)("div",{children:[(0,Tp.jsx)("strong",{children:"Prescription:"})," ",`${e.prescription.medicine}, ${e.prescription.dosage}, ${e.prescription.frequency}, ${e.prescription.duration}`]}):(0,Tp.jsx)("p",{className:"missing-field",children:"Prescription not provided."})]})]}),(0,Tp.jsx)("span",{className:"timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]})},`${e.timestamp}-${t}`))),(0,Tp.jsx)("div",{ref:ee})]}),(0,Tp.jsxs)("div",{className:"controls",children:[(0,Tp.jsxs)("div",{className:"recording-buttons",children:[(0,Tp.jsx)("button",{onClick:ae,disabled:D||I,className:D||I?"disabled-button":"start-button","aria-label":"Start recording",children:"\ud83c\udf99\ufe0f Record"}),(0,Tp.jsx)("button",{onClick:le,disabled:!D,className:D?"stop-button":"disabled-button","aria-label":"Stop recording",children:"\ud83d\uded1 Stop"}),(0,Tp.jsx)("button",{onClick:()=>H(!0),className:"action-button","aria-label":"Open diagnosis/prescription modal",children:"\u2695\ufe0f Diagnosis/Prescription"})]}),(0,Tp.jsxs)("div",{className:"text-input-container",children:[(0,Tp.jsx)("input",{type:"text",value:g,onChange:e=>v(e.target.value),placeholder:"Type a message (English only)...",onKeyPress:e=>"Enter"===e.key&&ce(),"aria-label":"Type a message to the patient",disabled:I}),(0,Tp.jsx)("button",{onClick:ce,className:"send-button",disabled:I,"aria-label":"Send message",children:"Send"})]})]})]}):(0,Tp.jsx)("div",{className:"no-patient-selected",children:(0,Tp.jsx)("p",{children:"Select a patient to start chatting."})})]})]}),q&&(0,Tp.jsx)("div",{className:"action-modal",children:(0,Tp.jsxs)("div",{className:"modal-content",children:[(0,Tp.jsx)("h3",{children:K?`${K} Entry`:"Select an Action"}),(0,Tp.jsxs)("div",{className:"action-type-selection",children:[(0,Tp.jsxs)("select",{value:K,onChange:e=>W(e.target.value),"aria-label":"Select action type (Diagnosis, Prescription, or Combined)",children:[(0,Tp.jsx)("option",{value:"",children:"Select an action..."}),(0,Tp.jsx)("option",{value:"Diagnosis",children:"Diagnosis Only"}),(0,Tp.jsx)("option",{value:"Prescription",children:"Prescription Only"}),(0,Tp.jsx)("option",{value:"Combined",children:"Diagnosis and Prescription"})]}),("Diagnosis"===K||"Combined"===K)&&(0,Tp.jsx)("textarea",{value:y,onChange:e=>b(e.target.value),placeholder:"Enter diagnosis...","aria-label":"Enter patient diagnosis"}),("Prescription"===K||"Combined"===K)&&(0,Tp.jsxs)(Tp.Fragment,{children:[(0,Tp.jsx)("input",{type:"text",value:w.medicine,onChange:e=>_({...w,medicine:e.target.value}),placeholder:"Medicine (e.g., Paracetamol)","aria-label":"Enter medicine name"}),(0,Tp.jsx)("input",{type:"text",value:w.dosage,onChange:e=>_({...w,dosage:e.target.value}),placeholder:"Dosage (e.g., 500mg)","aria-label":"Enter dosage"}),(0,Tp.jsx)("input",{type:"text",value:w.frequency,onChange:e=>_({...w,frequency:e.target.value}),placeholder:"Frequency (e.g., 08:00 AM and 06:00 PM)","aria-label":"Enter dosage frequency"}),(0,Tp.jsx)("input",{type:"text",value:w.duration,onChange:e=>_({...w,duration:e.target.value}),placeholder:"Duration (e.g., 3 days)","aria-label":"Enter prescription duration"})]})]}),(0,Tp.jsxs)("div",{className:"modal-buttons",children:[K&&(0,Tp.jsxs)("button",{onClick:ue,className:"submit-button","aria-label":`Submit ${K}`,children:["Send ",K]}),(0,Tp.jsx)("button",{onClick:()=>{H(!1),W(""),b(""),_({medicine:"",dosage:"",frequency:"",duration:""})},className:"close-modal","aria-label":"Close modal",children:"Close"})]})]})}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n\n        .doctor-chat-container {\n          width: 100vw;\n          height: 100vh;\n          display: flex;\n          flex-direction: column;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          font-family: 'Poppins', sans-serif;\n          color: #E0E0E0;\n          overflow: hidden;\n        }\n\n        .chat-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 15px 30px;\n          background: rgba(44, 26, 61, 0.8);\n          backdrop-filter: blur(10px);\n          border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .hamburger-button {\n          background: none;\n          border: none;\n          color: #FFFFFF;\n          font-size: 1.8rem;\n          cursor: pointer;\n          transition: transform 0.3s ease;\n        }\n\n        .hamburger-button:hover {\n          transform: scale(1.1);\n        }\n\n        .chat-header h2 {\n          font-size: 1.8rem;\n          font-weight: 600;\n          color: #FFFFFF;\n        }\n\n        .header-actions {\n          display: flex;\n          align-items: center;\n          gap: 15px;\n        }\n\n        .profile-button {\n          padding: 8px 20px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 25px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .profile-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .logout-button {\n          padding: 8px 20px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 25px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .logout-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .chat-layout {\n          display: flex;\n          flex: 1;\n          overflow: hidden;\n        }\n\n        .patient-sidebar {\n          width: 0;\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          padding: 0;\n          border-right: 1px solid rgba(255, 255, 255, 0.1);\n          overflow-y: auto;\n          transition: width 0.3s ease, padding 0.3s ease;\n        }\n\n        .patient-sidebar.open {\n          width: 250px;\n          padding: 20px;\n        }\n\n        .sidebar-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20px;\n        }\n\n        .sidebar-header h3 {\n          font-size: 1.5rem;\n          color: #FFFFFF;\n        }\n\n        .close-menu {\n          background: none;\n          border: none;\n          color: #FFFFFF;\n          font-size: 1.5rem;\n          cursor: pointer;\n          transition: transform 0.3s ease;\n        }\n\n        .close-menu:hover {\n          transform: scale(1.1);\n        }\n\n        .loading-text,\n        .no-patients {\n          color: #A0A0A0;\n          font-size: 1rem;\n          text-align: center;\n          margin-top: 20px;\n        }\n\n        .patient-list {\n          list-style: none;\n        }\n\n        .patient-item {\n          padding: 15px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 10px;\n          margin-bottom: 10px;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .patient-item:hover,\n        .patient-item:focus {\n          background: rgba(255, 255, 255, 0.2);\n          transform: translateX(5px);\n        }\n\n        .patient-item.selected {\n          background: #6E48AA;\n          color: #FFFFFF;\n        }\n\n        .patient-item span {\n          font-size: 1rem;\n          font-weight: 500;\n        }\n\n        .patient-item small {\n          display: block;\n          font-size: 0.8rem;\n          color: #B0B0B0;\n          margin-top: 5px;\n        }\n\n        .chat-content {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          padding: 20px 30px;\n          overflow-y: auto;\n        }\n\n        .doctor-profile {\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          padding: 20px;\n          margin-bottom: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .doctor-profile h3 {\n          font-size: 1.4rem;\n          font-weight: 600;\n          color: #FFFFFF;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .doctor-profile h3::before {\n          content: '\ud83d\udc68\u200d\u2695\ufe0f';\n          font-size: 1.4rem;\n        }\n\n        .doctor-profile p {\n          font-size: 1rem;\n          margin-bottom: 10px;\n        }\n\n        .close-section-button {\n          padding: 8px 20px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n          margin-top: 10px;\n        }\n\n        .close-section-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .diagnosis-prompt {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          padding: 30px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .diagnosis-prompt h3 {\n          font-size: 1.5rem;\n          color: #FFFFFF;\n          margin-bottom: 20px;\n        }\n\n        .diagnosis-prompt p {\n          font-size: 1.2rem;\n          color: #E0E0E0;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .prompt-buttons {\n          display: flex;\n          gap: 15px;\n        }\n\n        .accept-button {\n          padding: 10px 25px;\n          background: #27AE60;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .accept-button:hover {\n          background: #219653;\n          transform: scale(1.05);\n        }\n\n        .decline-button {\n          padding: 10px 25px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .decline-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .chat-main {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n        }\n\n        .missed-dose-alerts {\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          padding: 20px;\n          margin-bottom: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .missed-dose-alerts h3 {\n          font-size: 1.4rem;\n          font-weight: 600;\n          color: #E74C3C;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .missed-dose-alerts h3::before {\n          content: '\u26a0\ufe0f';\n          font-size: 1.4rem;\n        }\n\n        .alert-item {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          background: rgba(231, 76, 60, 0.1);\n          padding: 15px;\n          border-radius: 10px;\n          margin-bottom: 10px;\n        }\n\n        .alert-item p {\n          font-size: 1rem;\n          color: #E0E0E0;\n        }\n\n        .dismiss-button {\n          padding: 6px 12px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .dismiss-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .messages-container {\n          flex: 1;\n          padding: 20px;\n          background: rgba(255, 255, 255, 0.05);\n          backdrop-filter: blur(10px);\n          border-radius: 15px;\n          overflow-y: auto;\n          margin-bottom: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .no-messages,\n        .loading-text {\n          color: #A0A0A0;\n          font-size: 1rem;\n          text-align: center;\n          margin-top: 20px;\n        }\n\n        .message {\n          display: flex;\n          margin-bottom: 20px;\n          max-width: 70%;\n          position: relative;\n        }\n\n        .patient-message {\n          margin-left: auto;\n          justify-content: flex-end;\n        }\n\n        .doctor-message {\n          margin-right: auto;\n          justify-content: flex-start;\n        }\n\n        .message-content {\n          padding: 15px;\n          border-radius: 15px;\n          position: relative;\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .patient-message .message-content {\n          background: #6E48AA;\n          color: #FFFFFF;\n          border-bottom-right-radius: 5px;\n        }\n\n        .doctor-message .message-content {\n          background: #4A3270;\n          color: #E0E0E0;\n          border-bottom-left-radius: 5px;\n        }\n\n        .message-content:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);\n        }\n\n        .message-block {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n        }\n\n        .primary-text {\n          margin: 0;\n          font-size: 1rem;\n          line-height: 1.4;\n        }\n\n        .translated-text {\n          font-size: 0.85rem;\n          font-style: italic;\n          color: #B0B0B0;\n          margin: 0;\n        }\n\n        .audio-container {\n          display: flex;\n          flex-direction: column;\n          gap: 5px;\n        }\n\n        .audio-container audio {\n          width: 100%;\n          border-radius: 10px;\n        }\n\n        .download-link {\n          font-size: 0.85rem;\n          color: #6E48AA;\n          text-decoration: none;\n          transition: color 0.3s ease;\n        }\n\n        .download-link:hover {\n          color: #9D50BB;\n          text-decoration: underline;\n        }\n\n        .read-aloud-buttons {\n          display: flex;\n          gap: 10px;\n        }\n\n        .read-aloud-button {\n          padding: 6px 12px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #FFFFFF;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .read-aloud-button:hover {\n          background: rgba(255, 255, 255, 0.2);\n          transform: scale(1.05);\n        }\n\n        .recommendation-item {\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 10px;\n          padding: 15px;\n          margin-bottom: 10px;\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n          font-size: 1rem;\n          color: #E0E0E0;\n        }\n\n        .recommendation-item div {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          flex-wrap: wrap;\n        }\n\n        .recommendation-item strong {\n          color: #FFFFFF;\n        }\n\n        .missing-field {\n          color: #E74C3C;\n          font-style: italic;\n        }\n\n        .timestamp {\n          font-size: 0.8rem;\n          color: #A0A0A0;\n          margin-top: 8px;\n          display: block;\n        }\n\n        .retry-button {\n          padding: 6px 12px;\n          background: #F39C12;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .retry-button:hover {\n          background: #E67E22;\n          transform: scale(1.05);\n        }\n\n        .dismiss-error-button {\n          padding: 6px 12px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.9rem;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .dismiss-error-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .loading-audio {\n          color: #6E48AA;\n          font-size: 0.9rem;\n          text-align: center;\n          margin-bottom: 20px;\n        }\n\n        .controls {\n          background: rgba(44, 26, 61, 0.8);\n          backdrop-filter: blur(10px);\n          padding: 20px;\n          border-radius: 15px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .recording-buttons {\n          display: flex;\n          gap: 10px;\n          align-items: center;\n          margin-bottom: 15px;\n        }\n\n        .start-button {\n          padding: 8px 20px;\n          background: #27AE60;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .start-button:hover {\n          background: #219653;\n          transform: scale(1.05);\n        }\n\n        .stop-button {\n          padding: 8px 20px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .stop-button:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        .action-button {\n          padding: 8px 20px;\n          background: #F39C12;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .action-button:hover {\n          background: #E67E22;\n          transform: scale(1.05);\n        }\n\n        .disabled-button {\n          padding: 8px 20px;\n          background: #666;\n          color: #A0A0A0;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: not-allowed;\n        }\n\n        .text-input-container {\n          display: flex;\n          gap: 10px;\n        }\n\n        .text-input-container input {\n          flex: 1;\n          padding: 12px 20px;\n          background: rgba(255, 255, 255, 0.1);\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 25px;\n          font-size: 1rem;\n          color: #FFFFFF;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .text-input-container input:disabled {\n          background: rgba(255, 255, 255, 0.05);\n          color: #A0A0A0;\n          cursor: not-allowed;\n        }\n\n        .text-input-container input:focus {\n          outline: none;\n          border-color: #6E48AA;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n        }\n\n        .text-input-container input::placeholder {\n          color: #A0A0A0;\n        }\n\n        .send-button {\n          padding: 12px 30px;\n          background: #6E48AA;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 25px;\n          font-size: 1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .send-button:hover {\n          background: #5A3E8B;\n          transform: scale(1.05);\n        }\n\n        .send-button:disabled {\n          background: #666;\n          color: #A0A0A0;\n          cursor: not-allowed;\n        }\n\n        .no-patient-selected {\n          flex: 1;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          color: #A0A0A0;\n          font-size: 1.2rem;\n        }\n\n        .action-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          z-index: 1000;\n        }\n\n        .modal-content {\n          background: rgba(44, 26, 61, 0.95);\n          backdrop-filter: blur(10px);\n          padding: 30px;\n          border-radius: 15px;\n          width: 450px;\n          max-width: 90%;\n          display: flex;\n          flex-direction: column;\n          gap: 20px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .modal-content h3 {\n          font-size: 1.5rem;\n          color: #FFFFFF;\n          margin-bottom: 10px;\n        }\n\n        .action-type-selection {\n          display: flex;\n          flex-direction: column;\n          gap: 15px;\n        }\n\n        .modal-content select,\n        .modal-content input,\n        .modal-content textarea {\n          width: 100%;\n          padding: 12px;\n          background: rgba(255, 255, 255, 0.1);\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 10px;\n          color: #FFFFFF;\n          font-size: 1rem;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .modal-content select:focus,\n        .modal-content input:focus,\n        .modal-content textarea:focus {\n          outline: none;\n          border-color: #6E48AA;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n        }\n\n        .modal-content textarea {\n          min-height: 100px;\n          resize: none;\n        }\n\n        .modal-buttons {\n          display: flex;\n          gap: 15px;\n          justify-content: center;\n        }\n\n        .submit-button {\n          padding: 10px 20px;\n          background: #27AE60;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .submit-button:hover {\n          background: #219653;\n          transform: scale(1.05);\n        }\n\n        .close-modal {\n          padding: 10px 20px;\n          background: #E74C3C;\n          color: #FFFFFF;\n          border: none;\n          border-radius: 20px;\n          font-size: 1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .close-modal:hover {\n          background: #C0392B;\n          transform: scale(1.05);\n        }\n\n        @keyframes shake {\n          0%,\n          100% {\n            transform: translateX(0);\n          }\n          10%,\n          30%,\n          50%,\n          70%,\n          90% {\n            transform: translateX(-5px);\n          }\n          20%,\n          40%,\n          60%,\n          80% {\n            transform: translateX(5px);\n          }\n        }\n      "})]})},Bp=["General Physician","Cardiologist","Neurologist","Orthopedic Surgeon","Dermatologist","Endocrinologist"];const $p=function(){const[e,n]=(0,t.useState)([]),[r,i]=(0,t.useState)("All"),[s,o]=(0,t.useState)(!1),[a,l]=(0,t.useState)("");return(0,t.useEffect)((()=>{(async()=>{o(!0),l("");try{let e;e="All"===r?Mu(eu(kp,"doctors")):Mu(eu(kp,"doctors"),Vu("specialty","==",r));const t=(await td(e)).docs.map((e=>({doctorId:e.id,...e.data()})));n(t)}catch(e){console.error("AdminDoctors: Error fetching doctors:",e),l(`Error fetching doctors: ${e.message}`),n([])}finally{o(!1)}})()}),[r]),(0,Tp.jsxs)("div",{className:"table-container",children:[(0,Tp.jsxs)("div",{className:"filter-container",children:[(0,Tp.jsx)("label",{htmlFor:"role-filter",children:"Filter by Specialty: "}),(0,Tp.jsxs)("select",{id:"role-filter",value:r,onChange:e=>i(e.target.value),children:[(0,Tp.jsx)("option",{value:"All",children:"All Specialties"}),Bp.map((e=>(0,Tp.jsx)("option",{value:e,children:e},e)))]})]}),a&&(0,Tp.jsx)("p",{className:"error-message",children:a}),s?(0,Tp.jsx)("p",{className:"loading-message",children:"Loading doctors..."}):(0,Tp.jsxs)("table",{children:[(0,Tp.jsx)("thead",{children:(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("th",{children:"Doctor ID"}),(0,Tp.jsx)("th",{children:"Doctor Name"}),(0,Tp.jsx)("th",{children:"Age"}),(0,Tp.jsx)("th",{children:"Sex"}),(0,Tp.jsx)("th",{children:"Experience"}),(0,Tp.jsx)("th",{children:"Specialty"}),(0,Tp.jsx)("th",{children:"Actions"})]})}),(0,Tp.jsx)("tbody",{children:0===e.length?(0,Tp.jsx)("tr",{children:(0,Tp.jsx)("td",{colSpan:"7",children:"All"===r?"No doctors found.":`No doctors found for the specialty: ${r}.`})}):e.map((t=>(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("td",{children:t.doctorId}),(0,Tp.jsx)("td",{children:t.name}),(0,Tp.jsx)("td",{children:t.age}),(0,Tp.jsx)("td",{children:t.sex}),(0,Tp.jsx)("td",{children:t.experience}),(0,Tp.jsx)("td",{children:t.specialty}),(0,Tp.jsx)("td",{children:(0,Tp.jsx)("button",{className:"delete-button",onClick:()=>(async t=>{if(window.confirm(`Are you sure you want to delete the doctor with Doctor ID ${t}?`)){o(!0),l("");try{const r=tu(kp,"doctors",t),i=await td(Mu(eu(kp,"doctors"),Vu("doctorId","==",t)));if(i.empty)throw new Error(`Doctor with ID ${t} not found in Firestore`);const s=i.docs[0].data().uid;await id(r),console.log(`Doctor ${t} deleted from Firestore (doctors)`);const o=tu(kp,"users",s);await id(o),console.log(`Doctor ${s} deleted from Firestore (users)`);const a=localStorage.getItem("userId");if(!a)throw new Error("Admin ID not found. Please log in again.");const l=await fetch(`http://localhost:5005/delete-doctor/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json","x-user-uid":a},credentials:"include"});if(!l.ok){const e=await l.json();throw new Error(`Failed to delete doctor from backend: ${e.error}`)}n(e.filter((e=>e.doctorId!==t))),alert("Doctor deleted successfully!")}catch(r){console.error("AdminDoctors: Error deleting doctor:",r),l(`Error deleting doctor: ${r.message}`)}finally{o(!1)}}})(t.doctorId),disabled:s,children:"Delete"})})]},t.doctorId)))})]}),(0,Tp.jsx)("style",{children:"\n        .table-container {\n          width: 100%;\n          overflow-x: auto;\n          padding: 20px;\n          font-family: 'Poppins', sans-serif;\n        }\n\n        .filter-container {\n          margin-bottom: 20px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          color: #6e48aa;\n        }\n\n        label {\n          font-size: 1.1rem;\n          font-weight: 500;\n        }\n\n        select {\n          padding: 8px 12px;\n          border: 2px solid #ddd;\n          border-radius: 8px;\n          font-size: 1rem;\n          color: #333;\n          background: #fff;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        select:focus {\n          outline: none;\n          border-color: #6e48aa;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n        }\n\n        .error-message {\n          color: #e74c3c;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .loading-message {\n          color: #6e48aa;\n          font-size: 1rem;\n          text-align: center;\n          margin-bottom: 20px;\n        }\n\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          background: #ffffff;\n          border-radius: 8px;\n          overflow: hidden;\n        }\n\n        th, td {\n          padding: 15px;\n          text-align: left;\n          font-size: 1rem;\n          color: #333;\n        }\n\n        th {\n          background: #6e48aa;\n          color: #ffffff;\n          font-weight: 600;\n        }\n\n        tr:nth-child(even) {\n          background: #f8f9fa;\n        }\n\n        tr:hover {\n          background: #e9ecef;\n        }\n\n        .delete-button {\n          padding: 5px 10px;\n          background: #e74c3c;\n          color: #ffffff;\n          border: none;\n          border-radius: 5px;\n          cursor: pointer;\n          font-size: 0.9rem;\n          transition: background 0.3s ease;\n        }\n\n        .delete-button:disabled {\n          background: #999;\n          cursor: not-allowed;\n        }\n\n        .delete-button:hover:not(:disabled) {\n          background: #c0392b;\n        }\n\n        @media (max-width: 768px) {\n          th, td {\n            padding: 10px;\n            font-size: 0.9rem;\n          }\n\n          .delete-button {\n            padding: 4px 8px;\n            font-size: 0.8rem;\n          }\n        }\n\n        @media (max-width: 480px) {\n          th, td {\n            padding: 8px;\n            font-size: 0.8rem;\n          }\n\n          .delete-button {\n            padding: 3px 6px;\n            font-size: 0.7rem;\n          }\n        }\n      "})]})};const qp=function(){const[e,n]=(0,t.useState)([]),[r,i]=(0,t.useState)(!0),[s,o]=(0,t.useState)("");return(0,t.useEffect)((()=>{i(!0),o("");const e=od(eu(kp,"patients"),(e=>{const t=e.docs.map((e=>({id:e.id,...e.data()})));n(t),i(!1),console.log("AdminPatients: Patients updated in real-time:",t)}),(e=>{console.error("AdminPatients: Error fetching patients:",e),o(`Error fetching patients: ${e.message}`),n([]),i(!1)}));return()=>e()}),[]),(0,Tp.jsxs)("div",{className:"table-container",children:[s&&(0,Tp.jsx)("p",{className:"error-message",children:s}),r?(0,Tp.jsx)("p",{className:"loading-message",children:"Loading patients..."}):(0,Tp.jsxs)("table",{children:[(0,Tp.jsx)("thead",{children:(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("th",{children:"Patient Name"}),(0,Tp.jsx)("th",{children:"Age"}),(0,Tp.jsx)("th",{children:"Sex"}),(0,Tp.jsx)("th",{children:"Actions"})]})}),(0,Tp.jsx)("tbody",{children:0===e.length?(0,Tp.jsx)("tr",{children:(0,Tp.jsx)("td",{colSpan:"4",children:"No patients found."})}):e.map((e=>(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("td",{children:e.name}),(0,Tp.jsx)("td",{children:e.age}),(0,Tp.jsx)("td",{children:e.sex}),(0,Tp.jsx)("td",{children:(0,Tp.jsx)("button",{className:"delete-button",onClick:()=>(async e=>{if(window.confirm(`Are you sure you want to delete the patient with ID ${e}?`))try{const t=tu(kp,"patients",e);await id(t),console.log(`AdminPatients: Patient ${e} deleted from Firestore (patients)`);const n=tu(kp,"users",e);await id(n),console.log(`AdminPatients: Patient ${e} deleted from Firestore (users)`);const r=await fetch(`http://localhost:5005/delete-patient/${e}`,{method:"DELETE",credentials:"include"});if(!r.ok){const e=await r.json();throw new Error(`Failed to delete patient from backend: ${e.error||r.statusText}`)}alert("Patient deleted successfully!")}catch(t){console.error("AdminPatients: Error deleting patient:",t),o(`Error deleting patient: ${t.message}`)}})(e.id),children:"Delete"})})]},e.id)))})]}),(0,Tp.jsx)("style",{children:"\n        .table-container {\n          width: 100%;\n          overflow-x: auto;\n          padding: 20px;\n          font-family: 'Poppins', sans-serif;\n        }\n\n        .error-message {\n          color: #e74c3c;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .loading-message {\n          color: #6e48aa;\n          font-size: 1rem;\n          text-align: center;\n          margin-bottom: 20px;\n        }\n\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          background: #ffffff;\n          border-radius: 8px;\n          overflow: hidden;\n        }\n\n        th, td {\n          padding: 15px;\n          text-align: left;\n          font-size: 1rem;\n          color: #333;\n        }\n\n        th {\n          background: #6e48aa;\n          color: #ffffff;\n          font-weight: 600;\n        }\n\n        tr:nth-child(even) {\n          background: #f8f9fa;\n        }\n\n        tr:hover {\n          background: #e9ecef;\n        }\n\n        .delete-button {\n          padding: 5px 10px;\n          background: #e74c3c;\n          color: #ffffff;\n          border: none;\n          border-radius: 5px;\n          cursor: pointer;\n          font-size: 0.9rem;\n          transition: background 0.3s ease;\n        }\n\n        .delete-button:hover {\n          background: #c0392b;\n        }\n\n        @media (max-width: 768px) {\n          th, td {\n            padding: 10px;\n            font-size: 0.9rem;\n          }\n\n          .delete-button {\n            padding: 4px 8px;\n            font-size: 0.8rem;\n          }\n        }\n\n        @media (max-width: 480px) {\n          th, td {\n            padding: 8px;\n            font-size: 0.8rem;\n          }\n\n          .delete-button {\n            padding: 3px 6px;\n            font-size: 0.7rem;\n          }\n        }\n      "})]})};const Hp=function(){const[e,n]=(0,t.useState)([]),[r,i]=(0,t.useState)({}),[s,o]=(0,t.useState)(!1),[a,l]=(0,t.useState)("");return(0,t.useEffect)((()=>{if(!localStorage.getItem("userId"))return console.error("Admin ID not found in local storage"),void l("Admin ID not found. Please log in again.");const e=async()=>{o(!0),l("");try{const e=await fetch("http://localhost:5005/admin_notifications");if(!e.ok)throw new Error("Failed to fetch cases");const t=await e.json();n(t)}catch(e){console.error("AdminCases: Error fetching cases:",e),l(`Error fetching cases: ${e.message}`),n([])}finally{o(!1)}};(async()=>{await(async()=>{try{const e=await fetch("http://localhost:5005/patients");if(!e.ok)throw new Error("Failed to fetch patients");const t=(await e.json()).reduce(((e,t)=>(e[t.patientId]=t,e)),{});i(t)}catch(e){console.error("AdminCases: Error fetching patients:",e),l(`Error fetching patients: ${e.message}`)}})(),await e()})();const t=setInterval(e,5e3);return()=>clearInterval(t)}),[]),(0,Tp.jsxs)("div",{className:"table-container",children:[a&&(0,Tp.jsx)("p",{className:"error-message",children:a}),s?(0,Tp.jsx)("p",{className:"loading-message",children:"Loading cases..."}):(0,Tp.jsxs)("table",{children:[(0,Tp.jsx)("thead",{children:(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("th",{children:"Patient Name"}),(0,Tp.jsx)("th",{children:"Age"}),(0,Tp.jsx)("th",{children:"Sex"}),(0,Tp.jsx)("th",{children:"Patient Description"}),(0,Tp.jsx)("th",{children:"Doctor Diagnosis"}),(0,Tp.jsx)("th",{children:"Prescription Given"})]})}),(0,Tp.jsx)("tbody",{children:0===e.length?(0,Tp.jsx)("tr",{children:(0,Tp.jsx)("td",{colSpan:"6",children:"No cases found."})}):e.map((e=>{const t=r[e.patientId]||{};return(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("td",{children:e.patientName}),(0,Tp.jsx)("td",{children:t.age||"N/A"}),(0,Tp.jsx)("td",{children:t.sex||"N/A"}),(0,Tp.jsx)("td",{children:e.description||"N/A"}),(0,Tp.jsx)("td",{children:e.disease||"N/A"}),(0,Tp.jsx)("td",{className:e.medicine?"":"invalid-prescription",children:e.medicine||"No prescription given"})]},e.id)}))})]}),(0,Tp.jsx)("style",{children:"\n        .table-container {\n          width: 100%;\n          overflow-x: auto;\n          padding: 20px;\n          font-family: 'Poppins', sans-serif;\n        }\n\n        .error-message {\n          color: #e74c3c;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .loading-message {\n          color: #6e48aa;\n          font-size: 1rem;\n          text-align: center;\n          margin-bottom: 20px;\n        }\n\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          background: #ffffff;\n          border-radius: 8px;\n          overflow: hidden;\n        }\n\n        th, td {\n          padding: 15px;\n          text-align: left;\n          font-size: 1rem;\n          color: #333;\n        }\n\n        th {\n          background: #6e48aa;\n          color: #ffffff;\n          font-weight: 600;\n        }\n\n        tr:nth-child(even) {\n          background: #f8f9fa;\n        }\n\n        tr:hover {\n          background: #e9ecef;\n        }\n\n        .invalid-prescription {\n          color: #ff4d4d;\n          font-weight: 500;\n        }\n\n        @media (max-width: 768px) {\n          th, td {\n            padding: 10px;\n            font-size: 0.9rem;\n          }\n        }\n\n        @media (max-width: 480px) {\n          th, td {\n            padding: 8px;\n            font-size: 0.8rem;\n          }\n        }\n      "})]})};function Kp(e){let{user:n,role:r,handleLogout:i,setUser:s}=e;const[o,a]=(0,t.useState)(!1),[l,c]=(0,t.useState)("add-doctor"),[u,d]=(0,t.useState)(!0),[h,f]=(0,t.useState)({name:"",age:"",sex:"",experience:"",specialty:Bp[0],email:"",password:"",doctorId:"",qualification:"",address:"",contactNumber:""}),[p,m]=(0,t.useState)(""),[g,v]=(0,t.useState)(""),[y,b]=(0,t.useState)({email:"",password:""}),[w,_]=(0,t.useState)(""),[E,x]=(0,t.useState)(""),[S,k]=(0,t.useState)(!1),T=X(),C=(0,t.useCallback)((async()=>{const e="abcdefghijklmnopqrstuvwxyz0123456789";let t="";const n=eu(kp,"doctors");for(;;){t="";for(let n=0;n<6;n++){t+=e[Math.floor(36*Math.random())]}const r=Mu(n,Vu("doctorId","==",t));if((await td(r)).empty)break;console.log(`Generated doctorId ${t} already exists, regenerating...`)}return console.log("AdminDashboard.js: Generated unique doctorId:",t),t}),[]),I=(0,t.useCallback)((async()=>{try{const e=await C();f((t=>({...t,doctorId:e})))}catch(e){console.error("AdminDashboard.js: Error generating doctorId:",e),m("Failed to generate doctor ID. Please try again.")}}),[C]);(0,t.useEffect)((()=>{n&&"admin"===r?I():T("/login")}),[n,r,T,I]);const A=e=>{c(e),a(!1),"add-doctor"===e&&(d(!0),v(""),m(""),I())},P=e=>{const{name:t,value:n}=e.target;f((e=>({...e,[t]:n})))},N=e=>{const{name:t,value:n}=e.target;b((e=>({...e,[t]:n})))};return(0,Tp.jsxs)("div",{className:"admin-dashboard",children:[(0,Tp.jsxs)("div",{className:"header",children:[(0,Tp.jsx)("button",{className:"hamburger-button",onClick:()=>{a(!o)},children:o?"\u2716":"\u2630"}),(0,Tp.jsx)("h2",{children:"Admin Dashboard"}),(0,Tp.jsxs)("p",{children:["Welcome, Admin! (UID: ",null===n||void 0===n?void 0:n.uid,")"]})]}),(0,Tp.jsx)("div",{className:"menu "+(o?"open":""),children:(0,Tp.jsxs)("ul",{children:[(0,Tp.jsx)("li",{className:"add-doctor"===l?"active":"",onClick:()=>A("add-doctor"),children:"Add Doctor"}),(0,Tp.jsx)("li",{className:"add-admin"===l?"active":"",onClick:()=>A("add-admin"),children:"Add Admin"}),(0,Tp.jsx)("li",{className:"doctors"===l?"active":"",onClick:()=>A("doctors"),children:"Doctors List"}),(0,Tp.jsx)("li",{className:"patients"===l?"active":"",onClick:()=>A("patients"),children:"Patients List"}),(0,Tp.jsx)("li",{className:"cases"===l?"active":"",onClick:()=>A("cases"),children:"Cases List"}),(0,Tp.jsx)("li",{onClick:i,children:"Logout"})]})}),(0,Tp.jsxs)("div",{className:"content",children:["add-doctor"===l&&(0,Tp.jsx)("div",{className:"section",children:(0,Tp.jsxs)("div",{className:"add-doctor-form",children:[(0,Tp.jsx)("h3",{children:"Add New Doctor"}),u?(0,Tp.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(""),v("");const t=localStorage.getItem("userId");if(console.log("AdminDashboard: Admin UID from localStorage:",t),!t)return m("Admin ID not found. Please log in again."),void T("/login");const n=tu(kp,"users",t),r=await Zu(n);if(!r.exists()||"admin"!==r.data().role)return void m("Insufficient permissions. Only admins can add doctors.");const i=["name","age","sex","experience","specialty","email","password","doctorId","qualification","address","contactNumber"].filter((e=>!h[e]));if(i.length>0)m(`Please fill in all fields: ${i.join(", ")}.`);else if(h.email.endsWith("@gmail.com"))if(isNaN(h.age)||h.age<=0)m("Please enter a valid age.");else if(isNaN(h.experience)||h.experience<0)m("Please enter a valid experience (in years).");else if(/^\d{10}$/.test(h.contactNumber))try{const e={email:h.email,password:h.password,role:"doctor",name:h.name,age:parseInt(h.age),sex:h.sex,experience:parseInt(h.experience),specialty:h.specialty,doctorId:h.doctorId,qualification:h.qualification,address:h.address,contactNumber:h.contactNumber,createdAt:(new Date).toISOString()};console.log("AdminDashboard: Sending request to /create-doctor with payload:",e);const n=await fetch("http://localhost:5005/create-doctor",{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":t,Authorization:`Bearer ${await Sp.currentUser.getIdToken()}`},body:JSON.stringify(e),credentials:"include"}),r=await n.json();if(!n.ok)throw new Error(`Failed to create doctor user: ${r.error}`);const i=r.uid;console.log("AdminDashboard: Doctor created with UID:",i);const s=tu(kp,"users",i);await nd(s,{...e,uid:i}),console.log("AdminDashboard: Doctor data stored in Firestore (users) for UID:",i);const o=tu(kp,"doctors",h.doctorId);await nd(o,{...e,uid:i}),console.log("AdminDashboard: Doctor data stored in Firestore (doctors) with doctorId:",h.doctorId),console.log("AdminDashboard: Sending request to /add-doctor with x-user-uid:",t);const a=await fetch("http://localhost:5005/add-doctor",{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":t,Authorization:`Bearer ${await Sp.currentUser.getIdToken()}`},body:JSON.stringify({...e,uid:i}),credentials:"include"}),l=await a.json();if(!a.ok)throw new Error(`Failed to add doctor to backend: ${l.error}`);console.log("AdminDashboard: Doctor added to backend successfully:",l),v("Doctor added successfully!"),f({name:"",age:"",sex:"",experience:"",specialty:Bp[0],email:"",password:"",doctorId:await C(),qualification:"",address:"",contactNumber:""}),d(!1)}catch(s){console.error("AdminDashboard: Error adding doctor - Details:",s),s.message.includes("email-already-in-use")?m("This email is already registered."):s.message.includes("invalid-email")?m("Please enter a valid Gmail address (e.g., example@gmail.com)."):s.message.includes("weak-password")?m("Password should be at least 6 characters long."):s.message.includes("permission-denied")?m("Insufficient permissions to add doctor. Verify Firestore rules and admin role."):m(`Error adding doctor: ${s.message}`)}else m("Please enter a valid 10-digit contact number.");else m("Email must be a valid Gmail address (e.g., example@gmail.com).")},children:[(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"doctorId",children:"Doctor ID"}),(0,Tp.jsx)("input",{type:"text",id:"doctorId",name:"doctorId",value:h.doctorId,readOnly:!0,placeholder:"Auto-generated Doctor ID"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"email",children:"Email"}),(0,Tp.jsx)("input",{type:"email",id:"email",name:"email",value:h.email,onChange:P,placeholder:"Enter doctor email (e.g., doctor@gmail.com)",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"password",children:"Password"}),(0,Tp.jsx)("input",{type:"password",id:"password",name:"password",value:h.password,onChange:P,placeholder:"Enter doctor password",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"name",children:"Doctor Name"}),(0,Tp.jsx)("input",{type:"text",id:"name",name:"name",value:h.name,onChange:P,placeholder:"Enter doctor name",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"age",children:"Age"}),(0,Tp.jsx)("input",{type:"number",id:"age",name:"age",value:h.age,onChange:P,placeholder:"Enter age",required:!0,min:"1"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"sex",children:"Sex"}),(0,Tp.jsxs)("select",{id:"sex",name:"sex",value:h.sex,onChange:P,required:!0,children:[(0,Tp.jsx)("option",{value:"",disabled:!0,children:"Select sex"}),(0,Tp.jsx)("option",{value:"Male",children:"Male"}),(0,Tp.jsx)("option",{value:"Female",children:"Female"}),(0,Tp.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"experience",children:"Experience (Years)"}),(0,Tp.jsx)("input",{type:"number",id:"experience",name:"experience",value:h.experience,onChange:P,placeholder:"Enter years of experience",required:!0,min:"0"})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"specialty",children:"Specialty"}),(0,Tp.jsxs)("select",{id:"specialty",name:"specialty",value:h.specialty,onChange:P,required:!0,children:[(0,Tp.jsx)("option",{value:"",disabled:!0,children:"Select specialty"}),Bp.map((e=>(0,Tp.jsx)("option",{value:e,children:e},e)))]})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"qualification",children:"Qualification"}),(0,Tp.jsx)("input",{type:"text",id:"qualification",name:"qualification",value:h.qualification,onChange:P,placeholder:"Enter qualification (e.g., MBBS, MD)",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"address",children:"Address"}),(0,Tp.jsx)("input",{type:"text",id:"address",name:"address",value:h.address,onChange:P,placeholder:"Enter address",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"contactNumber",children:"Contact Number"}),(0,Tp.jsx)("input",{type:"text",id:"contactNumber",name:"contactNumber",value:h.contactNumber,onChange:P,placeholder:"Enter 10-digit contact number",required:!0,maxLength:"10"})]}),p&&(0,Tp.jsx)("p",{className:"error-message",children:p}),g&&(0,Tp.jsx)("p",{className:"success-message",children:g}),(0,Tp.jsx)("button",{type:"submit",className:"submit-button",children:"Add Doctor"})]}):(0,Tp.jsxs)("div",{className:"success-container",children:[(0,Tp.jsx)("p",{className:"success-message",children:g}),(0,Tp.jsx)("button",{onClick:()=>{d(!0),v(""),I()},className:"submit-button",children:"Add Another Doctor"})]})]})}),"add-admin"===l&&(0,Tp.jsx)("div",{className:"section",children:(0,Tp.jsxs)("div",{className:"add-admin-form",children:[(0,Tp.jsx)("h3",{children:"Add New Admin"}),(0,Tp.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),_(""),x(""),k(!0),!y.email||!y.password)return _("Please fill in all fields."),void k(!1);if(!y.email.endsWith("@gmail.com"))return _("Email must be a valid Gmail address (e.g., example@gmail.com)."),void k(!1);try{const e={email:y.email,password:y.password,role:"admin",createdAt:(new Date).toISOString()},t=await fetch("http://localhost:5005/create-admin",{method:"POST",headers:{"Content-Type":"application/json","x-user-uid":localStorage.getItem("userId"),Authorization:`Bearer ${await Sp.currentUser.getIdToken()}`},body:JSON.stringify(e),credentials:"include"}),n=await t.json();if(!t.ok)throw new Error(`Failed to create admin: ${n.error}`);const r=n.uid;console.log("AdminDashboard: New admin created with UID:",r);const i=tu(kp,"users",r);await nd(i,{...e,uid:r}),console.log("AdminDashboard: Admin data stored in Firestore for UID:",r),x("Admin added successfully!"),b({email:"",password:""})}catch(t){console.error("AdminDashboard: Add admin error - Details:",t),t.message.includes("email-already-in-use")?_("This email is already registered."):t.message.includes("invalid-email")?_("Please enter a valid Gmail address (e.g., example@gmail.com)."):t.message.includes("weak-password")?_("Password should be at least 6 characters long."):_(`Failed to add admin: ${t.message}`)}finally{k(!1)}},children:[(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"admin-email",children:"Email"}),(0,Tp.jsx)("input",{type:"email",id:"admin-email",name:"email",value:y.email,onChange:N,placeholder:"Enter admin email (e.g., admin@gmail.com)",required:!0})]}),(0,Tp.jsxs)("div",{className:"form-group",children:[(0,Tp.jsx)("label",{htmlFor:"admin-password",children:"Password"}),(0,Tp.jsx)("input",{type:"password",id:"admin-password",name:"password",value:y.password,onChange:N,placeholder:"Enter admin password",required:!0})]}),w&&(0,Tp.jsx)("p",{className:"error-message",children:w}),E&&(0,Tp.jsx)("p",{className:"success-message",children:E}),(0,Tp.jsx)("button",{type:"submit",disabled:S,className:"submit-button",children:S?"Adding Admin...":"Add Admin"})]})]})}),"doctors"===l&&(0,Tp.jsxs)("div",{className:"section",children:[(0,Tp.jsx)("h3",{children:"Doctors List"}),(0,Tp.jsx)($p,{})]}),"patients"===l&&(0,Tp.jsxs)("div",{className:"section",children:[(0,Tp.jsx)("h3",{children:"Patients List"}),(0,Tp.jsx)(qp,{})]}),"cases"===l&&(0,Tp.jsxs)("div",{className:"section",children:[(0,Tp.jsx)("h3",{children:"Cases List"}),(0,Tp.jsx)(Hp,{})]})]}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');\n\n        .admin-dashboard {\n          min-height: 100vh;\n          width: 100vw;\n          background: linear-gradient(135deg, #6e48aa, #9d50bb);\n          font-family: 'Poppins', sans-serif;\n          padding: 40px;\n          color: #ffffff;\n          overflow-y: auto;\n          position: relative;\n        }\n\n        .header {\n          text-align: center;\n          margin-bottom: 20px;\n        }\n\n        .hamburger-button {\n          position: absolute;\n          top: 20px;\n          left: 20px;\n          background: none;\n          border: none;\n          font-size: 2rem;\n          color: #ffffff;\n          cursor: pointer;\n          z-index: 1000;\n        }\n\n        .menu {\n          position: fixed;\n          top: 0;\n          left: -250px;\n          width: 250px;\n          height: 100%;\n          background: #ffffff;\n          box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);\n          transition: left 0.3s ease;\n          z-index: 999;\n        }\n\n        .menu.open {\n          left: 0;\n        }\n\n        .menu ul {\n          list-style: none;\n          padding: 60px 20px 20px;\n        }\n\n        .menu li {\n          padding: 15px;\n          font-size: 1.2rem;\n          color: #6e48aa;\n          cursor: pointer;\n          transition: background 0.3s ease;\n        }\n\n        .menu li:hover {\n          background: #f0f0f0;\n        }\n\n        .menu li.active {\n          background: #6e48aa;\n          color: #ffffff;\n          border-radius: 5px;\n        }\n\n        h2 {\n          font-size: 2rem;\n          font-weight: 600;\n          margin-bottom: 10px;\n        }\n\n        p {\n          font-size: 1.1rem;\n          margin-bottom: 20px;\n        }\n\n        .content {\n          margin-left: 0;\n          transition: margin-left 0.3s ease;\n        }\n\n        .section {\n          background: #ffffff;\n          border-radius: 10px;\n          padding: 30px;\n          margin-bottom: 30px;\n          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);\n        }\n\n        .section h3 {\n          font-size: 1.5rem;\n          font-weight: 600;\n          margin-bottom: 20px;\n          color: #6e48aa;\n        }\n\n        .add-doctor-form,\n        .add-admin-form {\n          background: #fff;\n          padding: 20px;\n          border-radius: 8px;\n          margin-bottom: 20px;\n          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n        }\n\n        .add-doctor-form h3,\n        .add-admin-form h3 {\n          color: #333;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .form-group {\n          margin-bottom: 15px;\n        }\n\n        .form-group label {\n          display: block;\n          font-size: 1rem;\n          color: #555;\n          margin-bottom: 5px;\n          font-weight: 500;\n        }\n\n        .form-group input,\n        .form-group select {\n          width: 100%;\n          padding: 8px 12px;\n          border: 2px solid #ddd;\n          border-radius: 8px;\n          font-size: 1rem;\n          color: #333;\n          background: #f9f9f9;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .form-group input[readonly] {\n          background: #e9ecef;\n          cursor: not-allowed;\n        }\n\n        .form-group input:focus,\n        .form-group select:focus {\n          outline: none;\n          border-color: #6e48aa;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n          background: #fff;\n        }\n\n        .form-group input::placeholder,\n        .form-group select:invalid {\n          color: #bbb;\n        }\n\n        .form-group select {\n          color: #333;\n        }\n\n        .form-group select:invalid {\n          color: #bbb;\n        }\n\n        .submit-button {\n          width: 150px;\n          padding: 10px;\n          background: #6e48aa;\n          color: #fff;\n          border: none;\n          border-radius: 8px;\n          font-size: 1.1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: background 0.3s ease;\n          display: block;\n          margin: 0 auto;\n        }\n\n        .submit-button:disabled {\n          background: #999;\n          cursor: not-allowed;\n        }\n\n        .submit-button:hover:not(:disabled) {\n          background: #5a3e8b;\n        }\n\n        .error-message {\n          color: #e74c3c;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .success-message {\n          color: #2ecc71;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n        }\n\n        .success-container {\n          text-align: center;\n        }\n\n        @media (max-width: 768px) {\n          .admin-dashboard {\n            padding: 20px;\n          }\n\n          h2 {\n            font-size: 1.5rem;\n          }\n\n          .section {\n            padding: 20px;\n          }\n\n          .menu {\n            width: 200px;\n            left: -200px;\n          }\n\n          .menu.open {\n            left: 0;\n          }\n        }\n\n        @media (max-width: 480px) {\n          h2 {\n            font-size: 1.2rem;\n          }\n\n          .section h3 {\n            font-size: 1.2rem;\n          }\n\n          .menu {\n            width: 180px;\n            left: -180px;\n          }\n\n          .menu.open {\n            left: 0;\n          }\n\n          .menu li {\n            font-size: 1rem;\n            padding: 10px;\n          }\n        }\n      "})]})}const Wp=t.memo(Kp);const Gp=function(e){let{firebaseUser:n,user:r,role:i,patientId:s,handleLogout:o}=e;const[a,l]=(0,t.useState)("All"),[c,u]=(0,t.useState)([]),[d,h]=(0,t.useState)(!0),[f,p]=(0,t.useState)(null),[m,g]=(0,t.useState)(""),v=X(),y={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api";(0,t.useEffect)((()=>{if(!r||!n||"patient"!==i||!s)return console.error("SelectDoctor: Invalid user state:",{user:r,role:i,patientId:s,firebaseUser:n}),g("Invalid session. Please log in again."),void v("/login");console.log("Fetching doctors for patient:",{patientId:s,uid:r.uid});(async()=>{h(!0);try{const t=await n.getIdToken(!0),i="All"===a?`${y}/doctors`:`${y}/doctors/by-specialty/${a}`,s=await fetch(i,{headers:{"x-user-uid":r.uid,"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`},credentials:"include"});if(!s.ok){var e;const t=await s.json();throw new Error(`HTTP error! status: ${s.status}, message: ${(null===(e=t.error)||void 0===e?void 0:e.message)||s.statusText}`)}const o=await s.json();console.log("SelectDoctor: Doctors fetched:",o.doctors),u(o.doctors||[]),g(0===o.doctors.length?"All"===a?"No doctors available at this time.":`No doctors found for specialty: ${a}.`:"")}catch(t){console.error("SelectDoctor: Fetch error:",t.message),g(`Failed to load doctors: ${t.message}`),u([])}finally{h(!1)}})()}),[a,r,n,i,s,v,y]);const b=async e=>{if(s&&e){p(e),g("");try{const t=await n.getIdToken(!0),i=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;for(let s=1;s<=n;s++)try{const n=await fetch(e,t);if(!n.ok){var i;const e=await n.json();throw new Error(`HTTP error! status: ${n.status}, message: ${(null===(i=e.error)||void 0===i?void 0:i.message)||n.statusText}`)}return n}catch(m){if(s===n)throw m;console.warn(`Retry ${s}/${n} failed for ${e}: ${m.message}`),await new Promise((e=>setTimeout(e,r*s)))}}(`${y}/doctors/assign`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"x-user-uid":r.uid,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({patientId:s,doctorId:e}),credentials:"include"}),o=await i.json();console.log(`SelectDoctor: Assigned doctor ${e} to patient ${s}`,o),v(`/patient/language-preference/${s}/${e}`)}catch(t){console.error("SelectDoctor: Error assigning doctor:",t.message),g(`Error assigning doctor: ${t.message.includes("404")?"Doctor assignment endpoint not found. Please contact support.":t.message.includes("403")?"Access denied. Please verify your role or log in again.":t.message.includes("400")?"Invalid request. Please ensure all data is correct.":t.message}`)}finally{p(null)}}else g("Patient ID or Doctor ID not found. Please try again.")};return(0,Tp.jsxs)("div",{className:"select-doctor-container",children:[(0,Tp.jsxs)("div",{className:"header",children:[(0,Tp.jsx)("h2",{children:"Select a Doctor"}),(0,Tp.jsx)("button",{onClick:async()=>{try{await af(Sp),await fetch(`${y}/misc/logout`,{method:"POST",headers:{"x-user-uid":r.uid,"Content-Type":"application/json"},credentials:"include"}),o(),v("/login"),console.log("Logged out successfully")}catch(e){console.error("Logout error:",e.message),g("Failed to log out. Please try again.")}},className:"logout-button",disabled:d||f,children:"Logout"})]}),(0,Tp.jsxs)("div",{className:"filter-container",children:[(0,Tp.jsx)("label",{htmlFor:"specialty-filter",children:"Filter by Specialty:"}),(0,Tp.jsxs)("select",{id:"specialty-filter",value:a,onChange:e=>l(e.target.value),disabled:d||f,"aria-label":"Filter doctors by specialty",children:[(0,Tp.jsx)("option",{value:"All",children:"All Specialties"}),Bp.map((e=>(0,Tp.jsx)("option",{value:e,children:e},e)))]})]}),m&&(0,Tp.jsx)("p",{className:"error-message",role:"alert",children:m}),d?(0,Tp.jsx)("p",{className:"loading-message",role:"status",children:"Loading doctors..."}):(0,Tp.jsxs)("table",{role:"grid",children:[(0,Tp.jsx)("thead",{children:(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("th",{scope:"col",children:"Doctor Name"}),(0,Tp.jsx)("th",{scope:"col",children:"Age"}),(0,Tp.jsx)("th",{scope:"col",children:"Sex"}),(0,Tp.jsx)("th",{scope:"col",children:"Experience"}),(0,Tp.jsx)("th",{scope:"col",children:"Role"}),(0,Tp.jsx)("th",{scope:"col",children:"Specialty"}),(0,Tp.jsx)("th",{scope:"col",children:"Action"})]})}),(0,Tp.jsx)("tbody",{children:0===c.length?(0,Tp.jsx)("tr",{children:(0,Tp.jsx)("td",{colSpan:"7",className:"no-data",children:"All"===a?"No doctors available.":`No doctors found for specialty: ${a}.`})}):c.map((e=>(0,Tp.jsxs)("tr",{children:[(0,Tp.jsx)("td",{children:e.name||"N/A"}),(0,Tp.jsx)("td",{children:e.age||"N/A"}),(0,Tp.jsx)("td",{children:e.sex||"N/A"}),(0,Tp.jsx)("td",{children:e.experience||"N/A"}),(0,Tp.jsx)("td",{children:e.role||"doctor"}),(0,Tp.jsx)("td",{children:e.specialty||"N/A"}),(0,Tp.jsx)("td",{children:(0,Tp.jsx)("button",{onClick:()=>b(e.doctorId||e.id),className:"select-button",disabled:d||f===(e.doctorId||e.id),"aria-label":`Select doctor ${e.name||"N/A"}`,"aria-busy":f===(e.doctorId||e.id)?"true":"false",children:f===(e.doctorId||e.id)?"Selecting...":"Select"})})]},e.doctorId||e.id)))})]}),(0,Tp.jsx)("style",{children:"\n        .select-doctor-container {\n          width: 100%;\n          overflow-x: auto;\n          padding: 20px;\n          background: linear-gradient(135deg, #6e48aa, #9d50bb);\n          min-height: 100vh;\n          font-family: 'Arial', sans-serif;\n          box-sizing: border-box;\n        }\n\n        .header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20px;\n          flex-wrap: wrap;\n          gap: 10px;\n        }\n\n        h2 {\n          color: #fff;\n          font-size: 2rem;\n          margin: 0;\n          text-align: center;\n          flex: 1;\n        }\n\n        .logout-button {\n          padding: 8px 16px;\n          background: #e74c3c;\n          color: #fff;\n          border: none;\n          border-radius: 5px;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.2s ease;\n        }\n\n        .logout-button:hover:not(:disabled) {\n          background: #c0392b;\n          transform: scale(1.05);\n        }\n\n        .logout-button:disabled {\n          background: #a0a0a0;\n          cursor: not-allowed;\n        }\n\n        .filter-container {\n          margin-bottom: 20px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          color: #fff;\n          justify-content: center;\n          flex-wrap: wrap;\n        }\n\n        label {\n          font-size: 1.1rem;\n          font-weight: 500;\n        }\n\n        select {\n          padding: 8px 12px;\n          border: 2px solid #ddd;\n          border-radius: 8px;\n          font-size: 1rem;\n          color: #333;\n          background: #fff;\n          transition: border-color 0.3s ease, box-shadow 0.3s ease;\n          min-width: 200px;\n        }\n\n        select:focus {\n          outline: none;\n          border-color: #6e48aa;\n          box-shadow: 0 0 8px rgba(110, 72, 170, 0.3);\n        }\n\n        select:disabled {\n          background: #e0e0e0;\n          cursor: not-allowed;\n        }\n\n        .error-message {\n          color: #e74c3c;\n          font-size: 1rem;\n          margin-bottom: 20px;\n          text-align: center;\n          padding: 10px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 5px;\n          animation: fadeIn 0.5s ease;\n        }\n\n        .loading-message {\n          color: #fff;\n          font-size: 1rem;\n          text-align: center;\n          margin-bottom: 20px;\n          padding: 10px;\n          animation: pulse 1.5s infinite;\n        }\n\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          background: #ffffff;\n          border-radius: 8px;\n          overflow: hidden;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n        }\n\n        th,\n        td {\n          padding: 15px;\n          text-align: left;\n          font-size: 1rem;\n          color: #333;\n        }\n\n        th {\n          background: #6e48aa;\n          color: #ffffff;\n          font-weight: 600;\n          text-transform: uppercase;\n        }\n\n        tr:nth-child(even) {\n          background: #f8f9fa;\n        }\n\n        tr:hover:not(:first-child) {\n          background: #e9ecef;\n          transition: background 0.2s ease;\n        }\n\n        .no-data {\n          text-align: center;\n          color: #666;\n          font-style: italic;\n        }\n\n        .select-button {\n          padding: 8px 12px;\n          background: #6e48aa;\n          color: #fff;\n          border: none;\n          border-radius: 5px;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.2s ease;\n        }\n\n        .select-button:hover:not(:disabled) {\n          background: #5a3e8b;\n          transform: scale(1.05);\n        }\n\n        .select-button:disabled {\n          background: #a0a0a0;\n          cursor: not-allowed;\n        }\n\n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n          }\n          to {\n            opacity: 1;\n          }\n        }\n\n        @keyframes pulse {\n          0% {\n            opacity: 1;\n          }\n          50% {\n            opacity: 0.5;\n          }\n          100% {\n            opacity: 1;\n          }\n        }\n\n        @media (max-width: 768px) {\n          th,\n          td {\n            padding: 10px;\n            font-size: 0.9rem;\n          }\n\n          .select-doctor-container {\n            padding: 15px;\n          }\n\n          h2 {\n            font-size: 1.5rem;\n          }\n        }\n\n        @media (max-width: 480px) {\n          th,\n          td {\n            padding: 8px;\n            font-size: 0.8rem;\n          }\n\n          .filter-container {\n            flex-direction: column;\n            align-items: flex-start;\n          }\n\n          select {\n            width: 100%;\n          }\n\n          h2 {\n            font-size: 1.2rem;\n          }\n        }\n      "})]})},Qp=[{code:"en",name:"English"},{code:"kn",name:"Kannada"},{code:"hi",name:"Hindi"}];const Jp=function(e){let{user:n,role:r,firebaseUser:i}=e;const{patientId:s,doctorId:o}=Z(),a=X(),[l,c]=(0,t.useState)(!1),[u,d]=(0,t.useState)("");return(0,t.useEffect)((()=>{"patient"===r&&null!==n&&void 0!==n&&n.uid&&s&&o||(d("Unauthorized access or missing data. Redirecting to login."),setTimeout((()=>a("/login")),2e3))}),[r,n,s,o,a]),(0,Tp.jsxs)("div",{className:"language-preference-container",children:[(0,Tp.jsx)("h2",{children:"Select Your Language Preference"}),(0,Tp.jsx)("p",{children:"Please choose the language you would like to use for communication:"}),(0,Tp.jsx)("div",{className:"language-options",children:Qp.map((e=>(0,Tp.jsx)("button",{onClick:()=>(async e=>{if(!i)return d("User authentication required. Please log in again."),void setTimeout((()=>a("/login")),2e3);c(!0),d("");try{const t=tu(kp,"patients",s),r=await Zu(t);if(!r.exists())return d("Patient profile not found."),void c(!1);if(r.data().uid!==n.uid)return d("You are not authorized to update this patient profile."),void c(!1);await nd(t,{languagePreference:e},{merge:!0}),console.log(`Language preference set to ${e} for patient ${s}`),a(`/patient/chat/${s}/${o}`)}catch(t){console.error("Error setting language preference:",t),"permission-denied"===t.code?d("Permission denied. Please verify your access rights."):"unavailable"===t.code?d("Network error. Please check your connection and try again."):d(`Failed to set language preference: ${t.message}`)}finally{c(!1)}})(e.code),className:"language-button",disabled:l,children:e.name},e.code)))}),u&&(0,Tp.jsx)("div",{className:"error-message",children:u}),l&&(0,Tp.jsx)("div",{className:"loading-message",children:"Saving language preference..."}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n\n        .language-preference-container {\n          width: 100vw;\n          height: 100vh;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          font-family: 'Poppins', sans-serif;\n          color: #E0E0E0;\n        }\n\n        h2 {\n          font-size: 2rem;\n          font-weight: 600;\n          color: #FFFFFF;\n          margin-bottom: 20px;\n          position: relative;\n        }\n\n        h2::after {\n          content: '';\n          width: 40px;\n          height: 4px;\n          background: #6E48AA;\n          position: absolute;\n          bottom: -10px;\n          left: 50%;\n          transform: translateX(-50%);\n          border-radius: 2px;\n        }\n\n        p {\n          font-size: 1.2rem;\n          margin-bottom: 30px;\n          color: #E0E0E0;\n        }\n\n        .language-options {\n          display: flex;\n          gap: 20px;\n          flex-wrap: wrap;\n          justify-content: center;\n        }\n\n        .language-button {\n          padding: 12px 30px;\n          background: rgba(255, 255, 255, 0.1);\n          color: #FFFFFF;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 25px;\n          font-size: 1.1rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background 0.3s ease, transform 0.3s ease;\n        }\n\n        .language-button:hover:not(:disabled) {\n          background: #6E48AA;\n          transform: scale(1.05);\n        }\n\n        .language-button:disabled {\n          background: rgba(255, 255, 255, 0.2);\n          cursor: not-allowed;\n        }\n\n        .error-message {\n          color: #E74C3C;\n          font-size: 0.9rem;\n          margin-top: 20px;\n          text-align: center;\n          padding: 10px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 5px;\n        }\n\n        .loading-message {\n          color: #6E48AA;\n          font-size: 0.9rem;\n          margin-top: 20px;\n          text-align: center;\n          padding: 10px;\n          animation: pulse 1.5s infinite;\n        }\n\n        @keyframes pulse {\n          0% { opacity: 1; }\n          50% { opacity: 0.5; }\n          100% { opacity: 1; }\n        }\n\n        @media (max-width: 768px) {\n          h2 {\n            font-size: 1.8rem;\n          }\n          p {\n            font-size: 1rem;\n          }\n          .language-button {\n            padding: 10px 25px;\n            font-size: 1rem;\n          }\n        }\n\n        @media (max-width: 480px) {\n          h2 {\n            font-size: 1.5rem;\n          }\n          p {\n            font-size: 0.9rem;\n          }\n          .language-options {\n            flex-direction: column;\n            gap: 15px;\n          }\n          .language-button {\n            padding: 10px 20px;\n            width: 100%;\n            max-width: 200px;\n          }\n        }\n      "})]})},Yp=()=>{const e=J();return console.log(`NotFound: Rendering for path "${e.pathname}"`),(0,Tp.jsxs)("div",{className:"not-found-container",children:[(0,Tp.jsx)("h2",{children:"404 - Page Not Found"}),(0,Tp.jsxs)("p",{children:['The requested path "',e.pathname,'" does not exist.']}),(0,Tp.jsxs)("p",{children:["Go to ",(0,Tp.jsx)("a",{href:"/login",children:"Login"})]}),(0,Tp.jsx)("style",{children:"\n        .not-found-container {\n          min-height: 100vh;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          color: #E0E0E0;\n          font-family: 'Poppins', sans-serif;\n          text-align: center;\n          padding: 20px;\n        }\n        h2 {\n          font-size: 2rem;\n          margin-bottom: 10px;\n        }\n        p {\n          font-size: 1.2rem;\n          margin: 5px 0;\n        }\n        a {\n          color: #6E48AA;\n          text-decoration: underline;\n        }\n        a:hover {\n          color: #9D50BB;\n        }\n      "})]})};function Xp(){const[e,n]=(0,t.useState)(null),[r,i]=(0,t.useState)(null),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(null),[c,u]=(0,t.useState)(!0),[d,h]=(0,t.useState)(""),f=X(),p=J();(0,t.useEffect)((()=>{console.log("App: Starting auth state listener setup");const e=Sp.onAuthStateChanged((async e=>{if(console.log("App: Auth state changed, authUser:",e?e.uid:null),e){0,n(e);const t=e.uid;console.log("App: Fetching user data for UID:",t);const r=od(tu(kp,"users",t),(n=>{if(console.log("App: Firestore snapshot received for user:",t),n.exists()){const r=n.data();console.log("App: Fetched Firestore user data:",r);const s={uid:t,email:e.email,...r};if(i(s),o(r.role),console.log("App: Updated user state:",s,"Role:",r.role),"patient"===r.role){const e=r.patientId||t;l(e),sessionStorage.setItem("patientId",e),console.log(`App: Set patientId=${e} for patient role`)}else l(null),sessionStorage.removeItem("patientId"),console.log("App: Cleared patientId for non-patient role");sessionStorage.setItem("userId",t),u(!1),console.log("App: Loading complete, user data set");const a=sessionStorage.getItem("lastPath")||p.pathname;console.log("App: Restoring path after auth load:",a),m(a)}else console.log("App: User document not found in Firestore for UID:",t),g()}),(e=>{console.error("App: Firestore fetch error:",e.message),h(`Failed to fetch user data: ${e.message}`),g()}));return()=>{console.log("App: Unsubscribing Firestore listener for user:",t),r()}}console.log("App: No authenticated user detected"),g()}));return()=>{console.log("App: Unsubscribing auth state listener"),e()}}),[]);const m=t=>{e&&s?(console.log("App: Redirecting to last path:",t),"patient"===s&&t.startsWith("/patient")?"/patient/select-doctor"===t||t.startsWith("/patient/language-preference")||t.startsWith("/patient/chat")?(console.log("App: Redirecting to patient route:",t),f(t,{replace:!0})):(console.log("App: Invalid patient route, redirecting to /patient/select-doctor"),f("/patient/select-doctor",{replace:!0})):"doctor"===s&&"/doctor/chat"===t?(console.log("App: Redirecting to doctor route:",t),f(t,{replace:!0})):"admin"===s&&"/admin"===t?(console.log("App: Redirecting to admin route:",t),f(t,{replace:!0})):(console.log("App: Role or path mismatch, redirecting to default route for role:",s),f("patient"===s?"/patient/select-doctor":"doctor"===s?"/doctor/chat":"admin"===s?"/admin":"/login",{replace:!0}))):console.log("App: Cannot redirect yet, firebaseUser or role not set")};(0,t.useEffect)((()=>{"/login"!==p.pathname&&"/register"!==p.pathname&&(console.log("App: Saving current path to sessionStorage:",p.pathname),sessionStorage.setItem("lastPath",p.pathname))}),[p.pathname]),(0,t.useEffect)((()=>{if(!c&&e&&s){const e=sessionStorage.getItem("lastPath")||p.pathname;console.log("App: Initial load/refresh detected, restoring path:",e),m(e)}else c||e||(console.log("App: No firebaseUser on initial load, redirecting to login"),f("/login",{replace:!0}))}),[c,e,s]),(0,t.useEffect)((()=>{const e=()=>{d&&(console.log("App: Clearing error on route change"),h(""))};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[d]);const g=()=>{console.log("App: Handling auth failure, clearing all states"),n(null),i(null),o(null),l(null),sessionStorage.removeItem("userId"),sessionStorage.removeItem("patientId"),sessionStorage.removeItem("lastPath"),u(!1),console.log("App: Auth failure handled, loading set to false"),f("/login",{replace:!0})},v=async()=>{console.log("App: Initiating logout process");try{var e,t;const n=await(null===(e=Sp.currentUser)||void 0===e?void 0:e.getIdToken(!0));console.log("App: Obtained ID token for logout:",n?"Success":"Failed");const r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyAepidk9YCN43dqRLVdWq9OPDJIzE_v-Lc",REACT_APP_FIREBASE_AUTH_DOMAIN:"fir-project-vercel.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"fir-project-vercel",REACT_APP_FIREBASE_STORAGE_BUCKET:"fir-project-vercel.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1077273582238",REACT_APP_FIREBASE_APP_ID:"1:1077273582238:web:f283266eaa4796fac7f98f",REACT_APP_GOOGLE_CLOUD_PROJECT_ID:"healthcare-app-d8997",REACT_APP_GOOGLE_TRANSLATE_API_KEY:"AIzaSyBJIcd-B2Gempq-nR2p1PFhh4OPNgeIa7Y",REACT_APP_GCS_SERVICE_ACCOUNT_KEY:"/Users/ah1/PycharmProjects/healthcare-app-0/healthcare-app-d8997-d11ed6d0b101.json",REACT_APP_WEBSOCKET_URL:"http://localhost:5005"}.REACT_APP_API_URL||"https://healthcare-app-vercel.vercel.app/api";console.log("App: Sending logout request to:",`${r}/misc/logout`);const i=await fetch(`${r}/misc/logout`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"x-user-uid":(null===(t=Sp.currentUser)||void 0===t?void 0:t.uid)||"","Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(console.log("App: Logout request response status:",i.status),!i.ok){const e=await i.text();throw console.error("App: Logout request failed, details:",e),new Error(`Logout request failed: ${i.status}, ${e}`)}console.log("App: Initiating Firebase sign-out"),await af(Sp),console.log("App: Firebase sign-out completed"),console.log("App: Clearing app state"),g(),console.log("App: Local state cleared successfully")}catch(n){throw console.error("App: Logout error:",n.message),h(`Failed to log out: ${n.message}`),n}};return c?(console.log("App: Rendering loading state"),(0,Tp.jsxs)("div",{className:"loading-container",children:[(0,Tp.jsx)("p",{children:"Loading..."}),(0,Tp.jsx)("style",{children:"\n          .loading-container {\n            min-height: 100vh;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n            color: #E0E0E0;\n            font-family: 'Poppins', sans-serif;\n            font-size: 1.2rem;\n          }\n        "})]})):(console.log("App: Rendering main app with user:",null===r||void 0===r?void 0:r.uid,"role:",s,"patientId:",a),(0,Tp.jsxs)("div",{className:"app-container",children:[d&&(0,Tp.jsxs)("div",{className:"error-message",children:[(0,Tp.jsx)("span",{children:d}),(0,Tp.jsx)("button",{onClick:()=>{h(""),console.log("App: Error dismissed")},className:"dismiss-error",children:"Dismiss"})]}),(0,Tp.jsxs)(ge,{children:[(0,Tp.jsx)(pe,{path:"/login",element:r?(0,Tp.jsx)(fe,{to:"patient"===s?"/patient/select-doctor":"doctor"===s?"/doctor/chat":"admin"===s?"/admin":"/login",replace:!0}):(0,Tp.jsx)(Cp,{setUser:i,setRole:o,setPatientId:l,user:r,setError:h})}),(0,Tp.jsx)(pe,{path:"/register",element:r?(0,Tp.jsx)(fe,{to:"patient"===s?"/patient/select-doctor":"doctor"===s?"/doctor/chat":"admin"===s?"/admin":"/login",replace:!0}):(0,Tp.jsx)(Ip,{setUser:i,setRole:o,setPatientId:l,user:r,setError:h})}),(0,Tp.jsx)(pe,{path:"/patient/select-doctor",element:r&&"patient"===s?(0,Tp.jsx)(Gp,{firebaseUser:e,user:r,role:s,patientId:a,handleLogout:v}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"/patient/language-preference/:patientId/:doctorId",element:r&&"patient"===s?(0,Tp.jsx)(Jp,{firebaseUser:e,user:r,role:s,patientId:a}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"/patient/chat/:patientId/:doctorId",element:r&&"patient"===s?(0,Tp.jsx)(zp,{firebaseUser:e,user:r,role:s,patientId:a,handleLogout:v}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"/doctor/chat",element:r&&"doctor"===s?(0,Tp.jsx)(Vp,{user:r,role:s,handleLogout:v,setError:h}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"/admin",element:r&&"admin"===s?(0,Tp.jsx)(Wp,{user:r,role:s,handleLogout:v,setUser:i}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"/",element:r?"patient"===s?(0,Tp.jsx)(fe,{to:"/patient/select-doctor",replace:!0}):"doctor"===s?(0,Tp.jsx)(fe,{to:"/doctor/chat",replace:!0}):"admin"===s?(0,Tp.jsx)(fe,{to:"/admin",replace:!0}):(0,Tp.jsx)(fe,{to:"/login",replace:!0}):(0,Tp.jsx)(fe,{to:"/login",replace:!0})}),(0,Tp.jsx)(pe,{path:"*",element:(0,Tp.jsx)(Yp,{})})]}),(0,Tp.jsx)("style",{children:"\n        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n\n        .app-container {\n          min-height: 100vh;\n          background: linear-gradient(135deg, #2C1A3D, #3E2A5A);\n          font-family: 'Poppins', sans-serif;\n        }\n        a {\n          color: #6E48AA;\n          text-decoration: none;\n        }\n        a:hover {\n          text-decoration: underline;\n          color: #9D50BB;\n        }\n        .error-message {\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: rgba(231, 76, 60, 0.9);\n          color: #FFFFFF;\n          padding: 15px 20px;\n          border-radius: 10px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          z-index: 1000;\n          font-size: 0.9rem;\n          animation: slideIn 0.3s ease;\n        }\n        .error-message span {\n          flex: 1;\n        }\n        .dismiss-error {\n          padding: 6px 12px;\n          background: #FFFFFF;\n          color: #E74C3C;\n          border: none;\n          border-radius: 20px;\n          font-size: 0.8rem;\n          cursor: pointer;\n          transition: background 0.3s ease;\n        }\n        .dismiss-error:hover {\n          background: #E0E0E0;\n        }\n        @keyframes slideIn {\n          from {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n      "})]}))}function Zp(){return console.log("AppWrapper: Rendering Router"),(0,Tp.jsx)(_e,{children:(0,Tp.jsx)(Xp,{})})}i.createRoot(document.getElementById("root")).render((0,Tp.jsx)(t.StrictMode,{children:(0,Tp.jsx)(Zp,{})}))})()})();
//# sourceMappingURL=main.513dd53f.js.map